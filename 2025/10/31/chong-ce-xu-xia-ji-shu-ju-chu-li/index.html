<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ÈáçÊµãÂ∫è‰∏ãÊú∫Êï∞ÊçÆÂ§ÑÁêÜ | HHHH</title><meta name="author" content="HHHH"><meta name="copyright" content="HHHH"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="üß¨ ÈáçÊµãÂ∫èÊï∞ÊçÆÊ†áÂáÜÂ§ÑÁêÜÊµÅÁ®ãËØ¶Ëß£Êú¨ÁØáÂçöÂÆ¢ËØ¶ÁªÜËß£Êûê‰ªé ‰∏ãÊú∫ FastQ Êï∞ÊçÆ Âà∞ ÂèòÂºÇÊ£ÄÊµãËæìÂÖ•Êñá‰ª∂ÔºàgVCFÔºâ ÁöÑÂÆåÊï¥ÊµÅÁ®ã„ÄÇÊµÅÁ®ãÂü∫‰∫é Linux ÁéØÂ¢É‰∏é GATK Êé®ËçêÂÆûË∑µÔºåÂπ∂ÁªìÂêàÂπ∂Ë°å‰ºòÂåñ‰∏éÁ£ÅÁõòÁ©∫Èó¥ËäÇÁúÅÁ≠ñÁï•„ÄÇÈÄÇÂêàÂàöÊé•Ëß¶ÈáçÊµãÂ∫èÂàÜÊûêÁöÑÊñ∞ÊâãÔºå‰πüÈÄÇÁî®‰∫éÈúÄË¶ÅÈ´òÊïàËá™Âä®ÂåñÂ§ÑÁêÜÁöÑÁ†îÁ©∂‰∫∫Âëò„ÄÇ  ÁéØÂ¢ÉÔºöconda activate py310 ‰∏Ä„ÄÅFastp Ë¥®Êéß‰∏éËøáÊª§Ôºàrun_fastpl.shÔºâ#!&#x2F;bin&#x2F;bas">
<meta property="og:type" content="article">
<meta property="og:title" content="ÈáçÊµãÂ∫è‰∏ãÊú∫Êï∞ÊçÆÂ§ÑÁêÜ">
<meta property="og:url" content="https://0hhhhhh0.github.io/2025/10/31/chong-ce-xu-xia-ji-shu-ju-chu-li/index.html">
<meta property="og:site_name" content="HHHH">
<meta property="og:description" content="üß¨ ÈáçÊµãÂ∫èÊï∞ÊçÆÊ†áÂáÜÂ§ÑÁêÜÊµÅÁ®ãËØ¶Ëß£Êú¨ÁØáÂçöÂÆ¢ËØ¶ÁªÜËß£Êûê‰ªé ‰∏ãÊú∫ FastQ Êï∞ÊçÆ Âà∞ ÂèòÂºÇÊ£ÄÊµãËæìÂÖ•Êñá‰ª∂ÔºàgVCFÔºâ ÁöÑÂÆåÊï¥ÊµÅÁ®ã„ÄÇÊµÅÁ®ãÂü∫‰∫é Linux ÁéØÂ¢É‰∏é GATK Êé®ËçêÂÆûË∑µÔºåÂπ∂ÁªìÂêàÂπ∂Ë°å‰ºòÂåñ‰∏éÁ£ÅÁõòÁ©∫Èó¥ËäÇÁúÅÁ≠ñÁï•„ÄÇÈÄÇÂêàÂàöÊé•Ëß¶ÈáçÊµãÂ∫èÂàÜÊûêÁöÑÊñ∞ÊâãÔºå‰πüÈÄÇÁî®‰∫éÈúÄË¶ÅÈ´òÊïàËá™Âä®ÂåñÂ§ÑÁêÜÁöÑÁ†îÁ©∂‰∫∫Âëò„ÄÇ  ÁéØÂ¢ÉÔºöconda activate py310 ‰∏Ä„ÄÅFastp Ë¥®Êéß‰∏éËøáÊª§Ôºàrun_fastpl.shÔºâ#!&#x2F;bin&#x2F;bas">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://0hhhhhh0.github.io/uploads/avatar.png">
<meta property="article:published_time" content="2025-10-31T01:26:00.000Z">
<meta property="article:modified_time" content="2025-10-31T01:32:15.000Z">
<meta property="article:author" content="HHHH">
<meta property="article:tag" content="hexo">
<meta property="article:tag" content="ÁªÑÂ≠¶ÔºåLinuxÔºåÊäòËÖæ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://0hhhhhh0.github.io/uploads/avatar.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ÈáçÊµãÂ∫è‰∏ãÊú∫Êï∞ÊçÆÂ§ÑÁêÜ",
  "url": "https://0hhhhhh0.github.io/2025/10/31/chong-ce-xu-xia-ji-shu-ju-chu-li/",
  "image": "https://0hhhhhh0.github.io/uploads/avatar.png",
  "datePublished": "2025-10-31T01:26:00.000Z",
  "dateModified": "2025-10-31T01:32:15.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "HHHH",
      "url": "https://0HHHHHH0.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/uploads/avatar.png"><link rel="canonical" href="https://0hhhhhh0.github.io/2025/10/31/chong-ce-xu-xia-ji-shu-ju-chu-li/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":-1,"unescape":true,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":true,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ÈáçÊµãÂ∫è‰∏ãÊú∫Êï∞ÊçÆÂ§ÑÁêÜ',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="HHHH" type="application/atom+xml">
</head><body><div id="loading-box"><div class="scarecrow"><div class="scarecrow__hat"><div class="scarecrow__ribbon"></div></div><div class="scarecrow__head"><div class="scarecrow__eye"></div><div class="scarecrow__eye"></div><div class="scarecrow__mouth"></div><div class="scarecrow__pipe"></div></div><div class="scarecrow__body"><div class="scarecrow__glove scarecrow__glove--l"></div><div class="scarecrow__sleeve scarecrow__sleeve--l"></div><div class="scarecrow__bow"></div><div class="scarecrow__shirt"></div><div class="scarecrow__coat"></div><div class="scarecrow__waistcoat"></div><div class="scarecrow__sleeve scarecrow__sleeve--r"></div><div class="scarecrow__glove scarecrow__glove--r"></div><div class="scarecrow__coattails"></div><div class="scarecrow__pants"></div></div><div class="scarecrow__arms"></div><div class="scarecrow__leg">  </div></div></div><script async="async">(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-color: #fbfdff;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/uploads/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/uploads/avatar.png" alt="Logo"><span class="site-name">HHHH</span></a><a class="nav-page-title" href="/"><span class="site-name">ÈáçÊµãÂ∫è‰∏ãÊú∫Êï∞ÊçÆÂ§ÑÁêÜ</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">ÈáçÊµãÂ∫è‰∏ãÊú∫Êï∞ÊçÆÂ§ÑÁêÜ</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-10-31T01:26:00.000Z" title="Created 2025-10-31 09:26:00">2025-10-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-10-31T01:32:15.000Z" title="Updated 2025-10-31 09:32:15">2025-10-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/">Linux</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div class="ai-summary"><div class="ai-explanation" style="display: block;" data-summary="ËøôÁØáÊñáÁ´†ËØ¶ÁªÜ‰ªãÁªç‰∫Ü‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÈáçÊµãÂ∫èÊï∞ÊçÆÊ†áÂáÜÂ§ÑÁêÜÊµÅÁ®ãÔºåÈáçÁÇπËÆ≤Ëß£‰∫Ü‰ªé‰∏ãÊú∫FastQÊï∞ÊçÆÂà∞ÂèòÂºÇÊ£ÄÊµãËæìÂÖ•Êñá‰ª∂(gVCF)ÁöÑËΩ¨ÂåñËøáÁ®ã„ÄÇÊñá‰∏≠Êèê‰æõ‰∫ÜÂü∫‰∫éLinuxÁéØÂ¢ÉÂíåGATKÊé®ËçêÂÆûË∑µÁöÑÂÖ∑‰ΩìÊìç‰ΩúÊµÅÁ®ãÔºåÁâπÂà´Âº∫Ë∞É‰∫ÜÂπ∂Ë°å‰ºòÂåñÂíåÁ£ÅÁõòÁ©∫Èó¥ËäÇÁúÅÁ≠ñÁï•„ÄÇÂÖ∂‰∏≠ÈáçÁÇπËß£Êûê‰∫ÜFastpË¥®Êéß‰∏éËøáÊª§Ê≠•È™§ÔºåÂåÖÊã¨Ë¥®ÊéßËÑöÊú¨run_fastpl.shÁöÑÂÆûÁé∞ÁªÜËäÇÔºåËØ•ËÑöÊú¨ËÉΩÂ§üËá™Âä®Ê£ÄÊµãÊ†∑Êú¨„ÄÅÂÆåÊàêË¥®ÈáèÊéßÂà∂„ÄÅËøáÊª§‰ΩéË¥®ÈáèreadsÂπ∂ÁîüÊàê‰∫§‰∫íÂºèÊä•Âëä„ÄÇÊñáÁ´†ËøòËØ¶ÁªÜËØ¥Êòé‰∫ÜËæìÂÖ•ËæìÂá∫ÁõÆÂΩïÁöÑËÆæÂÆö„ÄÅÊ†∏ÂøÉÊµÅÁ®ãËß£Êûê‰∏≠ÁöÑÊ†∑Êú¨Ëá™Âä®Ê£ÄÊµãÁ≠âÂÖ≥ÈîÆÊäÄÊúØÁÇπÔºåÈÄÇÂêàÈáçÊµãÂ∫èÂàÜÊûêÊñ∞ÊâãÂíåÊúâÈ´òÊïàËá™Âä®ÂåñÂ§ÑÁêÜÈúÄÊ±ÇÁöÑÁ†îÁ©∂‰∫∫ÂëòÂèÇËÄÉ„ÄÇ">AIÊ≠£Âú®ÁªûÂ∞ΩËÑëÊ±ÅÊÉ≥ÊÄùË∑ØING¬∑¬∑¬∑</div><div class="ai-title"> <div class="ai-title-left"> <i class="fa-brands fa-slack"></i><div class="ai-title-text">AIÊëòË¶Å</div></div><div class="ai-tag" id="ai-tag">deepseek-ai/DeepSeek-V3</div></div></div><h1 id="üß¨-ÈáçÊµãÂ∫èÊï∞ÊçÆÊ†áÂáÜÂ§ÑÁêÜÊµÅÁ®ãËØ¶Ëß£"><a href="#üß¨-ÈáçÊµãÂ∫èÊï∞ÊçÆÊ†áÂáÜÂ§ÑÁêÜÊµÅÁ®ãËØ¶Ëß£" class="headerlink" title="üß¨ ÈáçÊµãÂ∫èÊï∞ÊçÆÊ†áÂáÜÂ§ÑÁêÜÊµÅÁ®ãËØ¶Ëß£"></a>üß¨ ÈáçÊµãÂ∫èÊï∞ÊçÆÊ†áÂáÜÂ§ÑÁêÜÊµÅÁ®ãËØ¶Ëß£</h1><p>Êú¨ÁØáÂçöÂÆ¢ËØ¶ÁªÜËß£Êûê‰ªé <strong>‰∏ãÊú∫ FastQ Êï∞ÊçÆ</strong> Âà∞ <strong>ÂèòÂºÇÊ£ÄÊµãËæìÂÖ•Êñá‰ª∂ÔºàgVCFÔºâ</strong> ÁöÑÂÆåÊï¥ÊµÅÁ®ã„ÄÇ<br>ÊµÅÁ®ãÂü∫‰∫é Linux ÁéØÂ¢É‰∏é GATK Êé®ËçêÂÆûË∑µÔºåÂπ∂ÁªìÂêàÂπ∂Ë°å‰ºòÂåñ‰∏éÁ£ÅÁõòÁ©∫Èó¥ËäÇÁúÅÁ≠ñÁï•„ÄÇ<br>ÈÄÇÂêàÂàöÊé•Ëß¶ÈáçÊµãÂ∫èÂàÜÊûêÁöÑÊñ∞ÊâãÔºå‰πüÈÄÇÁî®‰∫éÈúÄË¶ÅÈ´òÊïàËá™Âä®ÂåñÂ§ÑÁêÜÁöÑÁ†îÁ©∂‰∫∫Âëò„ÄÇ</p>
<hr>
<p>ÁéØÂ¢ÉÔºö<code>conda activate py310</code></p>
<h2 id="‰∏Ä„ÄÅFastp-Ë¥®Êéß‰∏éËøáÊª§Ôºàrun-fastpl-shÔºâ"><a href="#‰∏Ä„ÄÅFastp-Ë¥®Êéß‰∏éËøáÊª§Ôºàrun-fastpl-shÔºâ" class="headerlink" title="‰∏Ä„ÄÅFastp Ë¥®Êéß‰∏éËøáÊª§Ôºàrun_fastpl.shÔºâ"></a>‰∏Ä„ÄÅFastp Ë¥®Êéß‰∏éËøáÊª§Ôºà<code>run_fastpl.sh</code>Ôºâ</h2><pre class="line-numbers language-none"><code class="language-none">#!/bin/bash
# =========================================
# Fastp Âπ∂Ë°åË¥®ÊéßËÑöÊú¨ÔºàÊúÄÁªàÁâàÊú¨ + Â∑≤ÂÆåÊàêËÆ°Êï∞‰øÆÊ≠£Ôºâ
# Author: Carl Hansen
# Date: $(date +"%Y-%m-%d")
# =========================================

INPUT_DIR="/home/wanglab/Ywh/adductor_muscle_scar/ReSeq_Data/DZQD2023092909-b1/Raw_data"
OUTPUT_DIR="/home/wanglab/Ywh/adductor_muscle_scar/ReSeq_Data/DZQD2023092909-b1/Clean_data"
REPORT_DIR="${OUTPUT_DIR}/reports"
LOG_DIR="${OUTPUT_DIR}/logs"

THREADS_PER_JOB=6   # ÊØè‰∏™Ê†∑Êú¨ fastp Á∫øÁ®ãÊï∞
JOBS=2              # ÂêåÊó∂Âπ∂Ë°åÊ†∑Êú¨Êï∞

mkdir -p "$OUTPUT_DIR" "$REPORT_DIR" "$LOG_DIR"

echo "====================================="
echo " Fastp Âπ∂Ë°åË¥®ÊéßÂºÄÂßã: $(date)"
echo " ËæìÂÖ•ÁõÆÂΩï: $INPUT_DIR"
echo " ËæìÂá∫ÁõÆÂΩï: $OUTPUT_DIR"
echo " ÊØè‰ªªÂä°Á∫øÁ®ã: $THREADS_PER_JOB"
echo " Âπ∂Ë°åÊ†∑Êú¨Êï∞: $JOBS"
echo "====================================="

# Ëé∑ÂèñÊâÄÊúâ R1 Êñá‰ª∂
samples=($(find "$INPUT_DIR" -name "*.R1.fastq.gz" | sort))
total=${#samples[@]}

if [[ $total -eq 0 ]]; then
    echo "[ÈîôËØØ] Êú™ÊâæÂà∞‰ªª‰Ωï R1.fastq.gz Êñá‰ª∂ÔºåËØ∑Ê£ÄÊü•ËæìÂÖ•ÁõÆÂΩï"
    exit 1
fi

# ËÆ°Êï∞Êñá‰ª∂ + ÂàùÂßãÂåñ‰∏∫Â∑≤ÂÆåÊàêÊ†∑Êú¨Êï∞
COUNT_FILE="${LOG_DIR}/progress_count.tmp"
completed=$(find "$REPORT_DIR" -name "*_fastp.json" -size +0 | wc -l)
echo $completed &gt; "$COUNT_FILE"

# fastp Â§ÑÁêÜÂáΩÊï∞
run_fastp() {
    fq1=$1
    sample=$(basename "$(dirname "$fq1")")
    fq2="${fq1/.R1.fastq.gz/.R2.fastq.gz}"

    out1="${OUTPUT_DIR}/${sample}_clean.R1.fastq.gz"
    out2="${OUTPUT_DIR}/${sample}_clean.R2.fastq.gz"
    report="${REPORT_DIR}/${sample}_fastp.json"
    
    # Ê£ÄÊü• JSON ÊòØÂê¶Â≠òÂú®‰∏îÈùûÁ©∫
    if [[ -s "$report" ]]; then
        echo "[Ë∑≥Ëøá] $sample Â∑≤ÂÆåÊàê ‚úÖ"
        return 0
    fi
    
    # ‚ö° Êõ¥Êñ∞ËøõÂ∫¶ËÆ°Êï∞ÔºàÂπ∂Ë°åÂÆâÂÖ®Ôºâ
    count=$( ( flock 9
        c=$(cat "$COUNT_FILE")
        c=$((c+1))
        echo $c &gt; "$COUNT_FILE"
        echo $c
    ) 9&gt;"$COUNT_FILE.lock" )
    
    echo "[ËøõÂ∫¶] $count/$total Ê†∑Êú¨: $sample"
    echo "[ÂêØÂä®] $sample ÂºÄÂßãÂ§ÑÁêÜ..."
    
    fastp \
        -i "$fq1" \
        -I "$fq2" \
        -o "$out1" \
        -O "$out2" \
        -h "${REPORT_DIR}/${sample}_fastp.html" \
        -j "$report" \
        -w $THREADS_PER_JOB \
        &gt; "${LOG_DIR}/${sample}.log" 2&gt;&amp;1
    
    if [[ $? -eq 0 &amp;&amp; -s "$report" ]]; then
        echo "[ÂÆåÊàê] $sample ‚úÖ"
    else
        echo "[Â§±Ë¥•] $sample ‚ùåÔºåËØ∑Ê£ÄÊü• ${LOG_DIR}/${sample}.log"
    fi
}

export -f run_fastp
export OUTPUT_DIR REPORT_DIR LOG_DIR THREADS_PER_JOB total COUNT_FILE

# Âπ∂Ë°åÊâßË°å
printf "%s\n" "${samples[@]}" | parallel --line-buffer -j $JOBS run_fastp {}

# Ê∏ÖÁêÜËÆ°Êï∞Êñá‰ª∂
rm -f "$COUNT_FILE" "$COUNT_FILE.lock"

echo "====================================="
echo " Fastp Ë¥®ÊéßÂÖ®ÈÉ®ÂÆåÊàê: $(date)"
echo "Êä•ÂëäÁõÆÂΩï: $REPORT_DIR"
echo "Êó•ÂøóÁõÆÂΩï: $LOG_DIR"
echo "====================================="
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-üìò-ËÑöÊú¨ÂäüËÉΩÊ¶ÇËø∞"><a href="#1-üìò-ËÑöÊú¨ÂäüËÉΩÊ¶ÇËø∞" class="headerlink" title="1.üìò ËÑöÊú¨ÂäüËÉΩÊ¶ÇËø∞"></a>1.üìò ËÑöÊú¨ÂäüËÉΩÊ¶ÇËø∞</h3><p>ËØ•ËÑöÊú¨‰ΩøÁî® <strong>Fastp</strong> ÂØπÂéüÂßã‰∏ãÊú∫Êï∞ÊçÆÔºàRaw_dataÔºâËøõË°å <strong>Ë¥®ÈáèÊéßÂà∂ÔºàQCÔºâ‰∏éËøáÊª§</strong>ÔºåÂπ∂Âà©Áî® GNU Parallel ÂÆûÁé∞Â§öÊ†∑Êú¨Âπ∂Ë°å„ÄÇ</p>
<blockquote>
<p><strong>‰∏ªË¶ÅÁõÆÁöÑÔºö</strong></p>
<ul>
<li>Ê∏ÖÈô§‰ΩéË¥®Èáè reads„ÄÅÂê´Êé•Â§¥Â∫èÂàóÁöÑ readsÔºõ</li>
<li>ÁîüÊàê‰∫§‰∫íÂºè HTML Êä•ÂëäÔºõ</li>
<li>Âπ∂Ë°åÂä†ÈÄüÂ§öÊ†∑Êú¨Â§ÑÁêÜÔºõ</li>
<li>ÈÅøÂÖçÈáçÂ§çËøêË°åÔºåËá™Âä®Ë∑≥ËøáÂ∑≤ÂÆåÊàêÊ†∑Êú¨„ÄÇ</li>
</ul>
</blockquote>
<h3 id="2-üìÇ-ËæìÂÖ•‰∏éËæìÂá∫ÁõÆÂΩï"><a href="#2-üìÇ-ËæìÂÖ•‰∏éËæìÂá∫ÁõÆÂΩï" class="headerlink" title="2.üìÇ ËæìÂÖ•‰∏éËæìÂá∫ÁõÆÂΩï"></a>2.üìÇ ËæìÂÖ•‰∏éËæìÂá∫ÁõÆÂΩï</h3><table>
<thead>
<tr>
<th>Ë∑ØÂæÑ</th>
<th>ËØ¥Êòé</th>
</tr>
</thead>
<tbody><tr>
<td><code>/Raw_data/</code></td>
<td>ÂéüÂßã‰∏ãÊú∫Êï∞ÊçÆÔºåÂåÖÂê´ <code>R1</code>„ÄÅ<code>R2</code> Êñá‰ª∂</td>
</tr>
<tr>
<td><code>/Clean_data/</code></td>
<td>ËæìÂá∫ÁöÑËøáÊª§ÂêéÊï∞ÊçÆ</td>
</tr>
<tr>
<td><code>/reports/</code></td>
<td>Fastp ÁöÑ HTML + JSON Êä•Âëä</td>
</tr>
<tr>
<td><code>/logs/</code></td>
<td>ÊØè‰∏™Ê†∑Êú¨ÁöÑËøêË°åÊó•Âøó</td>
</tr>
</tbody></table>
<h3 id="3-‚öôÔ∏è-Ê†∏ÂøÉÊµÅÁ®ãËß£Êûê"><a href="#3-‚öôÔ∏è-Ê†∏ÂøÉÊµÅÁ®ãËß£Êûê" class="headerlink" title="3.‚öôÔ∏è Ê†∏ÂøÉÊµÅÁ®ãËß£Êûê"></a>3.‚öôÔ∏è Ê†∏ÂøÉÊµÅÁ®ãËß£Êûê</h3><ol>
<li><p><strong>Ê†∑Êú¨Ëá™Âä®Ê£ÄÊµã</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">samples</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable"><span class="token variable">$(</span><span class="token function">find</span> <span class="token string">"<span class="token variable">$INPUT_DIR</span>"</span> <span class="token parameter variable">-name</span> <span class="token string">"*.R1.fastq.gz"</span><span class="token variable">)</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<p>Ëá™Âä®Êâ´ÊèèÊâÄÊúâ R1 Êñá‰ª∂ÔºåËá™Âä®ËØÜÂà´ÈÖçÂØπÁöÑ R2„ÄÇ</p>
<ol start="2">
<li><p><strong>Âπ∂Ë°åË¥®Êéß</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">parallel --line-buffer <span class="token parameter variable">-j</span> <span class="token variable">$JOBS</span> run_fastp <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>‰ΩøÁî® <code>parallel</code> ÊéßÂà∂ÂêåÊó∂Â§ÑÁêÜÁöÑÊ†∑Êú¨Êï∞ÈáèÔºàÈªòËÆ§ 2 ‰∏™Ôºâ„ÄÇ</p>
</li>
<li><p><strong>ËøõÂ∫¶ËøΩË∏™Êú∫Âà∂</strong><br> ÊØèÂÆåÊàê‰∏Ä‰∏™Ê†∑Êú¨ÔºåËøõÂ∫¶ËÆ°Êï∞Ëá™Âä®Êõ¥Êñ∞Ôºå‰æãÂ¶ÇÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">[ËøõÂ∫¶] 3/24 Ê†∑Êú¨: BM_S_3
[ÂÆåÊàê] BM_S_3 ‚úÖ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p><strong>ÁªìÊûúÊ£ÄÊü•</strong><br> Ëã• JSON Êä•ÂëäÂ≠òÂú®‰∏îÈùûÁ©∫ÔºåÂàôËá™Âä®Ë∑≥ËøáËØ•Ê†∑Êú¨ÔºåËäÇÁúÅÊó∂Èó¥„ÄÇ</p>
</li>
</ol>
<h3 id="4-‚úÖ-ËøêË°åÁªìÊûú"><a href="#4-‚úÖ-ËøêË°åÁªìÊûú" class="headerlink" title="4.‚úÖ ËøêË°åÁªìÊûú"></a>4.‚úÖ ËøêË°åÁªìÊûú</h3><ul>
<li><p>ËæìÂá∫Êñá‰ª∂Á§∫‰æãÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">Clean_data/BM_S_1_clean.R1.fastq.gz
Clean_data/BM_S_1_clean.R2.fastq.gz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>Ë¥®ÊéßÊä•ÂëäÔºàÊµèËßàÂô®Êü•ÁúãÔºâÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">Clean_data/reports/BM_S_1_fastp.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<hr>
<h2 id="‰∫å„ÄÅÊØîÂØπ‰∏é-gVCF-ÁîüÊàêÔºàrun-bwa-vcf-shÔºâ"><a href="#‰∫å„ÄÅÊØîÂØπ‰∏é-gVCF-ÁîüÊàêÔºàrun-bwa-vcf-shÔºâ" class="headerlink" title="‰∫å„ÄÅÊØîÂØπ‰∏é gVCF ÁîüÊàêÔºàrun_bwa_vcf.shÔºâ"></a>‰∫å„ÄÅÊØîÂØπ‰∏é gVCF ÁîüÊàêÔºà<code>run_bwa_vcf.sh</code>Ôºâ</h2><pre class="line-numbers language-none"><code class="language-none">#!/bin/bash
# =========================================
# ËäÇÁúÅÁ©∫Èó¥ÁöÑÂÖ®ÈáèÊ†∑Êú¨Â§ÑÁêÜËÑöÊú¨ - Âπ∂Ë°åÁîüÊàêgVCF
# =========================================

CLEAN_DIR="/home/wanglab/Ywh/adductor_muscle_scar/ReSeq_Data/DZQD2023092909-b1/Clean_data"
REF="/home/wanglab/Ywh/adductor_muscle_scar/Genome/GCF_963853765.1_xbMagGiga1.1_genomic.fna"
OUT_DIR="/home/wanglab/Ywh/adductor_muscle_scar/ReSeq_Data/DZQD2023092909-b1/Align"
LOG_DIR="${OUT_DIR}/logs"

THREADS=12
BATCH_GVCF=12

mkdir -p "$OUT_DIR" "$LOG_DIR"

echo "[INFO] ËäÇÁúÅÁ©∫Èó¥ÁâàÂÖ®ÈáèÊ†∑Êú¨ÊµÅÁ®ãÂºÄÂßã: $(date)"
echo "[INFO] gVCFÂ∞ÜÂπ∂Ë°åÁîüÊàêÔºàÊØèÊâπ12‰∏™ÂêåÊó∂ËøêË°åÔºâ"
echo "====================================="

# Á¥¢ÂºïÊ£ÄÊü•
[[ ! -f "${REF}.bwt" ]] &amp;&amp; echo "[INFO] ÁîüÊàêBWAÁ¥¢Âºï..." &amp;&amp; bwa index $REF
[[ ! -f "${REF}.fai" ]] &amp;&amp; echo "[INFO] ÁîüÊàêsamtools faidx..." &amp;&amp; samtools faidx $REF
DICT_FILE="${REF%.*}.dict"
[[ ! -f "$DICT_FILE" ]] &amp;&amp; echo "[INFO] ÁîüÊàêGATKÂ∫èÂàóÂ≠óÂÖ∏..." &amp;&amp; gatk CreateSequenceDictionary -R $REF -O $DICT_FILE

# Ëé∑ÂèñÊ†∑Êú¨ÂàóË°®
samples=($(find "$CLEAN_DIR" -name "*_clean.R1.fastq.gz" | sort))
total=${#samples[@]}
if [[ $total -eq 0 ]]; then
    echo "[ERROR] Êú™ÊâæÂà∞‰ªª‰Ωï clean fastq Êñá‰ª∂"
    exit 1
fi
echo "[INFO] ÊÄªÊ†∑Êú¨Êï∞: $total"

# Ëé∑ÂèñÂ∑≤Â≠òÂú®ÁöÑBAMÂíågVCFÊñá‰ª∂
existing_bams=($(find "$OUT_DIR" -name "*.sorted.bam" | sort))
processed_gvcfs=($(find "$OUT_DIR" -name "*.g.vcf.gz" | sort))

echo "[INFO] Â∑≤Â≠òÂú®BAMÊñá‰ª∂: ${#existing_bams[@]} ‰∏™"
echo "[INFO] Â∑≤ÁîüÊàêgVCFÊñá‰ª∂: ${#processed_gvcfs[@]} ‰∏™"

# -------------------------------
# ÂçïÊ†∑Êú¨ÊØîÂØπÂáΩÊï∞ÔºàËæìÂá∫Êú™ÂéªÈáçBAMÔºâ
# -------------------------------
run_alignment() {
    fq1=$1
    fq2=${fq1/.R1/.R2}
    sample=$(basename "$fq1" | sed 's/_clean.R1.fastq.gz//')
    bam="$OUT_DIR/${sample}.sorted.bam"
    log="$LOG_DIR/${sample}.bwa.log"

    # Ê∑ªÂä†Ë∑≥ËøáÂ∑≤Â≠òÂú®BAMÁöÑÈÄªËæë
    if [[ -s "$bam" ]]; then
        echo "[INFO] $sample BAMÂ∑≤Â≠òÂú®ÔºåË∑≥ËøáÊØîÂØπ ‚úÖ"
        return 0
    fi
    
    echo "====================================="
    echo "[INFO $(date '+%Y-%m-%d %H:%M:%S')] [$sample] BWA MEM ÊØîÂØπÂºÄÂßã..."
    
    if [[ ! -s "$fq1" ]]; then
        echo "[ERROR] $sample ÁöÑ R1 Êñá‰ª∂‰∏çÂ≠òÂú®: $fq1" | tee -a "$log"
        exit 1
    fi
    
    if [[ -s "$fq2" ]]; then
        echo "[INFO] Ê£ÄÊµãÂà∞ÂèåÁ´ØÊµãÂ∫è: $fq1 + $fq2" | tee -a "$log"
        bwa mem -t $THREADS -M \
            -R "@RG\tID:${sample}\tSM:${sample}\tPL:ILLUMINA" \
            $REF $fq1 $fq2 \
            2&gt; &gt;(tee -a "$log" &gt;&amp;2) \
        | samtools sort -@ 4 -o "$bam" -
    else
        echo "[WARN] Êú™Ê£ÄÊµãÂà∞ R2Ôºå‰ªÖÂçïÁ´ØÊØîÂØπ: $fq1" | tee -a "$log"
        bwa mem -t $THREADS -M \
            -R "@RG\tID:${sample}\tSM:${sample}\tPL:ILLUMINA" \
            $REF $fq1 \
            2&gt; &gt;(tee -a "$log" &gt;&amp;2) \
        | samtools sort -@ 4 -o "$bam" -
    fi
    
    if [[ $? -ne 0 || ! -s "$bam" ]]; then
        echo "[ERROR] $sample ÊØîÂØπÂ§±Ë¥•!" | tee -a "$log"
        exit 1
    fi
    
    echo "[INFO $(date '+%Y-%m-%d %H:%M:%S')] [$sample] ÊØîÂØπÂÆåÊàê ‚úÖ ËæìÂá∫: $bam"
}


# -------------------------------
# gVCFÁîüÊàêÂáΩÊï∞ÔºàÁã¨Á´ãÂèØÊâßË°åÔºâ
# -------------------------------
generate_gvcf() {
    local bam="$1"
    local sample=$(basename "$bam" .sorted.bam)
    local bam_markdup="${OUT_DIR}/${sample}.sorted.markdup.bam"
    local metrics="${OUT_DIR}/${sample}.markdup.metrics.txt"
    local gvcf="${OUT_DIR}/${sample}.g.vcf.gz"
    local log_file="${LOG_DIR}/${sample}.gvcf.log"

    if [[ -s "$gvcf" ]]; then
        echo "[INFO] $sample gVCFÂ∑≤Â≠òÂú®ÔºåË∑≥Ëøá ‚úÖ"
        return 0
    fi
    
    echo "[INFO] [$sample] MarkDuplicates + gVCF ÂºÄÂßã: $(date)" | tee -a "$log_file"
    local start=$(date +%s)
    
    # 1Ô∏è‚É£ MarkDuplicates
    gatk MarkDuplicates \
        -I "$bam" \
        -O "$bam_markdup" \
        --METRICS_FILE "$metrics" \
        --CREATE_INDEX true \
        --VALIDATION_STRINGENCY LENIENT \
        --TMP_DIR "${OUT_DIR}/tmp" \
        2&gt;&gt; "$log_file"
    
    if [[ $? -eq 0 ]]; then
        rm -f "$bam" "${bam}.bai"
    fi
    
    # 2Ô∏è‚É£ gVCFÁîüÊàêÔºàÂçïÁ∫øÁ®ãÔºâ
    gatk HaplotypeCaller \
        -R "$REF" \
        -I "$bam_markdup" \
        -O "$gvcf" \
        -ERC GVCF \
        --native-pair-hmm-threads 1 \
        2&gt;&gt; "$log_file"
    
    if [[ $? -eq 0 ]]; then
        gatk IndexFeatureFile -I "$gvcf" 2&gt;&gt; "$log_file"
        rm -f "$bam_markdup" "${bam_markdup}.bai"
    fi
    
    local end=$(date +%s)
    local runtime=$((end-start))
    echo "[INFO] [$sample] gVCFÂÆåÊàê ‚úÖ (ËÄóÊó∂: $runtime Áßí)" | tee -a "$log_file"
}

# ÂØºÂá∫ÂáΩÊï∞ÂíåÁéØÂ¢ÉÂèòÈáè‰æõparallel‰ΩøÁî®
export -f generate_gvcf
export OUT_DIR REF LOG_DIR

# -------------------------------
# 1Ô∏è‚É£ ÂÖàÂ§ÑÁêÜÂ∑≤Â≠òÂú®ÁöÑBAMÊñá‰ª∂ÔºàÂπ∂Ë°åÁîüÊàêgVCFÔºâ
# -------------------------------
if [[ ${#existing_bams[@]} -gt 0 ]]; then
    echo "[INFO] ÂºÄÂßãÂ§ÑÁêÜÂ∑≤Â≠òÂú®ÁöÑ ${#existing_bams[@]} ‰∏™BAMÊñá‰ª∂..."
    
    # ËøáÊª§ÊéâÂ∑≤ÊúâgVCFÁöÑBAMÊñá‰ª∂
    need_process_bams=()
    for bam in "${existing_bams[@]}"; do
        sample=$(basename "$bam" .sorted.bam)
        gvcf="${OUT_DIR}/${sample}.g.vcf.gz"
        if [[ ! -s "$gvcf" ]]; then
            need_process_bams+=("$bam")
        fi
    done
    
    echo "[INFO] ÈúÄË¶ÅÂ§ÑÁêÜgVCFÁöÑBAMÊñá‰ª∂: ${#need_process_bams[@]} ‰∏™"
    
    # ÂàÜÊâπÂπ∂Ë°åÂ§ÑÁêÜ
    i=0
    while [[ $i -lt ${#need_process_bams[@]} ]]; do
        batch=("${need_process_bams[@]:$i:$BATCH_GVCF}")
        batch_num=$((i/BATCH_GVCF+1))
        echo "[INFO] Âπ∂Ë°åÁîüÊàêgVCFÊâπÊ¨° ${batch_num}: ${#batch[@]} ‰∏™Ê†∑Êú¨"
        
        # ‰ΩøÁî®parallelÂêåÊó∂ËøêË°å12‰∏™gVCFÁîüÊàê‰ªªÂä°
        printf "%s\n" "${batch[@]}" | parallel -j $BATCH_GVCF --eta \
            "generate_gvcf {}"
        
        i=$((i + BATCH_GVCF))
    done
else
    echo "[INFO] Ê≤°ÊúâÂ∑≤Â≠òÂú®ÁöÑBAMÊñá‰ª∂ÈúÄË¶ÅÂ§ÑÁêÜ"
fi

# -------------------------------
# 2Ô∏è‚É£ Ëé∑ÂèñÊú™ÊØîÂØπÁöÑÊ†∑Êú¨ÂàóË°®
# -------------------------------
processed_samples=()
for bam in "${existing_bams[@]}"; do
    sample=$(basename "$bam" .sorted.bam)
    processed_samples+=("$sample")
done

need_align_samples=()
for fq1 in "${samples[@]}"; do
    sample=$(basename "$fq1" | sed 's/_clean.R1.fastq.gz//')
    if [[ ! " ${processed_samples[@]} " =~ " ${sample} " ]]; then
        need_align_samples+=("$fq1")
    fi
done

echo "[INFO] ÈúÄË¶ÅÊØîÂØπÊñ∞Ê†∑Êú¨: ${#need_align_samples[@]} ‰∏™"

# -------------------------------
# 3Ô∏è‚É£ ÊØîÂØπÊñ∞ÁöÑÊ†∑Êú¨Âπ∂ÂàÜÊâπÂπ∂Ë°åÁîüÊàêgVCF
# -------------------------------
if [[ ${#need_align_samples[@]} -gt 0 ]]; then
    count=0
    batch_count=0
    current_batch_bams=()
    
    for fq1 in "${need_align_samples[@]}"; do
        # ÊØîÂØπÂçï‰∏™Ê†∑Êú¨
        run_alignment "$fq1"
        
        sample=$(basename "$fq1" | sed 's/_clean.R1.fastq.gz//')
        current_batch_bams+=("$OUT_DIR/${sample}.sorted.bam")
        count=$((count+1))
        
        # ÊØèÊØîÂØπÂÆåBATCH_GVCF‰∏™Ê†∑Êú¨ÔºåÂπ∂Ë°åÁîüÊàê‰∏ÄÊâπgVCF
        if [[ $count -ge $BATCH_GVCF ]]; then
            batch_count=$((batch_count+1))
            echo "[INFO] Âπ∂Ë°åÁîüÊàêÊñ∞Ê†∑Êú¨gVCFÊâπÊ¨° ${batch_count}: ${#current_batch_bams[@]} ‰∏™Ê†∑Êú¨"
            
            # ‰ΩøÁî®parallelÂêåÊó∂ËøêË°å12‰∏™gVCFÁîüÊàê‰ªªÂä°
            printf "%s\n" "${current_batch_bams[@]}" | parallel -j $BATCH_GVCF --eta \
                "generate_gvcf {}"
            
            count=0
            current_batch_bams=()
        fi
    done
    
    # Â§ÑÁêÜÂâ©‰ΩôÁöÑÊñ∞Ê†∑Êú¨
    if [[ $count -gt 0 ]]; then
        echo "[INFO] Âπ∂Ë°åÂ§ÑÁêÜÂâ©‰ΩôÊñ∞Ê†∑Êú¨gVCF: ${#current_batch_bams[@]} ‰∏™"
        printf "%s\n" "${current_batch_bams[@]}" | parallel -j $BATCH_GVCF --eta \
            "generate_gvcf {}"
    fi
else
    echo "[INFO] Ê≤°ÊúâÈúÄË¶ÅÊØîÂØπÁöÑÊñ∞Ê†∑Êú¨"
fi

# Ê∏ÖÁêÜ‰∏¥Êó∂ÁõÆÂΩï
rm -rf "${OUT_DIR}/tmp" 2&gt;/dev/null

echo "[INFO] ÂÖ®ÈÉ®Ê†∑Êú¨Â§ÑÁêÜÂÆåÊàê: $(date)"
echo "[INFO] ÊúÄÁªàgVCFÊñá‰ª∂Êï∞: $(find "$OUT_DIR" -name "*.g.vcf.gz" | wc -l)"
echo "[INFO] ËæìÂá∫ÁõÆÂΩï: $OUT_DIR"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="üìò-ÂäüËÉΩÊ¶ÇËø∞"><a href="#üìò-ÂäüËÉΩÊ¶ÇËø∞" class="headerlink" title="üìò ÂäüËÉΩÊ¶ÇËø∞"></a>üìò ÂäüËÉΩÊ¶ÇËø∞</h3><p>ËØ•ËÑöÊú¨‰ªé <strong>Clean FastQ</strong> Êñá‰ª∂Âá∫ÂèëÔºåËá™Âä®ÂÆåÊàê‰ª•‰∏ãÊ≠•È™§Ôºö</p>
<ol>
<li>ÂèÇËÄÉÂü∫Âõ†ÁªÑÁ¥¢ÂºïÊ£ÄÊü•Ôºõ</li>
<li>BWA ÊØîÂØπÁîüÊàê BAM Êñá‰ª∂Ôºõ</li>
<li>GATK ÂéªÈáçÔºàMarkDuplicatesÔºâÔºõ</li>
<li>ÁîüÊàêÊØè‰∏™Ê†∑Êú¨ÁöÑ gVCFÔºõ</li>
<li>Ëá™Âä®Ë∑≥ËøáÂ∑≤ÂÆåÊàêÊ≠•È™§Ôºõ</li>
<li>Âπ∂Ë°åÂàÜÊâπÊâßË°å‰ª•ËäÇÁúÅÂÜÖÂ≠ò‰∏éÁ£ÅÁõò„ÄÇ</li>
</ol>
<h3 id="üìÇ-ËæìÂÖ•‰∏éËæìÂá∫ÁõÆÂΩï"><a href="#üìÇ-ËæìÂÖ•‰∏éËæìÂá∫ÁõÆÂΩï" class="headerlink" title="üìÇ ËæìÂÖ•‰∏éËæìÂá∫ÁõÆÂΩï"></a>üìÇ ËæìÂÖ•‰∏éËæìÂá∫ÁõÆÂΩï</h3><table>
<thead>
<tr>
<th>Ë∑ØÂæÑ</th>
<th>ÂÜÖÂÆπ</th>
</tr>
</thead>
<tbody><tr>
<td><code>/Clean_data/</code></td>
<td>fastp ËøáÊª§ÂêéÁöÑ reads</td>
</tr>
<tr>
<td><code>/Align/</code></td>
<td>ÊØîÂØπ‰∏é gVCF ËæìÂá∫ÁõÆÂΩï</td>
</tr>
<tr>
<td><code>/Align/logs/</code></td>
<td>ÊØè‰∏™Èò∂ÊÆµÊó•Âøó</td>
</tr>
</tbody></table>
<h3 id="‚öôÔ∏è-Ê≠•È™§Ëß£Êûê"><a href="#‚öôÔ∏è-Ê≠•È™§Ëß£Êûê" class="headerlink" title="‚öôÔ∏è Ê≠•È™§Ëß£Êûê"></a>‚öôÔ∏è Ê≠•È™§Ëß£Êûê</h3><h4 id="1Ô∏è‚É£-ÂèÇËÄÉÂü∫Âõ†ÁªÑÂáÜÂ§á"><a href="#1Ô∏è‚É£-ÂèÇËÄÉÂü∫Âõ†ÁªÑÂáÜÂ§á" class="headerlink" title="1Ô∏è‚É£ ÂèÇËÄÉÂü∫Âõ†ÁªÑÂáÜÂ§á"></a>1Ô∏è‚É£ ÂèÇËÄÉÂü∫Âõ†ÁªÑÂáÜÂ§á</h4><p>ËÑöÊú¨Ëá™Âä®Ê£ÄÊµãÂπ∂ÁîüÊàêÔºö</p>
<ul>
<li><code>.bwt</code> ‚Üí BWA ÊØîÂØπÁ¥¢Âºï</li>
<li><code>.fai</code> ‚Üí samtools Á¥¢Âºï</li>
<li><code>.dict</code> ‚Üí GATK Â∫èÂàóÂ≠óÂÖ∏</li>
</ul>
<h4 id="2Ô∏è‚É£-Ê†∑Êú¨ÊØîÂØπÔºàBWA-MEMÔºâ"><a href="#2Ô∏è‚É£-Ê†∑Êú¨ÊØîÂØπÔºàBWA-MEMÔºâ" class="headerlink" title="2Ô∏è‚É£ Ê†∑Êú¨ÊØîÂØπÔºàBWA MEMÔºâ"></a>2Ô∏è‚É£ Ê†∑Êú¨ÊØîÂØπÔºàBWA MEMÔºâ</h4><ul>
<li>ÂØπÊØè‰∏™Ê†∑Êú¨ËøõË°åÊØîÂØπÔºõ</li>
<li>Ëá™Âä®ËØÜÂà´ÂçïÂèåÁ´ØÔºõ</li>
<li>ËæìÂá∫ÊéíÂ∫è BAMÔºõ</li>
<li>ÁîüÊàêÊó•ÂøóÊñá‰ª∂ËÆ∞ÂΩïËÄóÊó∂‰∏éÁä∂ÊÄÅ„ÄÇ</li>
</ul>
<p>Á§∫‰æãËæìÂá∫Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">BM_S_1.sorted.bam
logs/BM_S_1.bwa.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="3Ô∏è‚É£-ÂéªÈáç‰∏é-gVCF-ÁîüÊàê"><a href="#3Ô∏è‚É£-ÂéªÈáç‰∏é-gVCF-ÁîüÊàê" class="headerlink" title="3Ô∏è‚É£ ÂéªÈáç‰∏é gVCF ÁîüÊàê"></a>3Ô∏è‚É£ <del>ÂéªÈáç‰∏é gVCF ÁîüÊàê</del></h4><blockquote>
<p>ÂéªÈáçÈÄüÂ∫¶ËøáÊÖ¢ÔºåÂΩ±ÂìçÊï¥‰ΩìËøêË°å‰∫ã‰ª∂ÔºåÊîæÂà∞‰∏ã‰∏ÄÊ≠•Â§öÁ∫øÁ®ãËøêË°å</p>
</blockquote>
<p>ÊØè‰∏™ BAM Êñá‰ª∂ÈÄöËøá GATK Â§ÑÁêÜÔºö</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gatk MarkDuplicates
gatk HaplotypeCaller <span class="token parameter variable">-ERC</span> GVCF<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<blockquote>
<p><strong>ËØ¥ÊòéÔºö</strong></p>
<ul>
<li>MarkDuplicates ÂéªÈô§ PCR ÈáçÂ§çÔºõ</li>
<li>HaplotypeCaller ËæìÂá∫ÊØè‰∏™Ê†∑Êú¨ÁöÑ <code>g.vcf.gz</code>Ôºõ</li>
<li>Ëá™Âä®ÁîüÊàêÁ¥¢Âºï <code>.tbi</code>„ÄÇ</li>
</ul>
</blockquote>
<h4 id="4Ô∏è‚É£-Âπ∂Ë°åÊéßÂà∂‰∏éÂÆπÈîôÊú∫Âà∂"><a href="#4Ô∏è‚É£-Âπ∂Ë°åÊéßÂà∂‰∏éÂÆπÈîôÊú∫Âà∂" class="headerlink" title="4Ô∏è‚É£ Âπ∂Ë°åÊéßÂà∂‰∏éÂÆπÈîôÊú∫Âà∂"></a>4Ô∏è‚É£ Âπ∂Ë°åÊéßÂà∂‰∏éÂÆπÈîôÊú∫Âà∂</h4><ul>
<li>ÊØèÊâπÊúÄÂ§öÂêåÊó∂Â§ÑÁêÜ 12 ‰∏™Ê†∑Êú¨Ôºõ</li>
<li>Ëá™Âä®Ê£ÄÊµãÂì™‰∫õÊ†∑Êú¨Â∑≤ÂÆåÊàêÔºõ</li>
<li>Â§±Ë¥•Ê†∑Êú¨ËÆ∞ÂΩïÊó•Âøó‰ΩÜ‰∏çÈòªÂ°ûÂêéÁª≠ËøêË°åÔºõ</li>
<li>Ëá™Âä®Ê∏ÖÁêÜ‰∏≠Èó¥Êñá‰ª∂ÔºåËäÇÁúÅÁ£ÅÁõòÁ©∫Èó¥„ÄÇ</li>
</ul>
<h3 id="‚úÖ-ËøêË°åÁªìÊûú"><a href="#‚úÖ-ËøêË°åÁªìÊûú" class="headerlink" title="‚úÖ ËøêË°åÁªìÊûú"></a>‚úÖ ËøêË°åÁªìÊûú</h3><p>ËæìÂá∫ÁªìÊûÑÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">Align/
‚îú‚îÄ‚îÄ BM_S_1.g.vcf.gz
‚îú‚îÄ‚îÄ BM_S_2.g.vcf.gz
‚îî‚îÄ‚îÄ logs/
    ‚îú‚îÄ‚îÄ BM_S_1.gvcf.log
    ‚îî‚îÄ‚îÄ BM_S_2.bwa.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ËøêË°åÁªìÊùüÂêéÁªüËÆ°ËæìÂá∫Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">[INFO] ÊúÄÁªàgVCFÊñá‰ª∂Êï∞: 36
[INFO] ËæìÂá∫ÁõÆÂΩï: Align/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h2 id="‰∏â„ÄÅÂàÜÊüìËâ≤‰ΩìÊâπÈáè-gVCF-ÁîüÊàêÔºàbatch-gvcf-shÔºâ"><a href="#‰∏â„ÄÅÂàÜÊüìËâ≤‰ΩìÊâπÈáè-gVCF-ÁîüÊàêÔºàbatch-gvcf-shÔºâ" class="headerlink" title="‰∏â„ÄÅÂàÜÊüìËâ≤‰ΩìÊâπÈáè gVCF ÁîüÊàêÔºàbatch_gvcf.shÔºâ"></a>‰∏â„ÄÅÂàÜÊüìËâ≤‰ΩìÊâπÈáè gVCF ÁîüÊàêÔºà<code>batch_gvcf.sh</code>Ôºâ</h2><pre class="line-numbers language-none"><code class="language-none">#!/bin/bash
# =========================================
# 12CPUÊúçÂä°Âô®ÂÆâÂÖ®ÁâàÂàÜÈò∂ÊÆµÂ§ÑÁêÜËÑöÊú¨ÔºàÊåâÊüìËâ≤‰ΩìÊâπÈáèÂπ∂ÂèëÔºåËá™Âä®ËÆ°ÁÆóÂπ∂ÂèëÔºâ
# ËæìÂá∫ÁªìÊûÑ: /mnt/disk2/Align/gvcf/chr*/sample.g.vcf.gz
# ‰øùÁïô MarkDuplicates Èò∂ÊÆµ / Êó•Âøó / Ë¥üËΩΩÊ£ÄÊü• / TMP Ê∏ÖÁêÜ
# =========================================

set -o pipefail
umask 002

REF="/home/wanglab/Ywh/adductor_muscle_scar/Genome/GCF_963853765.1_xbMagGiga1.1_genomic.fna"
SOURCE_DIR="/home/wanglab/Ywh/adductor_muscle_scar/ReSeq_Data/DZQD2023092909-b1/Align"
OUT_DIR="/mnt/disk2/Align"
GVCF_DIR="${OUT_DIR}/gvcf"
LOG_DIR="${OUT_DIR}/logs"
TMP_DIR="/mnt/disk2/tmp"

# --------- Áî®Êà∑ÂèØË∞ÉÂèÇÊï∞ ----------
# Âπ∂Âèë/Á∫øÁ®ãËÆæÁΩÆÔºàÊåâÈúÄ‰øÆÊîπÔºâ
STAGE1_CONCURRENT=5      # MarkDuplicates Âπ∂ÂèëÊï∞ÔºàI/OÂØÜÈõÜÔºâ
STAGE2_CONCURRENT=5      # ÊúÄÂ§ßÊüìËâ≤‰ΩìÂπ∂Ë°å‰ªªÂä°‰∏äÈôêÔºàÈÄªËæë‰∏äÂÜçÂèóÂèØÁî®CPUÁ∫¶ÊùüÔºâ
GVCF_THREADS=2           # ÊØè‰∏™ HaplotypeCaller ‰ªªÂä°Á∫øÁ®ãÊï∞

# Á≥ªÁªüÈ¢ÑÁïô‰∏éÈòàÂÄº
RESERVED_CPUS=2          # È¢ÑÁïôÁªôÁ≥ªÁªüÁöÑ CPU Êï∞
MAX_LOAD=10.0            # Á≥ªÁªüÂπ≥ÂùáË¥üËΩΩÈòàÂÄºÔºàË∂ÖËøáÂàôÁ≠âÂæÖÔºâ
MIN_FREE_MEM_GB=4        # ÊúÄ‰ΩéÂèØÁî®ÂÜÖÂ≠ò (GB)
# ---------------------------------

mkdir -p "$OUT_DIR" "$GVCF_DIR" "$LOG_DIR" "$TMP_DIR"

echo "[INFO] ÂêØÂä®Êó∂Èó¥: $(date)"
echo "[INFO] REF: $REF"
echo "[INFO] SOURCE_DIR: $SOURCE_DIR"
echo "[INFO] OUT_DIR: $OUT_DIR"
echo "[INFO] GVCF_DIR: $GVCF_DIR"
echo "[INFO] STAGE1_CONCURRENT: $STAGE1_CONCURRENT"
echo "[INFO] STAGE2_CONCURRENT (user cap): $STAGE2_CONCURRENT"
echo "[INFO] GVCF_THREADS (per task): $GVCF_THREADS"
echo "[INFO] RESERVED_CPUS: $RESERVED_CPUS"
echo "====================================="

# -------------------------------
# Á≥ªÁªü/ËµÑÊ∫ê Ê£ÄÊü•ÂáΩÊï∞
# -------------------------------
check_system_health() {
    # return 0 = ok, 1 = not ok (caller should sleep &amp; retry)
    local current_load
    current_load=$(uptime | awk -F'load average:' '{print $2}' | cut -d, -f1 | tr -d ' ')
    local available_mem
    available_mem=$(free -g | awk 'NR==2{print $7}')
    echo "[SYSTEM] ÂΩìÂâçË¥üËΩΩ: $current_load, ÂèØÁî®ÂÜÖÂ≠ò: ${available_mem}G"
    # load threshold
    if (( $(echo "$current_load &gt; $MAX_LOAD" | bc -l) )); then
        echo "[WARN] Á≥ªÁªüË¥üËΩΩËøáÈ´ò ($current_load &gt; $MAX_LOAD)"
        return 1
    fi
    # memory threshold
    if [[ $available_mem -lt $MIN_FREE_MEM_GB ]]; then
        echo "[WARN] ÂèØÁî®ÂÜÖÂ≠ò‰∏çË∂≥ (${available_mem}G &lt; ${MIN_FREE_MEM_GB}G)"
        return 1
    fi
    return 0
}

# -------------------------------
# ÂèÇËÄÉÂü∫Âõ†ÁªÑÁ¥¢ÂºïÊ£ÄÊü•
# -------------------------------
if [[ ! -f "${REF}" ]]; then
    echo "[ERROR] ÂèÇËÄÉÂü∫Âõ†ÁªÑÊñá‰ª∂‰∏çÂ≠òÂú®: $REF"
    exit 1
fi
[[ ! -f "${REF}.fai" ]] &amp;&amp; echo "[INFO] ÁîüÊàê samtools faidx..." &amp;&amp; samtools faidx "$REF"
DICT_FILE="${REF%.*}.dict"
[[ ! -f "$DICT_FILE" ]] &amp;&amp; echo "[INFO] ÁîüÊàê GATK Â∫èÂàóÂ≠óÂÖ∏..." &amp;&amp; gatk CreateSequenceDictionary -R "$REF" -O "$DICT_FILE"

# -------------------------------
# Á£ÅÁõòÁ©∫Èó¥Ê£ÄÊü•
# -------------------------------
disk_usage=$(df -h "$OUT_DIR" | awk 'NR==2 {print $5}' | sed 's/%//')
echo "[INFO] $OUT_DIR Á£ÅÁõò‰ΩøÁî®Áéá: ${disk_usage}%"
if [[ $disk_usage -gt 90 ]]; then
    echo "[ERROR] Á£ÅÁõò‰ΩøÁî®Áéá &gt; 90%ÔºåËØ∑Ê∏ÖÁêÜÂêéÂÜçËøêË°å"
    exit 1
fi

# -------------------------------
# ÂèëÁé∞ BAM ÂàóË°®ÔºàÂ∑≤ÊéíÂ∫è BAMÔºâ
# -------------------------------
bam_files=($(find "$SOURCE_DIR" -type f -name "*.sorted.bam" | sort))
total_bam=${#bam_files[@]}
if [[ $total_bam -eq 0 ]]; then
    echo "[ERROR] Êú™ÊâæÂà∞‰ªª‰ΩïÂ∑≤ÊéíÂ∫èÁöÑBAMÊñá‰ª∂Ôºàpattern: *.sorted.bamÔºâ in $SOURCE_DIR"
    exit 1
fi
echo "[INFO] ÊâæÂà∞ $total_bam ‰∏™Â∑≤ÊéíÂ∫èBAMÊñá‰ª∂"

# -------------------------------
# ËÆ°ÁÆóÂÆûÈôÖÂèØÂπ∂ÂèëÊüìËâ≤‰ΩìÊï∞ÔºàÂèóCPU‰∏éÁî®Êà∑‰∏äÈôêÂèåÈáçÁ∫¶ÊùüÔºâ
# -------------------------------
TOTAL_CPUS=$(nproc --all 2&gt;/dev/null || echo 12)
USABLE_CPUS=$(( TOTAL_CPUS - RESERVED_CPUS ))
if [[ $USABLE_CPUS -lt 1 ]]; then
    echo "[ERROR] ÂèØÁî® CPU Â§™Â∞ë: $USABLE_CPUS"
    exit 1
fi
# ÁêÜËÆ∫‰∏äÊúÄÂ§ßÂêåÊó∂ËøêË°åÁöÑ HaplotypeCaller ‰ªªÂä°Êï∞ = floor(USABLE_CPUS / GVCF_THREADS)
AUTO_STAGE2_MAX=$(( USABLE_CPUS / GVCF_THREADS ))
if [[ $AUTO_STAGE2_MAX -lt 1 ]]; then AUTO_STAGE2_MAX=1; fi
# ÊúÄÁªàÂπ∂ÂèëÂèñ min(user cap, auto cap)
if [[ $STAGE2_CONCURRENT -gt $AUTO_STAGE2_MAX ]]; then
    EFFECTIVE_STAGE2_CONCURRENT=$AUTO_STAGE2_MAX
else
    EFFECTIVE_STAGE2_CONCURRENT=$STAGE2_CONCURRENT
fi

echo "[INFO] ÊÄª CPU: $TOTAL_CPUS, ÂèØÁî® CPU (Êâ£Èô§ reserved): $USABLE_CPUS"
echo "[INFO] ÊåâÊØè‰ªªÂä° $GVCF_THREADS Á∫øÁ®ãËÆ°ÁÆóÔºåËá™Âä®ÂèØÂπ∂ÂèëÊï∞: $AUTO_STAGE2_MAX"
echo "[INFO] ÊúÄÁªà STAGE2 Âπ∂ÂèëÊï∞ÔºàÁîüÊïàÔºâ: $EFFECTIVE_STAGE2_CONCURRENT"

# -------------------------------
# MarkDuplicates ÂáΩÊï∞
# -------------------------------
run_markduplicates() {
    local bam="$1"
    local sample
    sample=$(basename "$bam" .sorted.bam)
    local bam_markdup="${OUT_DIR}/${sample}.sorted.markdup.bam"
    local metrics="${OUT_DIR}/${sample}.markdup.metrics.txt"
    local log_file="${LOG_DIR}/${sample}.markdup.log"

    if [[ -s "$bam_markdup" ]]; then
        echo "[INFO] [$sample] MarkDuplicates Â∑≤Â≠òÂú®ÔºåË∑≥Ëøá"
        return 0
    fi
    
    echo "[INFO] [$sample] MarkDuplicates ÂºÄÂßã: $(date)" | tee -a "$log_file"
    local start=$(date +%s)
    # run MarkDuplicates (taskset ÂèØËßÜÈúÄÊ±ÇË∞ÉÊï¥)
    gatk MarkDuplicates \
        -I "$bam" \
        -O "$bam_markdup" \
        --METRICS_FILE "$metrics" \
        --CREATE_INDEX true \
        --VALIDATION_STRINGENCY LENIENT \
        --TMP_DIR "$TMP_DIR" \
        --ASSUME_SORTED true \
        2&gt;&gt; "$log_file"
    local rc=$?
    if [[ $rc -ne 0 || ! -s "$bam_markdup" ]]; then
        echo "[ERROR] [$sample] MarkDuplicates Â§±Ë¥• (rc=$rc)" | tee -a "$log_file"
        return 1
    fi
    local end=$(date +%s)
    echo "[INFO] [$sample] MarkDuplicates ÂÆåÊàê ‚úÖ (ËÄóÊó∂ $((end-start))s)" | tee -a "$log_file"
    return 0
}

# -------------------------------
# ÊåâÊüìËâ≤‰Ωì‰∏∫Âçï‰ΩçÔºåÂ§ÑÁêÜÂçï‰∏™ÊüìËâ≤‰ΩìÔºöÂØπËØ•ÊüìËâ≤‰ΩìÂπ∂Ë°åÂ§ÑÁêÜÊâÄÊúâÊ†∑Êú¨ÔºàÂèóÂÖ®Â±ÄÂπ∂ÂèëÈôêÂà∂Ôºâ
# run_chr_task chr bam1 bam2 bam3 ...
# -------------------------------
run_chr_task() {
    local chr="$1"; shift
    local bam_list=("$@")
    local chr_dir="${GVCF_DIR}/${chr}"
    mkdir -p "$chr_dir"
    echo "[INFO] [chr=$chr] Â§ÑÁêÜ ${#bam_list[@]} ‰∏™Ê†∑Êú¨ÂºÄÂßã: $(date)"

    for bam in "${bam_list[@]}"; do
        sample=$(basename "$bam" .sorted.markdup.bam)
        gvcf="${chr_dir}/${sample}.g.vcf.gz"
        logf="${LOG_DIR}/${sample}.${chr}.gvcf.log"
    
        if [[ -s "$gvcf" ]]; then
            echo "[INFO] [$sample $chr] Â∑≤Â≠òÂú®ÔºåË∑≥Ëøá"
            continue
        fi
    
        # Á≠âÂæÖÁ≥ªÁªüÂÅ•Â∫∑
        while ! check_system_health; do
            sleep 20
        done
    
        echo "[INFO] [$sample $chr] ÂºÄÂßã HaplotypeCaller (threads=$GVCF_THREADS)" | tee -a "$logf"
        start_t=$(date +%s)
        gatk HaplotypeCaller \
            -R "$REF" \
            -I "$bam" \
            -O "$gvcf" \
            -L "$chr" \
            -ERC GVCF \
            --native-pair-hmm-threads $GVCF_THREADS \
            --tmp-dir "$TMP_DIR" \
            2&gt;&gt; "$logf"
        rc=$?
        if [[ $rc -ne 0 || ! -s "$gvcf" ]]; then
            echo "[ERROR] [$sample $chr] HaplotypeCaller Â§±Ë¥• (rc=$rc)" | tee -a "$logf"
            # Â§±Ë¥•‰∏çÁªàÊ≠¢ÊâπÊ¨°ÔºåÁªßÁª≠ÂêéÈù¢ÁöÑÊ†∑Êú¨
        else
            end_t=$(date +%s)
            echo "[INFO] [$sample $chr] ÂÆåÊàê ‚úÖ (ËÄóÊó∂ $((end_t-start_t))s)" | tee -a "$logf"
        fi
    done
    
    echo "[INFO] [chr=$chr] ÂÖ®ÈÉ®Ê†∑Êú¨Â§ÑÁêÜÂÆåÊàê: $(date)"
}

# -------------------------------
# Âπ∂ÂèëÂêØÂä®ÂáΩÊï∞ÔºàÁî®‰∫éÈò∂ÊÆµ1ÂíåÈò∂ÊÆµ2ÁöÑÂπ∂ÂèëÊéßÂà∂Ôºâ
#   Ë∞ÉÁî®Á∫¶ÂÆö:
#     run_parallel func arg1 arg2 ... --max N --name "desc"
#   ÊàñËÄÖ‰∏∫ÂÖºÂÆπÊóßË∞ÉÁî®Ôºå‰∏ãÈù¢‰πüÊèê‰æõÂü∫‰∫é positional ÂèÇÊï∞ÁöÑÂ∞ÅË£Ö
# -------------------------------
run_parallel() {
    # ÁÆÄÂçïÁöÑ positional parsing: ÂèÇÊï∞‰∏≠ÂåÖÂê´ --max Âíå --name
    local args=("$@")
    local max=1
    local name="parallel"
    # parse from end
    for (( i=${#args[@]}-1; i&gt;=0; i-- )); do
        if [[ "${args[i]}" == --max ]]; then
            max="${args[i+1]}"
            unset 'args[i]' 'args[i+1]'
            break
        fi
    done
    for (( i=${#args[@]}-1; i&gt;=0; i-- )); do
        if [[ "${args[i]}" == --name ]]; then
            name="${args[i+1]}"
            unset 'args[i]' 'args[i+1]'
            break
        fi
    done

    local func="${args[0]}"
    shift
    # remaining args are the payload for invocation; if more than one payload, treat as array items
    local payloads=("${args[@]}")
    
    # If func is run_chr_task and first payload is a chr + list, we want to spawn functions by payload elements.
    # For our usage, we'll call run_parallel with payloads each being a string token representing a job invocation:
    # e.g. run_parallel run_markduplicates "$bam1" "$bam2" ... --max 4 --name "MarkDuplicates"
    # Simpler approach: launch each payload as separate background call to func with that payload as single arg.
    local total=${#payloads[@]}
    local idx=0
    echo "[INFO] [${name}] Âπ∂Ë°åÂêØÂä®: total=$total, max=$max"
    while [[ $idx -lt $total ]]; do
        # spawn while respecting max
        while [[ $(jobs -r | wc -l) -ge $max ]]; do
            sleep 5
        done
        item="${payloads[idx]}"
        # For run_markduplicates style: item is a path; call func "$item" &amp;
        # For run_chr_task batch invocation we will call it differently below.
        $func "$item" &amp;
        idx=$((idx+1))
        sleep 0.5
    done
    wait
    echo "[INFO] [${name}] Âπ∂Ë°å‰ªªÂä°ÂÖ®ÈÉ®ÂÆåÊàê"
}

# -------------------------------
# MAIN: Èò∂ÊÆµ1 MarkDuplicatesÔºàÂπ∂Ë°åÔºâ
# -------------------------------
echo "========================"
echo "[MAIN] Èò∂ÊÆµ1: MarkDuplicates"
echo "========================"

need_markdup=()
for bam in "${bam_files[@]}"; do
    sample=$(basename "$bam" .sorted.bam)
    target="${OUT_DIR}/${sample}.sorted.markdup.bam"
    if [[ ! -s "$target" ]]; then
        need_markdup+=("$bam")
    else
        echo "[INFO] $sample MarkDuplicates Â∑≤Â≠òÂú®ÔºåË∑≥Ëøá"
    fi
done

if [[ ${#need_markdup[@]} -gt 0 ]]; then
    echo "[INFO] ÈúÄË¶Å MarkDuplicates ÁöÑÊ†∑Êú¨Êï∞: ${#need_markdup[@]}"
    # ‰ΩøÁî® GNU parallel Ëã•Á≥ªÁªüÂÆâË£Ö‰πüË°åÔºå‰ΩÜÊ≠§Â§ÑÊàë‰ª¨Áî® shell job ÊéßÂà∂Ôºö
    max_conc=$STAGE1_CONCURRENT
    for bam in "${need_markdup[@]}"; do
        while [[ $(jobs -r | wc -l) -ge $max_conc ]]; do
            sleep 5
        done
        run_markduplicates "$bam" &amp;
        sleep 0.5
    done
    wait
else
    echo "[INFO] ÊâÄÊúâÊ†∑Êú¨Â∑≤ÂÆåÊàê MarkDuplicates"
fi

# -------------------------------
# MAIN: Èò∂ÊÆµ2 ÊåâÊüìËâ≤‰ΩìÊâπÈáèÂπ∂ÂèëÁîüÊàê gVCF
#   - Êàë‰ª¨Â∞ÜÊØè‰∏™ÊüìËâ≤‰Ωì‰Ωú‰∏∫‰∏Ä‰∏™Âπ∂Ë°å‰ªªÂä°ÔºàÂ§ÑÁêÜÊâÄÊúâÊ†∑Êú¨ÁöÑËØ• chrÔºâ
#   - ÊéßÂà∂Âπ∂ÂèëÊï∞‰∏∫ EFFECTIVE_STAGE2_CONCURRENT
# -------------------------------
echo "========================"
echo "[MAIN] Èò∂ÊÆµ2: ÊåâÊüìËâ≤‰ΩìÊâπÈáèÂπ∂ÂèëÁîüÊàê gVCF"
echo "========================"

# ÈáçÊñ∞ÂàóÂá∫Â∑≤ÁªèÂáÜÂ§áÂ•ΩÁöÑ markdup BAMÔºàÂè™ÂèñÂ≠òÂú®ÁöÑÔºâ
markdup_bams=()
for bm in "${bam_files[@]}"; do
    sample=$(basename "$bm" .sorted.bam)
    md="${OUT_DIR}/${sample}.sorted.markdup.bam"
    if [[ -s "$md" ]]; then
        markdup_bams+=("$md")
    else
        echo "[WARN] $sample ÁöÑ markdup BAM ‰∏çÂ≠òÂú®ÔºåË∑≥ËøáËØ•Ê†∑Êú¨" 
    fi
done

if [[ ${#markdup_bams[@]} -eq 0 ]]; then
    echo "[ERROR] Êó†ÂèØÁî® markdup BAMÔºåÈÄÄÂá∫"
    exit 1
fi

# Ëé∑ÂèñÊüìËâ≤‰Ωì/contig ÂàóË°®Ôºà‰ΩøÁî® .fai Á¨¨‰∏ÄÂàóÔºâ
chromosomes=($(cut -f1 "${REF}.fai"))
echo "[INFO] ÊüìËâ≤‰ΩìËÆ°Êï∞: ${#chromosomes[@]}"

# Âπ∂Ë°åÂêØÂä®ÊØè‰∏™ÊüìËâ≤‰Ωì‰ªªÂä°Ôºå‰ΩÜÈôêÂà∂Âπ∂Âèë‰∏∫ EFFECTIVE_STAGE2_CONCURRENT
chr_count=${#chromosomes[@]}
started=0
for chr in "${chromosomes[@]}"; do
    # wait until running jobs &lt; limit and system healthy
    while [[ $(jobs -r | wc -l) -ge $EFFECTIVE_STAGE2_CONCURRENT ]]; do
        echo "[WAIT] ÂΩìÂâç Chr Âπ∂Âèë: $(jobs -r | wc -l)/$EFFECTIVE_STAGE2_CONCURRENTÔºåÊ£ÄÊü•Á≥ªÁªü..."
        sleep 8
    done
    while ! check_system_health; do
        echo "[WAIT] Á≥ªÁªüËµÑÊ∫êÁ¥ßÂº†ÔºåÁ≠âÂæÖ..."
        sleep 15
    done
    echo "[INFO] ÂêØÂä® chr=$chr ÁöÑÊâπÈáè‰ªªÂä°ÔºàÂ§ÑÁêÜ ${#markdup_bams[@]} ‰∏™Ê†∑Êú¨Ôºâ"
    run_chr_task "$chr" "${markdup_bams[@]}" &amp;
    started=$((started+1))
    sleep 1
done

# Á≠âÂæÖÊâÄÊúâÊüìËâ≤‰Ωì‰ªªÂä°ÂÆåÊàê
wait

# -------------------------------
# ÂÆåÊàê &amp; Ê∏ÖÁêÜ
# -------------------------------
echo "[INFO] ÊâÄÊúâÊüìËâ≤‰ΩìÊâπÈáè‰ªªÂä°ÂÆåÊàêÔºåÂºÄÂßãÁªüËÆ°"
final_gvcf_count=$(find "$GVCF_DIR" -type f -name "*.g.vcf.gz" | wc -l || echo 0)
echo "[INFO] ÁîüÊàê gVCF ÊÄªÊï∞: $final_gvcf_count"
echo "[INFO] Ê∏ÖÁêÜ TMP..."
rm -rf "${TMP_DIR}"/* 2&gt;/dev/null || true

echo "[INFO] ÂÖ®ÊµÅÁ®ãÂÆåÊàê: $(date)"
echo "[INFO] ËæìÂá∫ÁõÆÂΩï: $GVCF_DIR"
echo "====================================="<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="üìò-ÂäüËÉΩÊ¶ÇËø∞-1"><a href="#üìò-ÂäüËÉΩÊ¶ÇËø∞-1" class="headerlink" title="üìò ÂäüËÉΩÊ¶ÇËø∞"></a>üìò ÂäüËÉΩÊ¶ÇËø∞</h3><p>ÂΩìÊ†∑Êú¨Êï∞ËæÉÂ§öÊàñÊúçÂä°Âô®ËµÑÊ∫êÊúâÈôêÊó∂ÔºåÊé®Ëçê‰ΩøÁî®Êú¨ËÑöÊú¨„ÄÇ<br> ÂÆÉÊîØÊåÅ <strong>ÊåâÊüìËâ≤‰ΩìÂàÜÊâπÂπ∂Ë°å</strong>ÔºåËá™Âä®ËÆ°ÁÆóÁ≥ªÁªüË¥üËΩΩÔºåÈò≤Ê≠¢ËøáËΩΩ„ÄÇ</p>
<blockquote>
<p>ÁâπÁÇπÔºö</p>
<ul>
<li>Âä®ÊÄÅ CPU / ÂÜÖÂ≠òÊ£ÄÊµãÔºõ</li>
<li>Ëá™Âä®ÊöÇÂÅú‰∏éÊÅ¢Â§çÔºõ</li>
<li>MarkDuplicates + HaplotypeCaller ÂàÜÈò∂ÊÆµÔºõ</li>
<li>ËæìÂá∫ÁªìÊûÑÊåâÊüìËâ≤‰ΩìÂàÜÁ±ªÂ≠òÂÇ®„ÄÇ</li>
</ul>
</blockquote>
<h3 id="‚öôÔ∏è-‰∏ªË¶ÅÂèÇÊï∞"><a href="#‚öôÔ∏è-‰∏ªË¶ÅÂèÇÊï∞" class="headerlink" title="‚öôÔ∏è ‰∏ªË¶ÅÂèÇÊï∞"></a>‚öôÔ∏è ‰∏ªË¶ÅÂèÇÊï∞</h3><table>
<thead>
<tr>
<th>ÂèÇÊï∞</th>
<th>ËØ¥Êòé</th>
<th>ÈªòËÆ§ÂÄº</th>
</tr>
</thead>
<tbody><tr>
<td><code>STAGE1_CONCURRENT</code></td>
<td>ÂêåÊó∂ËøêË°åÁöÑ MarkDuplicates Êï∞Èáè</td>
<td>5</td>
</tr>
<tr>
<td><code>STAGE2_CONCURRENT</code></td>
<td>ÊØèÊ¨°ËøêË°åÁöÑÊüìËâ≤‰Ωì‰ªªÂä°‰∏äÈôê</td>
<td>5</td>
</tr>
<tr>
<td><code>GVCF_THREADS</code></td>
<td>ÊØè‰∏™Ê†∑Êú¨ÁöÑ HaplotypeCaller Á∫øÁ®ãÊï∞</td>
<td>2</td>
</tr>
<tr>
<td><code>MAX_LOAD</code></td>
<td>Á≥ªÁªüÂπ≥ÂùáË¥üËΩΩÈòàÂÄº</td>
<td>10.0</td>
</tr>
<tr>
<td><code>MIN_FREE_MEM_GB</code></td>
<td>ÊúÄ‰ΩéÂâ©‰ΩôÂÜÖÂ≠òÈòàÂÄº</td>
<td>4 GB</td>
</tr>
</tbody></table>
<h3 id="‚öôÔ∏è-Ê†∏ÂøÉÈÄªËæë"><a href="#‚öôÔ∏è-Ê†∏ÂøÉÈÄªËæë" class="headerlink" title="‚öôÔ∏è Ê†∏ÂøÉÈÄªËæë"></a>‚öôÔ∏è Ê†∏ÂøÉÈÄªËæë</h3><ol>
<li><p><strong>Á≥ªÁªüÁõëÊµã</strong></p>
<ul>
<li>ÂÆûÊó∂ÁõëÊéß CPU Ë¥üËΩΩ‰∏éÂÜÖÂ≠òÔºõ</li>
<li>Ëã•Ë∂ÖËøáÈòàÂÄºÂàôÊöÇÂÅú‰ªªÂä°ÔºåÁ°Æ‰øùÁ®≥ÂÆö„ÄÇ</li>
</ul>
</li>
<li><p><strong>ÊåâÊüìËâ≤‰ΩìÂàíÂàÜ‰ªªÂä°</strong></p>
<ul>
<li><p>ÊØè‰∏™Ê†∑Êú¨ÁöÑ BAM Êñá‰ª∂ÊåâÊüìËâ≤‰ΩìË∞ÉÁî® GATKÔºõ</p>
</li>
<li><p>ËæìÂá∫Ë∑ØÂæÑÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">gvcf/chr1/BM_S_1.g.vcf.gz
gvcf/chr2/BM_S_1.g.vcf.gz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
</li>
<li><p><strong>Ëá™Âä®ÈîôËØØË∑≥Ëøá</strong></p>
<ul>
<li>Âçï‰∏™Ê†∑Êú¨Â§±Ë¥•‰∏ç‰ºö‰∏≠Êñ≠Êï¥‰∏™ÊâπÊ¨°Ôºõ</li>
<li>ÊâÄÊúâÊó•Âøó‰øùÂ≠ò‰ª•‰æøÂ§çÊü•„ÄÇ</li>
</ul>
</li>
<li><p><strong>MarkDuplicates Èò∂ÊÆµ‰øùÁïô</strong></p>
<ul>
<li>ÊèêÂâçÂ§ÑÁêÜÂèØÂä†Âø´ÂêéÁª≠ÊüìËâ≤‰ΩìÂàÜÊâπÔºõ</li>
<li>ÂèØÁÅµÊ¥ªÈáçÂêØ‰∏≠Êñ≠‰ªªÂä°„ÄÇ</li>
</ul>
</li>
</ol>
<h3 id="‚úÖ-ËæìÂá∫Á§∫‰æã"><a href="#‚úÖ-ËæìÂá∫Á§∫‰æã" class="headerlink" title="‚úÖ ËæìÂá∫Á§∫‰æã"></a>‚úÖ ËæìÂá∫Á§∫‰æã</h3><pre class="line-numbers language-none"><code class="language-none">/mnt/disk2/Align/
‚îú‚îÄ‚îÄ gvcf/
‚îÇ   ‚îú‚îÄ‚îÄ chr1/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BM_S_1.g.vcf.gz
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ BM_S_2.g.vcf.gz
‚îÇ   ‚îú‚îÄ‚îÄ chr2/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BM_S_1.g.vcf.gz
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ BM_S_2.g.vcf.gz
‚îî‚îÄ‚îÄ logs/
    ‚îú‚îÄ‚îÄ BM_S_1.markdup.log
    ‚îú‚îÄ‚îÄ BM_S_1.chr1.gvcf.log
    ‚îî‚îÄ‚îÄ BM_S_2.chr2.gvcf.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="üí°-ÊµÅÁ®ãÊÄªÁªì"><a href="#üí°-ÊµÅÁ®ãÊÄªÁªì" class="headerlink" title="üí° ÊµÅÁ®ãÊÄªÁªì"></a>üí° ÊµÅÁ®ãÊÄªÁªì</h2><table>
<thead>
<tr>
<th>Èò∂ÊÆµ</th>
<th>ËÑöÊú¨</th>
<th>Ê†∏ÂøÉÂ∑•ÂÖ∑</th>
<th>‰∏ªË¶Å‰ªªÂä°</th>
<th>ËæìÂá∫</th>
</tr>
</thead>
<tbody><tr>
<td>1Ô∏è‚É£</td>
<td>run_fastpl.sh</td>
<td>fastp</td>
<td>Ë¥®ÊéßËøáÊª§</td>
<td>Clean FastQ</td>
</tr>
<tr>
<td>2Ô∏è‚É£</td>
<td>run_bwa_vcf.sh</td>
<td>BWA + GATK</td>
<td>ÊØîÂØπ + gVCF</td>
<td>Align/g.vcf.gz</td>
</tr>
<tr>
<td>3Ô∏è‚É£</td>
<td>batch_gvcf.sh</td>
<td>GATK + Parallel</td>
<td>ÊüìËâ≤‰ΩìÂàÜÊâπ</td>
<td>gvcf/chr*/</td>
</tr>
</tbody></table>
<hr>
<h2 id="üöÄ-Êñ∞ÊâãÂª∫ËÆÆ"><a href="#üöÄ-Êñ∞ÊâãÂª∫ËÆÆ" class="headerlink" title="üöÄ Êñ∞ÊâãÂª∫ËÆÆ"></a>üöÄ Êñ∞ÊâãÂª∫ËÆÆ</h2><ol>
<li><strong>ÂÖàÂ∞èËßÑÊ®°ÊµãËØï</strong><br> Áî® 1‚Äì2 ‰∏™Ê†∑Êú¨È™åËØÅË∑ØÂæÑ‰∏éÁªìÊûúÔºõ</li>
<li><strong>ÁõëÊéßËµÑÊ∫ê</strong><br> ‰ΩøÁî® <code>htop</code> Êàñ <code>nmon</code> Êü•ÁúãÁ≥ªÁªüË¥üËΩΩÔºõ</li>
<li><strong>ÂÆöÊúüÊ∏ÖÁêÜ‰∏≠Èó¥Êñá‰ª∂</strong><br> Âà†Èô§ <code>.bam</code>„ÄÅ<code>.bai</code> ÂèØËäÇÁúÅÂ§ßÈáèÁ©∫Èó¥Ôºõ</li>
<li><strong>‰øùÊåÅÊó•Âøó</strong><br> Êó•ÂøóÊòØÊéíÊü•ÈîôËØØÁöÑÂÖ≥ÈîÆÔºå‰∏çË¶ÅÂà†Èô§„ÄÇ</li>
</ol>
<hr>
<h2 id="üìé-ÂêéÁª≠ÊñπÂêë"><a href="#üìé-ÂêéÁª≠ÊñπÂêë" class="headerlink" title="üìé ÂêéÁª≠ÊñπÂêë"></a>üìé ÂêéÁª≠ÊñπÂêë</h2><p>ÂêéÁª≠ÂèØÁªßÁª≠ËøõË°åÔºö</p>
<ul>
<li>Â§öÊ†∑Êú¨ËÅîÂêàÂèòÂºÇÊ£ÄÊµãÔºà<code>GenotypeGVCFs</code>ÔºâÔºõ</li>
<li>SNP / INDEL Ê≥®ÈáäÔºõ</li>
<li>Áæ§‰ΩìÁªìÊûÑÂàÜÊûêÔºàPCA„ÄÅADMIXTUREÔºâÔºõ</li>
<li>ËøûÈîÅ‰∏çÂπ≥Ë°°‰∏éÈÄâÊã©ÂàÜÊûê„ÄÇ</li>
</ul>
<hr>
<blockquote>
<p> <strong>ËØ¥ÊòéÔºö</strong> Êú¨ÊµÅÁ®ãÂú® Ubuntu 22.04 + GATK 4.4 + BWA MEM ÁéØÂ¢É‰∏ãÊµãËØïÈÄöËøá„ÄÇ<br> Â¶ÇÈúÄÂ§öËäÇÁÇπÊàñË∂ÖÂ§ßÊ†∑Êú¨‰ºòÂåñÔºåËØ∑ËÄÉËôëÂü∫‰∫é SLURM ÁöÑ‰ªªÂä°Ë∞ÉÂ∫¶ÁâàÊú¨„ÄÇ</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://0HHHHHH0.github.io">HHHH</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://0hhhhhh0.github.io/2025/10/31/chong-ce-xu-xia-ji-shu-ju-chu-li/">https://0hhhhhh0.github.io/2025/10/31/chong-ce-xu-xia-ji-shu-ju-chu-li/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/uploads/avatar.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/10/31/wen-jian-chu-li-yu-shu-ju-shai-xuan-liu-cheng/" title="LD-Block ËøûÈîÅ‰∏çÂπ≥Ë°°ÂàÜÊûê"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">LD-Block ËøûÈîÅ‰∏çÂπ≥Ë°°ÂàÜÊûê</div></div><div class="info-2"><div class="info-item-1">Êñá‰ª∂Â§ÑÁêÜ‰∏éÊï∞ÊçÆÁ≠õÈÄâÊµÅÁ®ãÊµÅÁ®ãÊ¶ÇËø∞‰ªé‰∏§‰∏™Âü∫Âõ†ÁªÑÊï∞ÊçÆÊñá‰ª∂‰∏≠Á≠õÈÄâÂÖ±ÊúâÂü∫Âõ†‰ΩçÁÇπÔºåÁîüÊàêTSVÊ†ºÂºèÁªìÊûú„ÄÇ Â§ÑÁêÜÊ≠•È™§1. Êñá‰ª∂Ê†ºÂºèÊ†áÂáÜÂåñdos2unix color_GWAS.anno.xls ‰ΩúÁî®Ôºö WindowsËΩ¨UnixÊç¢Ë°åÁ¨¶ 2. CSVËΩ¨TSVÊ†ºÂºèsed '1s/^\xEF\xBB\xBF//' Á∫¢Ê†á0.7‰∏éÈªÑÊ†á‰∏éGWASÂÖ±Êúâ.csv | tr ',' '\t' &gt; Á∫¢Ê†á0.7‰∏éÈªÑÊ†á‰∏éGWASÂÖ±Êúâ.tsv ‰ΩúÁî®Ôºö ÂéªÈô§BOMÂ§¥ÔºåÈÄóÂè∑ËΩ¨Âà∂Ë°®Á¨¶ 3. Êï∞ÊçÆÁ≠õÈÄâawk 'BEGIN {OFS="\t"}       NR==FNR {if(FNR&gt;1) start_values[$2] = 1; next}       FNR==1 {print; next}       $2 in start_values' color_GWAS.anno.xls Á∫¢Ê†á0.7‰∏éÈªÑÊ†á‰∏éGWASÂÖ±Êúâ.tsv &gt; filtered_three2one.tsv ÈÄªËæëÔºö  ËØªÂèñÁ¨¨‰∏Ä‰∏™Êñá‰ª∂ÁöÑÁ¨¨‰∫åÂàó‰Ωú‰∏∫Á≠õÈÄâ‰æùÊçÆ ‰øùÁïôÁ¨¨‰∫å‰∏™Êñá‰ª∂‰∏≠ÂåπÈÖçÁöÑÊï∞ÊçÆË°å ËæìÂá∫Âà∂Ë°®Á¨¶ÂàÜÈöîÁöÑÁªìÊûú  Êñá‰ª∂ËØ¥Êòé ËæìÂÖ•Ôºö color_GWA...</div></div></div></a><a class="pagination-related" href="/2025/10/31/shi-yong-annovar-jin-xing-chang-mu-li-crassostrea-gigas-snp-zhu-shi-wan-zheng-liu-cheng/" title="‰ΩøÁî®ANNOVARËøõË°åÈïøÁâ°ËõéSNPÊ≥®ÈáäÂÆåÊï¥ÊµÅÁ®ã"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">‰ΩøÁî®ANNOVARËøõË°åÈïøÁâ°ËõéSNPÊ≥®ÈáäÂÆåÊï¥ÊµÅÁ®ã</div></div><div class="info-2"><div class="info-item-1">‰ΩøÁî®ANNOVARËøõË°åÈïøÁâ°Ëõé(Crassostrea gigas)SNPÊ≥®ÈáäÂÆåÊï¥ÊµÅÁ®ãÊ¶ÇËø∞Êú¨Êñá‰ªãÁªçÂ¶Ç‰Ωï‰ΩøÁî®ANNOVARÂØπÈïøÁâ°Ëõé(Crassostrea gigas)ÁöÑSNPÂèòÂºÇÊï∞ÊçÆËøõË°åÂäüËÉΩÊ≥®Èáä„ÄÇÊµÅÁ®ãÂåÖÊã¨ÂèÇËÄÉÂü∫Âõ†ÁªÑÊï∞ÊçÆÂ∫ìÊûÑÂª∫„ÄÅÂèòÂºÇÊï∞ÊçÆÊ†ºÂºèËΩ¨Êç¢„ÄÅÂäüËÉΩÊ≥®ÈáäÂíåÁªìÊûúÊï¥Âêà„ÄÇ ÁéØÂ¢ÉÂáÜÂ§á1. ËΩØ‰ª∂ÂÆâË£Ö# ANNOVAR‰∏ãËΩΩ wget http://www.openbioinformatics.org/annovar/annovar.tar.gz tar -xzvf annovar.tar.gz  # ÂÖ∂‰ªñ‰æùËµñÂ∑•ÂÖ∑ conda install -c bioconda ucsc-gtftogenepred  2. Êï∞ÊçÆÊñá‰ª∂ÂáÜÂ§á ÂèÇËÄÉÂü∫Âõ†ÁªÑGTFÊñá‰ª∂Ôºö/home/wanglab/Ywh/adductor_muscle_scar/Crassostrea_gigas.cgigas_uk_roslin_v1.61.gtf Âü∫Âõ†ÁªÑFASTAÊñá‰ª∂ÔºöGCF_902806645.1_cgigas_uk_roslin_v1_genomic.fna SNPÊï∞ÊçÆÔºöfiltered_variants_thr0p7_2025...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/uploads/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">HHHH</div><div class="author-info-description">ËÆ∞ÂΩï</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/0HHHHHH0"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/0hhhhhh0" target="_blank" title="fab fa-github"><i class="GitHub"></i></a><a class="social-icon" href="mailto:695460776@qq.com" target="_blank" title="fa fa-envelope"><i class="E-Mail"></i></a><a class="social-icon" href="https://x.com/your-user-name" target="_blank" title="fab fa-twitter"><i class="Twitter"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Èöè‰æøÈÄõÈÄõ!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%A7%AC-%E9%87%8D%E6%B5%8B%E5%BA%8F%E6%95%B0%E6%8D%AE%E6%A0%87%E5%87%86%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text">üß¨ ÈáçÊµãÂ∫èÊï∞ÊçÆÊ†áÂáÜÂ§ÑÁêÜÊµÅÁ®ãËØ¶Ëß£</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81Fastp-%E8%B4%A8%E6%8E%A7%E4%B8%8E%E8%BF%87%E6%BB%A4%EF%BC%88run-fastpl-sh%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">‰∏Ä„ÄÅFastp Ë¥®Êéß‰∏éËøáÊª§Ôºàrun_fastpl.shÔºâ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%F0%9F%93%98-%E8%84%9A%E6%9C%AC%E5%8A%9F%E8%83%BD%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.üìò ËÑöÊú¨ÂäüËÉΩÊ¶ÇËø∞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%F0%9F%93%82-%E8%BE%93%E5%85%A5%E4%B8%8E%E8%BE%93%E5%87%BA%E7%9B%AE%E5%BD%95"><span class="toc-number">1.1.2.</span> <span class="toc-text">2.üìÇ ËæìÂÖ•‰∏éËæìÂá∫ÁõÆÂΩï</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E2%9A%99%EF%B8%8F-%E6%A0%B8%E5%BF%83%E6%B5%81%E7%A8%8B%E8%A7%A3%E6%9E%90"><span class="toc-number">1.1.3.</span> <span class="toc-text">3.‚öôÔ∏è Ê†∏ÂøÉÊµÅÁ®ãËß£Êûê</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E2%9C%85-%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">1.1.4.</span> <span class="toc-text">4.‚úÖ ËøêË°åÁªìÊûú</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%AF%94%E5%AF%B9%E4%B8%8E-gVCF-%E7%94%9F%E6%88%90%EF%BC%88run-bwa-vcf-sh%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">‰∫å„ÄÅÊØîÂØπ‰∏é gVCF ÁîüÊàêÔºàrun_bwa_vcf.shÔºâ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%98-%E5%8A%9F%E8%83%BD%E6%A6%82%E8%BF%B0"><span class="toc-number">1.2.1.</span> <span class="toc-text">üìò ÂäüËÉΩÊ¶ÇËø∞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%82-%E8%BE%93%E5%85%A5%E4%B8%8E%E8%BE%93%E5%87%BA%E7%9B%AE%E5%BD%95"><span class="toc-number">1.2.2.</span> <span class="toc-text">üìÇ ËæìÂÖ•‰∏éËæìÂá∫ÁõÆÂΩï</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E6%AD%A5%E9%AA%A4%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.3.</span> <span class="toc-text">‚öôÔ∏è Ê≠•È™§Ëß£Êûê</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%B8%8F%E2%83%A3-%E5%8F%82%E8%80%83%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%87%86%E5%A4%87"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">1Ô∏è‚É£ ÂèÇËÄÉÂü∫Âõ†ÁªÑÂáÜÂ§á</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%B8%8F%E2%83%A3-%E6%A0%B7%E6%9C%AC%E6%AF%94%E5%AF%B9%EF%BC%88BWA-MEM%EF%BC%89"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">2Ô∏è‚É£ Ê†∑Êú¨ÊØîÂØπÔºàBWA MEMÔºâ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%B8%8F%E2%83%A3-%E5%8E%BB%E9%87%8D%E4%B8%8E-gVCF-%E7%94%9F%E6%88%90"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">3Ô∏è‚É£ ÂéªÈáç‰∏é gVCF ÁîüÊàê</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%EF%B8%8F%E2%83%A3-%E5%B9%B6%E8%A1%8C%E6%8E%A7%E5%88%B6%E4%B8%8E%E5%AE%B9%E9%94%99%E6%9C%BA%E5%88%B6"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">4Ô∏è‚É£ Âπ∂Ë°åÊéßÂà∂‰∏éÂÆπÈîôÊú∫Âà∂</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9C%85-%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">1.2.4.</span> <span class="toc-text">‚úÖ ËøêË°åÁªìÊûú</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%88%86%E6%9F%93%E8%89%B2%E4%BD%93%E6%89%B9%E9%87%8F-gVCF-%E7%94%9F%E6%88%90%EF%BC%88batch-gvcf-sh%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">‰∏â„ÄÅÂàÜÊüìËâ≤‰ΩìÊâπÈáè gVCF ÁîüÊàêÔºàbatch_gvcf.shÔºâ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%98-%E5%8A%9F%E8%83%BD%E6%A6%82%E8%BF%B0-1"><span class="toc-number">1.3.1.</span> <span class="toc-text">üìò ÂäüËÉΩÊ¶ÇËø∞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E4%B8%BB%E8%A6%81%E5%8F%82%E6%95%B0"><span class="toc-number">1.3.2.</span> <span class="toc-text">‚öôÔ∏è ‰∏ªË¶ÅÂèÇÊï∞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E6%A0%B8%E5%BF%83%E9%80%BB%E8%BE%91"><span class="toc-number">1.3.3.</span> <span class="toc-text">‚öôÔ∏è Ê†∏ÂøÉÈÄªËæë</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9C%85-%E8%BE%93%E5%87%BA%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.3.4.</span> <span class="toc-text">‚úÖ ËæìÂá∫Á§∫‰æã</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%92%A1-%E6%B5%81%E7%A8%8B%E6%80%BB%E7%BB%93"><span class="toc-number">1.4.</span> <span class="toc-text">üí° ÊµÅÁ®ãÊÄªÁªì</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9A%80-%E6%96%B0%E6%89%8B%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.5.</span> <span class="toc-text">üöÄ Êñ∞ÊâãÂª∫ËÆÆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%8E-%E5%90%8E%E7%BB%AD%E6%96%B9%E5%90%91"><span class="toc-number">1.6.</span> <span class="toc-text">üìé ÂêéÁª≠ÊñπÂêë</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/wen-jian-chu-li-yu-shu-ju-shai-xuan-liu-cheng/" title="LD-Block ËøûÈîÅ‰∏çÂπ≥Ë°°ÂàÜÊûê">LD-Block ËøûÈîÅ‰∏çÂπ≥Ë°°ÂàÜÊûê</a><time datetime="2025-10-31T02:26:00.000Z" title="Created 2025-10-31 10:26:00">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/ld-block-lian-suo-bu-ping-heng-fen-xi/" title="LD-Block ËøûÈîÅ‰∏çÂπ≥Ë°°ÂàÜÊûê">LD-Block ËøûÈîÅ‰∏çÂπ≥Ë°°ÂàÜÊûê</a><time datetime="2025-10-31T02:26:00.000Z" title="Created 2025-10-31 10:26:00">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/chong-ce-xu-xia-ji-shu-ju-chu-li/" title="ÈáçÊµãÂ∫è‰∏ãÊú∫Êï∞ÊçÆÂ§ÑÁêÜ">ÈáçÊµãÂ∫è‰∏ãÊú∫Êï∞ÊçÆÂ§ÑÁêÜ</a><time datetime="2025-10-31T01:26:00.000Z" title="Created 2025-10-31 09:26:00">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/shi-yong-annovar-jin-xing-chang-mu-li-crassostrea-gigas-snp-zhu-shi-wan-zheng-liu-cheng/" title="‰ΩøÁî®ANNOVARËøõË°åÈïøÁâ°ËõéSNPÊ≥®ÈáäÂÆåÊï¥ÊµÅÁ®ã">‰ΩøÁî®ANNOVARËøõË°åÈïøÁâ°ËõéSNPÊ≥®ÈáäÂÆåÊï¥ÊµÅÁ®ã</a><time datetime="2025-10-31T00:26:00.000Z" title="Created 2025-10-31 08:26:00">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/26/planck-pi/" title="Planck-PiÂ≠¶‰π†">Planck-PiÂ≠¶‰π†</a><time datetime="2025-10-26T01:26:00.000Z" title="Created 2025-10-26 09:26:00">2025-10-26</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By HHHH</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.1</a></span></div></div><div class="container" id="jsi-flying-fish-container"><script src="js/fish.js"></script></div><style>   @media only screen and (max-width: 767px){
   #sidebar_search_box input[type=text]{width:calc(100% - 24px)}
}</style></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><div class="js-pjax"></div><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/fish.js" defer data-pjax></script><script type="text/javascript" src="/js/busuanzi.pure.mini.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="local-search-input"><input placeholder="Search for Posts" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.1"></script></div></div></body></html>