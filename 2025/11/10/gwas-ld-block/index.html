<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>GWAS + çƒ­ç‚¹åŒºåŸŸè¯†åˆ« + LD Block åˆ†ææµç¨‹è¯¦è§£ | HHHH</title><meta name="author" content="HHHH"><meta name="copyright" content="HHHH"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="ğŸ§¬ ä¸€ã€é¡¹ç›®æ¦‚è¿°åœ¨è¿›è¡Œ GWASï¼ˆå…¨åŸºå› ç»„å…³è”åˆ†æï¼‰ åï¼Œæˆ‘ä»¬é€šå¸¸å¾—åˆ°ä¸€ä¸ªåŒ…å«æ•°åä¸‡åˆ°æ•°ç™¾ä¸‡ä¸ª SNP çš„ç»“æœæ–‡ä»¶ã€‚ç„¶è€Œï¼Œä»…å‡­æ›¼å“ˆé¡¿å›¾è§‚å¯Ÿæ˜¾è‘—ä½ç‚¹å¾€å¾€æ— æ³•ç›´è§‚åˆ¤æ–­â€œæ˜¾è‘— SNP æ˜¯å¦å­˜åœ¨èšé›†ï¼ˆhotspotï¼‰â€ï¼Œæ›´éš¾ç›´æ¥é€‰å®š LD åˆ†æåŒºåŸŸã€‚ æœ¬ç¯‡æ–‡ç« ä»‹ç»ä¸€å¥—è‡ªåŠ¨åŒ–åˆ†ææµç¨‹ï¼Œç”¨äºï¼š  ä» GWAS æ³¨é‡Šæ–‡ä»¶ä¸­æå–ç‰¹å®šæŸ“è‰²ä½“ï¼› å¯¹ SNP åˆ†å¸ƒè¿›è¡Œå¯è§†åŒ–ä¸ç»Ÿè®¡ï¼› åŸºäºå¯†åº¦ä¸æ˜¾è‘—æ€§ç­›é€‰â€œçƒ­ç‚¹åŒºåŸŸâ€ï¼›">
<meta property="og:type" content="article">
<meta property="og:title" content="GWAS + çƒ­ç‚¹åŒºåŸŸè¯†åˆ« + LD Block åˆ†ææµç¨‹è¯¦è§£">
<meta property="og:url" content="https://0hhhhhh0.github.io/2025/11/10/gwas-ld-block/index.html">
<meta property="og:site_name" content="HHHH">
<meta property="og:description" content="ğŸ§¬ ä¸€ã€é¡¹ç›®æ¦‚è¿°åœ¨è¿›è¡Œ GWASï¼ˆå…¨åŸºå› ç»„å…³è”åˆ†æï¼‰ åï¼Œæˆ‘ä»¬é€šå¸¸å¾—åˆ°ä¸€ä¸ªåŒ…å«æ•°åä¸‡åˆ°æ•°ç™¾ä¸‡ä¸ª SNP çš„ç»“æœæ–‡ä»¶ã€‚ç„¶è€Œï¼Œä»…å‡­æ›¼å“ˆé¡¿å›¾è§‚å¯Ÿæ˜¾è‘—ä½ç‚¹å¾€å¾€æ— æ³•ç›´è§‚åˆ¤æ–­â€œæ˜¾è‘— SNP æ˜¯å¦å­˜åœ¨èšé›†ï¼ˆhotspotï¼‰â€ï¼Œæ›´éš¾ç›´æ¥é€‰å®š LD åˆ†æåŒºåŸŸã€‚ æœ¬ç¯‡æ–‡ç« ä»‹ç»ä¸€å¥—è‡ªåŠ¨åŒ–åˆ†ææµç¨‹ï¼Œç”¨äºï¼š  ä» GWAS æ³¨é‡Šæ–‡ä»¶ä¸­æå–ç‰¹å®šæŸ“è‰²ä½“ï¼› å¯¹ SNP åˆ†å¸ƒè¿›è¡Œå¯è§†åŒ–ä¸ç»Ÿè®¡ï¼› åŸºäºå¯†åº¦ä¸æ˜¾è‘—æ€§ç­›é€‰â€œçƒ­ç‚¹åŒºåŸŸâ€ï¼›">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/0HHHHHH0/Image@master/blog/v2-ecafe797ee44a3cafe3e129237072370_1440w.jpg">
<meta property="article:published_time" content="2025-11-10T14:26:00.000Z">
<meta property="article:modified_time" content="2025-11-16T14:32:15.000Z">
<meta property="article:author" content="HHHH">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="GWAS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/0HHHHHH0/Image@master/blog/v2-ecafe797ee44a3cafe3e129237072370_1440w.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "GWAS + çƒ­ç‚¹åŒºåŸŸè¯†åˆ« + LD Block åˆ†ææµç¨‹è¯¦è§£",
  "url": "https://0hhhhhh0.github.io/2025/11/10/gwas-ld-block/",
  "image": "https://cdn.jsdelivr.net/gh/0HHHHHH0/Image@master/blog/v2-ecafe797ee44a3cafe3e129237072370_1440w.jpg",
  "datePublished": "2025-11-10T14:26:00.000Z",
  "dateModified": "2025-11-16T14:32:15.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "HHHH",
      "url": "https://0HHHHHH0.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/uploads/avatar.png"><link rel="canonical" href="https://0hhhhhh0.github.io/2025/11/10/gwas-ld-block/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":-1,"unescape":true,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":true,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'GWAS + çƒ­ç‚¹åŒºåŸŸè¯†åˆ« + LD Block åˆ†ææµç¨‹è¯¦è§£',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.7.0/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/jetbrains-mono@4.5.12/index.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/styles/css/font.css"><link rel="stylesheet" href="/css/mermaid.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="HHHH" type="application/atom+xml">
</head><body><div id="loading-box"><div class="scarecrow"><div class="scarecrow__hat"><div class="scarecrow__ribbon"></div></div><div class="scarecrow__head"><div class="scarecrow__eye"></div><div class="scarecrow__eye"></div><div class="scarecrow__mouth"></div><div class="scarecrow__pipe"></div></div><div class="scarecrow__body"><div class="scarecrow__glove scarecrow__glove--l"></div><div class="scarecrow__sleeve scarecrow__sleeve--l"></div><div class="scarecrow__bow"></div><div class="scarecrow__shirt"></div><div class="scarecrow__coat"></div><div class="scarecrow__waistcoat"></div><div class="scarecrow__sleeve scarecrow__sleeve--r"></div><div class="scarecrow__glove scarecrow__glove--r"></div><div class="scarecrow__coattails"></div><div class="scarecrow__pants"></div></div><div class="scarecrow__arms"></div><div class="scarecrow__leg">  </div></div></div><script async="async">(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-color: #fbfdff;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/uploads/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">52</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">29</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/0HHHHHH0/Image@master/blog/v2-ecafe797ee44a3cafe3e129237072370_1440w.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/uploads/avatar.png" alt="Logo"><span class="site-name">HHHH</span></a><a class="nav-page-title" href="/"><span class="site-name">GWAS + çƒ­ç‚¹åŒºåŸŸè¯†åˆ« + LD Block åˆ†ææµç¨‹è¯¦è§£</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">GWAS + çƒ­ç‚¹åŒºåŸŸè¯†åˆ« + LD Block åˆ†ææµç¨‹è¯¦è§£</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-11-10T14:26:00.000Z" title="Created 2025-11-10 22:26:00">2025-11-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-11-16T14:32:15.000Z" title="Updated 2025-11-16 22:32:15">2025-11-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/">ç”Ÿç‰©ä¿¡æ¯</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div class="ai-summary"><div class="ai-explanation" style="display: block;" data-summary="è¿™ç¯‡æ–‡ç« ä»‹ç»äº†ä¸€ä¸ªé’ˆå¯¹GWASï¼ˆå…¨åŸºå› ç»„å…³è”åˆ†æï¼‰ç»“æœçš„åå¤„ç†æµç¨‹ï¼Œé‡ç‚¹èšç„¦äºçƒ­ç‚¹åŒºåŸŸè¯†åˆ«å’ŒLD Blockåˆ†æã€‚æµç¨‹ä¸»è¦åŒ…æ‹¬äº”ä¸ªæ­¥éª¤ï¼šä»GWASç»“æœæ–‡ä»¶ä¸­æå–ç‰¹å®šæŸ“è‰²ä½“æ•°æ®ã€SNPåˆ†å¸ƒå¯è§†åŒ–ä¸ç»Ÿè®¡ã€åŸºäºå¯†åº¦å’Œæ˜¾è‘—æ€§ç­›é€‰çƒ­ç‚¹åŒºåŸŸã€è¾“å‡ºLD blockåˆ†æå»ºè®®åŒºåŸŸä»¥åŠç”Ÿæˆç»¼åˆå›¾å½¢æŠ¥å‘Šã€‚æ–‡ç« è¯¦ç»†å±•ç¤ºäº†ç¯å¢ƒé…ç½®æ–¹æ³•ï¼ˆä½¿ç”¨condaå®‰è£…RåŠç›¸å…³åŒ…ï¼‰ï¼Œå¹¶é€šè¿‡å…·ä½“è„šæœ¬ç¤ºä¾‹ï¼ˆå¦‚show_all_chromosomes.shã€extract_NC_047567.1.shå’Œ3.0.complete_analysis.Rï¼‰æ¼”ç¤ºäº†æ•°æ®æå–ã€é¢„å¤„ç†å’Œåˆ†æçš„å…·ä½“æ“ä½œã€‚è¯¥æµç¨‹å¯å¤„ç†ä»»ä½•GWASç»“æœæ–‡ä»¶æ ¼å¼ï¼ˆå¦‚.assocæˆ–.anno.xlsï¼‰ï¼Œå¹¶ä»¥æŸ“è‰²ä½“NC_047567.1ä¸ºä¾‹ï¼Œå±•ç¤ºäº†ä»åŸºç¡€ç»Ÿè®¡åˆ†æåˆ°é«˜çº§å¯è§†åŒ–ï¼ˆåŒ…æ‹¬å¯†åº¦å›¾å’Œæ›¼å“ˆé¡¿å›¾ï¼‰çš„å…¨å¥—åˆ†ææ–¹æ³•ï¼Œå¸®åŠ©ç ”ç©¶è€…é«˜æ•ˆè¯†åˆ«é‡è¦é—ä¼ ä½ç‚¹å’Œè¿é”ä¸å¹³è¡¡åŒºåŸŸã€‚">AIæ­£åœ¨ç»å°½è„‘æ±æƒ³æ€è·¯INGÂ·Â·Â·</div><div class="ai-title"> <div class="ai-title-left"> <i class="fa-brands fa-slack"></i><div class="ai-title-text">AIæ‘˜è¦</div></div><div class="ai-tag" id="ai-tag">deepseek-ai/DeepSeek-V3</div></div></div><h2 id="ğŸ§¬-ä¸€ã€é¡¹ç›®æ¦‚è¿°"><a href="#ğŸ§¬-ä¸€ã€é¡¹ç›®æ¦‚è¿°" class="headerlink" title="ğŸ§¬ ä¸€ã€é¡¹ç›®æ¦‚è¿°"></a>ğŸ§¬ ä¸€ã€é¡¹ç›®æ¦‚è¿°</h2><p>åœ¨è¿›è¡Œ <strong>GWASï¼ˆå…¨åŸºå› ç»„å…³è”åˆ†æï¼‰</strong> åï¼Œæˆ‘ä»¬é€šå¸¸å¾—åˆ°ä¸€ä¸ªåŒ…å«æ•°åä¸‡åˆ°æ•°ç™¾ä¸‡ä¸ª SNP çš„ç»“æœæ–‡ä»¶ã€‚ç„¶è€Œï¼Œä»…å‡­æ›¼å“ˆé¡¿å›¾è§‚å¯Ÿæ˜¾è‘—ä½ç‚¹å¾€å¾€æ— æ³•ç›´è§‚åˆ¤æ–­â€œæ˜¾è‘— SNP æ˜¯å¦å­˜åœ¨èšé›†ï¼ˆhotspotï¼‰â€ï¼Œæ›´éš¾ç›´æ¥é€‰å®š LD åˆ†æåŒºåŸŸã€‚</p>
<p>æœ¬ç¯‡æ–‡ç« ä»‹ç»ä¸€å¥—è‡ªåŠ¨åŒ–åˆ†ææµç¨‹ï¼Œç”¨äºï¼š</p>
<ol>
<li>ä» GWAS æ³¨é‡Šæ–‡ä»¶ä¸­æå–ç‰¹å®šæŸ“è‰²ä½“ï¼›</li>
<li>å¯¹ SNP åˆ†å¸ƒè¿›è¡Œå¯è§†åŒ–ä¸ç»Ÿè®¡ï¼›</li>
<li>åŸºäºå¯†åº¦ä¸æ˜¾è‘—æ€§ç­›é€‰â€œçƒ­ç‚¹åŒºåŸŸâ€ï¼›</li>
<li>è¾“å‡ºæ¨èçš„ <strong>LD block åˆ†æåŒºåŸŸ</strong>ï¼›</li>
<li>ç”Ÿæˆä¸€æ•´å¥—å›¾å½¢æŠ¥å‘Šï¼ˆå«åŸºç¡€å¯è§†åŒ–ã€çƒ­ç‚¹åˆ†å¸ƒã€æ˜¾è‘—SNPåˆ†å¸ƒã€ç»¼åˆåˆ†æå›¾ï¼‰ã€‚</li>
</ol>
<p>è¯¥æµç¨‹é€‚ç”¨äºä»»ä½• GWAS ç»“æœï¼ˆå¦‚ <code>.assoc</code> æˆ– <code>.anno.xls</code> æ–‡ä»¶ï¼‰ï¼Œå¹¶ä»¥æŸ“è‰²ä½“ <strong>NC_047567.1</strong> ä¸ºç¤ºä¾‹å±•ç¤ºã€‚</p>
<hr>
<h2 id="âš™ï¸-äºŒã€ç¯å¢ƒé…ç½®"><a href="#âš™ï¸-äºŒã€ç¯å¢ƒé…ç½®" class="headerlink" title="âš™ï¸ äºŒã€ç¯å¢ƒé…ç½®"></a>âš™ï¸ äºŒã€ç¯å¢ƒé…ç½®</h2><p>åˆ†æä¾èµ– R åŠå¤šä¸ªå¯è§†åŒ–ä¸åŸºå› ç»„å¤„ç†åŒ…ï¼Œå¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤ä¸€æ¬¡æ€§å®‰è£…ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ä¸€é”®å®‰è£…æ‰€æœ‰ä¾èµ–</span>
conda activate vcftools_env

conda <span class="token function">install</span> <span class="token parameter variable">-c</span> conda-forge r-base<span class="token operator">=</span><span class="token number">4.3</span>.3 <span class="token parameter variable">-y</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
conda <span class="token function">install</span> <span class="token parameter variable">-c</span> conda-forge r-tidyverse r-ggplot2 r-viridis r-scales r-circlize <span class="token parameter variable">-y</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
conda <span class="token function">install</span> <span class="token parameter variable">-c</span> bioconda r-biocmanager bioconductor-rtracklayer <span class="token parameter variable">-y</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token builtin class-name">echo</span> <span class="token string">"âœ… æ‰€æœ‰RåŒ…å®‰è£…å®Œæˆï¼"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>âœ… å®‰è£…å®Œæˆåå³å¯è¿è¡Œæ‰€æœ‰ R è„šæœ¬ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚</p>
<hr>
<h2 id="ğŸ”-ä¸‰ã€æ•°æ®å‡†å¤‡ä¸é¢„å¤„ç†"><a href="#ğŸ”-ä¸‰ã€æ•°æ®å‡†å¤‡ä¸é¢„å¤„ç†" class="headerlink" title="ğŸ” ä¸‰ã€æ•°æ®å‡†å¤‡ä¸é¢„å¤„ç†"></a>ğŸ” ä¸‰ã€æ•°æ®å‡†å¤‡ä¸é¢„å¤„ç†</h2><h3 id="1ï¸âƒ£-æŸ¥çœ‹æ‰€æœ‰æŸ“è‰²ä½“ä¿¡æ¯"><a href="#1ï¸âƒ£-æŸ¥çœ‹æ‰€æœ‰æŸ“è‰²ä½“ä¿¡æ¯" class="headerlink" title="1ï¸âƒ£ æŸ¥çœ‹æ‰€æœ‰æŸ“è‰²ä½“ä¿¡æ¯"></a>1ï¸âƒ£ æŸ¥çœ‹æ‰€æœ‰æŸ“è‰²ä½“ä¿¡æ¯</h3><p>1.show_all_chromosomes.sh</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">echo</span> <span class="token string">"=== æŸ¥çœ‹æ‰€æœ‰æŸ“è‰²ä½“åç§° ==="</span>
<span class="token builtin class-name">echo</span> <span class="token string">"æ–‡ä»¶: color_GWAS.anno.xls"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"æ€»è¡Œæ•°: <span class="token variable"><span class="token variable">$(</span><span class="token function">wc</span> <span class="token parameter variable">-l</span> <span class="token operator">&lt;</span> color_GWAS.anno.xls<span class="token variable">)</span></span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">""</span>
<span class="token builtin class-name">echo</span> <span class="token string">"æ‰€æœ‰å”¯ä¸€çš„æŸ“è‰²ä½“åç§°:"</span>
<span class="token function">awk</span> <span class="token string">'NR&gt;1 {print $1}'</span> color_GWAS.anno.xls <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span> <span class="token parameter variable">-c</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token parameter variable">-nr</span>
<span class="token builtin class-name">echo</span> <span class="token string">""</span>
<span class="token builtin class-name">echo</span> <span class="token string">"å‰10ä¸ªSNPçš„è¯¦ç»†ä¿¡æ¯:"</span>
<span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">11</span> color_GWAS.anno.xls
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>è„šæœ¬ <code>show_all_chromosomes.sh</code> ç”¨äºå¿«é€Ÿæ£€æŸ¥ GWAS æ³¨é‡Šæ–‡ä»¶ä¸­çš„æŸ“è‰²ä½“åˆ†å¸ƒä¸ SNP æ•°é‡ã€‚</p>
<p>ç›®çš„ï¼š</p>
<ul>
<li>ç¡®å®šåˆ†æç›®æ ‡æŸ“è‰²ä½“ï¼›</li>
<li>ç»Ÿè®¡ SNP æ•°é‡ä¸åŸºæœ¬ä¿¡æ¯ï¼›</li>
<li>é¿å…æ–‡ä»¶æ ¼å¼é”™è¯¯ã€‚</li>
</ul>
<p>è¾“å‡ºç»“æœç¤ºä¾‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">=== æŸ¥çœ‹æ‰€æœ‰æŸ“è‰²ä½“åç§° ===
æ‰€æœ‰å”¯ä¸€çš„æŸ“è‰²ä½“åç§°:
  2345  NC_047567.1
  1987  NC_047568.1
å‰10ä¸ªSNPçš„è¯¦ç»†ä¿¡æ¯:
Chr     POS     P.value     ...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="2ï¸âƒ£-æå–å•æ¡æŸ“è‰²ä½“æ•°æ®"><a href="#2ï¸âƒ£-æå–å•æ¡æŸ“è‰²ä½“æ•°æ®" class="headerlink" title="2ï¸âƒ£ æå–å•æ¡æŸ“è‰²ä½“æ•°æ®"></a>2ï¸âƒ£ æå–å•æ¡æŸ“è‰²ä½“æ•°æ®</h3><p>2.extract_NC_047567.1.sh</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">CHROM</span><span class="token operator">=</span><span class="token string">"NC_047567.1"</span>
<span class="token assign-left variable">ANNO_FILE</span><span class="token operator">=</span><span class="token string">"color_GWAS.anno.xls"</span>

<span class="token builtin class-name">echo</span> <span class="token string">"=== æå–æŸ“è‰²ä½“ <span class="token variable">$CHROM</span> æ•°æ® ==="</span>

<span class="token comment"># æå–è¡¨å¤´</span>
<span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">1</span> <span class="token string">"<span class="token variable">$ANNO_FILE</span>"</span> <span class="token operator">&gt;</span> <span class="token string">"<span class="token variable">${CHROM}</span>_data.txt"</span>

<span class="token comment"># æå–è¯¥æŸ“è‰²ä½“çš„æ•°æ®</span>
<span class="token function">awk</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">chrom</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$CHROM</span>"</span> <span class="token string">'$1 == chrom'</span> <span class="token string">"<span class="token variable">$ANNO_FILE</span>"</span> <span class="token operator">&gt;&gt;</span> <span class="token string">"<span class="token variable">${CHROM}</span>_data.txt"</span>

<span class="token comment"># ç»Ÿè®¡</span>
<span class="token assign-left variable">TOTAL_LINES</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">wc</span> <span class="token parameter variable">-l</span> <span class="token operator">&lt;</span> <span class="token string">"<span class="token variable">${CHROM}</span>_data.txt"</span><span class="token variable">)</span></span>
<span class="token assign-left variable">SNP_COUNT</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>TOTAL_LINES <span class="token operator">-</span> <span class="token number">1</span><span class="token variable">))</span></span>

<span class="token builtin class-name">echo</span> <span class="token string">"æå–å®Œæˆ:"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"- è¾“å‡ºæ–‡ä»¶: <span class="token variable">${CHROM}</span>_data.txt"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"- SNPæ•°é‡: <span class="token variable">$SNP_COUNT</span>"</span>

<span class="token comment"># æ£€æŸ¥æ–‡ä»¶å†…å®¹</span>
<span class="token builtin class-name">echo</span> <span class="token string">""</span>
<span class="token builtin class-name">echo</span> <span class="token string">"å‰3è¡Œæ•°æ®:"</span>
<span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">3</span> <span class="token string">"<span class="token variable">${CHROM}</span>_data.txt"</span>

<span class="token comment"># ç”Ÿæˆä½ç½®æ–‡ä»¶</span>
<span class="token function">awk</span> <span class="token string">'NR&gt;1 {print $2}'</span> <span class="token string">"<span class="token variable">${CHROM}</span>_data.txt"</span> <span class="token operator">&gt;</span> <span class="token string">"<span class="token variable">${CHROM}</span>_positions.txt"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"ä½ç½®æ–‡ä»¶: <span class="token variable">${CHROM}</span>_positions.txt"</span>

<span class="token comment"># ä½ç½®èŒƒå›´ç»Ÿè®¡</span>
<span class="token builtin class-name">echo</span> <span class="token string">""</span>
<span class="token builtin class-name">echo</span> <span class="token string">"ä½ç½®èŒƒå›´ç»Ÿè®¡:"</span>
<span class="token function">awk</span> <span class="token string">'NR&gt;1 {print $2}'</span> <span class="token string">"<span class="token variable">${CHROM}</span>_data.txt"</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token parameter variable">-n</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'
BEGIN {min=999999999; max=0} 
{count++; sum+=$1; if($1&lt;min)min=$1; if($1&gt;max)max=$1} 
END {
    print "æœ€å°ä½ç½®: " min
    print "æœ€å¤§ä½ç½®: " max  
    print "ä½ç½®èŒƒå›´: " min " - " max
    print "æ€»è·¨åº¦: " (max-min)/1000000 " Mb"
    print "SNPæ•°é‡: " count
}'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>extract_NC_047567.1.sh</code> ç”¨äºä»æ³¨é‡Šè¡¨ä¸­æå–æŒ‡å®šæŸ“è‰²ä½“ SNP ä¿¡æ¯ã€‚</p>
<p>æ ¸å¿ƒæ­¥éª¤ï¼š</p>
<ul>
<li>ä»åŸå§‹ GWAS æ³¨é‡Šæ–‡ä»¶ä¸­ç­›é€‰å‡ºå¯¹åº”æŸ“è‰²ä½“ï¼›</li>
<li>è¾“å‡ºè¯¥æŸ“è‰²ä½“çš„ SNP è¡¨ï¼›</li>
<li>è‡ªåŠ¨ç”Ÿæˆä½ç½®æ–‡ä»¶ä¸åŒºé—´ç»Ÿè®¡ã€‚</li>
</ul>
<p>è¾“å‡ºï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">- è¾“å‡ºæ–‡ä»¶: NC_047567.1_data.txt
- SNPæ•°é‡: 2345
- ä½ç½®èŒƒå›´: 1.2 Mb - 39.7 Mb
- æ€»è·¨åº¦: 38.5 Mb<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="ğŸ“ˆ-å››ã€R-è„šæœ¬åˆ†ææ¨¡å—"><a href="#ğŸ“ˆ-å››ã€R-è„šæœ¬åˆ†ææ¨¡å—" class="headerlink" title="ğŸ“ˆ å››ã€R è„šæœ¬åˆ†ææ¨¡å—"></a>ğŸ“ˆ å››ã€R è„šæœ¬åˆ†ææ¨¡å—</h2><h3 id="ğŸ”¹-1-å®Œæ•´åŸºç¡€åˆ†æï¼ˆ3-0-complete-analysis-Rï¼‰"><a href="#ğŸ”¹-1-å®Œæ•´åŸºç¡€åˆ†æï¼ˆ3-0-complete-analysis-Rï¼‰" class="headerlink" title="ğŸ”¹ 1. å®Œæ•´åŸºç¡€åˆ†æï¼ˆ3.0.complete_analysis.Rï¼‰"></a>ğŸ”¹ 1. å®Œæ•´åŸºç¡€åˆ†æï¼ˆ<code>3.0.complete_analysis.R</code>ï¼‰</h3><p>3.0.complete_analysis.R</p>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">#!/usr/bin/env Rscript
cat("=== å®Œæ•´çš„æŸ“è‰²ä½“SNPåˆ†æ ===\n")

library(ggplot2)
library(dplyr)
library(viridis)
library(patchwork)

# è¯»å–æ•°æ®
chrom &lt;- "NC_047567.1"
snp_data &lt;- read.table(paste0(chrom, "_data.txt"), header = TRUE, sep = "\t", stringsAsFactors = FALSE)
snp_data$logP &lt;- -log10(snp_data$P.value)

cat("æ•°æ®æ¦‚å†µ:\n")
cat("- SNPæ€»æ•°:", format(nrow(snp_data), big.mark = ","), "\n")
cat("- ä½ç½®èŒƒå›´:", format(min(snp_data$POS), big.mark = ","), "-", format(max(snp_data$POS), big.mark = ","), "\n")
cat("- æŸ“è‰²ä½“é•¿åº¦:", format((max(snp_data$POS) - min(snp_data$POS))/1000000, digits=2), "Mb\n")
cat("- På€¼èŒƒå›´:", min(snp_data$P.value), "-", max(snp_data$P.value), "\n")

# 1. åŸºç¡€å¯è§†åŒ–
cat("ç”ŸæˆåŸºç¡€å¯è§†åŒ–...\n")

# å¯†åº¦å›¾
p_density &lt;- ggplot(snp_data, aes(x = POS/1000000)) +
    geom_density(fill = "steelblue", alpha = 0.7) +
    labs(title = "SNPå¯†åº¦åˆ†å¸ƒ", x = "åŸºå› ç»„ä½ç½® (Mb)", y = "å¯†åº¦") +
    theme_minimal()

# æ›¼å“ˆé¡¿å›¾
p_manhattan &lt;- ggplot(snp_data, aes(x = POS/1000000, y = logP)) +
    geom_point(aes(color = logP), alpha = 0.3, size = 0.5) +
    scale_color_viridis_c(name = "-log10(P)") +
    geom_hline(yintercept = -log10(0.05/nrow(snp_data)), linetype = "dashed", color = "red") +
    labs(title = "æ›¼å“ˆé¡¿å›¾", x = "åŸºå› ç»„ä½ç½® (Mb)", y = "-log10(På€¼)") +
    theme_minimal()

# ç»„åˆå›¾
png(paste0(chrom, "_basic_analysis.png"), width=16, height=10, units="in", res=300)
basic_plot &lt;- p_density / p_manhattan +
    plot_annotation(
        title = paste("æŸ“è‰²ä½“", chrom, "SNPåˆ†æ"),
        subtitle = paste("æ€»è®¡", format(nrow(snp_data), big.mark = ","), "ä¸ªSNP"),
        theme = theme(plot.title = element_text(hjust = 0.5, size=16, face="bold"))
    )
print(basic_plot)
dev.off()

# 2. æ­£ç¡®çš„çƒ­ç‚¹åŒºåŸŸåˆ†æ
cat("è¿›è¡Œçƒ­ç‚¹åŒºåŸŸåˆ†æ...\n")

# ä½¿ç”¨å›ºå®šå¤§å°çš„çª—å£ï¼ˆ1Mbçª—å£ï¼‰
window_size &lt;- 1000000  # 1Mbçª—å£
starts &lt;- seq(min(snp_data$POS), max(snp_data$POS), by = window_size)

hotspot_analysis &lt;- data.frame()
for(i in 1:(length(starts)-1)) {
    start &lt;- starts[i]
    end &lt;- starts[i+1]
    window_data &lt;- snp_data[snp_data$POS &gt;= start &amp; snp_data$POS &lt; end, ]
    
    if(nrow(window_data) &gt; 0) {
        hotspot_analysis &lt;- rbind(hotspot_analysis, data.frame(
            Window = i,
            Start = start,
            End = end,
            SNP_Count = nrow(window_data),
            SNP_Density = nrow(window_data) / ((end - start)/1000000),  # æ¯Mbçš„SNPæ•°
            Mean_logP = mean(window_data$logP, na.rm = TRUE),
            Max_logP = max(window_data$logP, na.rm = TRUE)
        ))
    }
}

cat("çª—å£åˆ†æå®Œæˆï¼Œçª—å£æ•°é‡:", nrow(hotspot_analysis), "\n")
cat("å¹³å‡æ¯çª—å£SNPæ•°é‡:", round(mean(hotspot_analysis$SNP_Count)), "\n")
cat("å¹³å‡SNPå¯†åº¦:", round(mean(hotspot_analysis$SNP_Density)), "SNPs/Mb\n")

# è¯†åˆ«çƒ­ç‚¹åŒºåŸŸï¼ˆSNPå¯†åº¦å‰20%ï¼‰
density_threshold &lt;- quantile(hotspot_analysis$SNP_Density, 0.80)
hot_regions &lt;- hotspot_analysis %&gt;%
    filter(SNP_Density &gt;= density_threshold) %&gt;%
    arrange(desc(SNP_Density))

cat("çƒ­ç‚¹åŒºåŸŸé˜ˆå€¼:", round(density_threshold), "SNPs/Mb\n")
cat("å‘ç°çƒ­ç‚¹åŒºåŸŸ:", nrow(hot_regions), "ä¸ª\n")

# çƒ­ç‚¹åŒºåŸŸå¯è§†åŒ–
png(paste0(chrom, "_hotspot_corrected.png"), width=14, height=6, units="in", res=300)
ggplot(hotspot_analysis, aes(x = Start/1000000, y = SNP_Density)) +
    geom_col(aes(fill = SNP_Density), alpha = 0.8, width = 0.8) +
    geom_hline(yintercept = density_threshold, linetype = "dashed", color = "red", size = 1) +
    geom_text(data = hot_regions, aes(label = round(SNP_Density)), vjust = -0.5, size = 3) +
    scale_fill_viridis_c(name = "SNPå¯†åº¦\n(SNPs/Mb)") +
    labs(title = paste("SNPçƒ­ç‚¹åŒºåŸŸåˆ†æ -", chrom),
         subtitle = paste("çº¢è‰²è™šçº¿: çƒ­ç‚¹é˜ˆå€¼ (", round(density_threshold), "SNPs/Mb)"),
         x = "åŸºå› ç»„ä½ç½® (Mb)", y = "SNPå¯†åº¦ (SNPs/Mb)") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))
dev.off()

# 3. è¾“å‡ºçƒ­ç‚¹åŒºåŸŸå’Œæ¨èåˆ†æåŒºåŸŸ
if(nrow(hot_regions) &gt; 0) {
    hotspot_info &lt;- data.frame(
        Region_ID = paste0("Hotspot_", 1:nrow(hot_regions)),
        Chromosome = chrom,
        Start_Mb = round(hot_regions$Start/1000000, 1),
        End_Mb = round(hot_regions$End/1000000, 1),
        Size_Mb = 1.0,  # å›ºå®š1Mbçª—å£
        SNP_Count = hot_regions$SNP_Count,
        SNP_Density = round(hot_regions$SNP_Density),
        Mean_logP = round(hot_regions$Mean_logP, 2),
        Max_logP = round(hot_regions$Max_logP, 2)
    )
    
    write.csv(hotspot_info, paste0(chrom, "_corrected_hotspots.csv"), row.names = FALSE)
    
    # æ¨èå‰3ä¸ªåŒºåŸŸè¿›è¡ŒLDåˆ†æ
    recommended &lt;- head(hotspot_info, 3)
    write.csv(recommended, paste0(chrom, "_recommended_ld_regions.csv"), row.names = FALSE)
    
    cat("\n=== çƒ­ç‚¹åŒºåŸŸæ€»ç»“ ===\n")
    print(hotspot_info)
    
    cat("\n=== æ¨èLDåˆ†æåŒºåŸŸ ===\n")
    print(recommended)
} else {
    cat("æœªå‘ç°æ˜æ˜¾çƒ­ç‚¹åŒºåŸŸ\n")
}

# 4. ç”Ÿæˆåˆ†ææŠ¥å‘Š
cat("\n=== åˆ†æå®Œæˆ ===\n")
cat("ç”Ÿæˆçš„æ–‡ä»¶:\n")
cat("- ", chrom, "_basic_analysis.png (åŸºç¡€åˆ†æå›¾)\n")
cat("- ", chrom, "_hotspot_corrected.png (çƒ­ç‚¹åŒºåŸŸå›¾)\n")
cat("- ", chrom, "_corrected_hotspots.csv (çƒ­ç‚¹åŒºåŸŸåˆ—è¡¨)\n")
cat("- ", chrom, "_recommended_ld_regions.csv (æ¨èLDåˆ†æåŒºåŸŸ)\n")

cat("\nä¸‹ä¸€æ­¥å»ºè®®:\n")
if(nrow(hot_regions) &gt; 0) {
    cat("1. å¯¹æ¨èåŒºåŸŸè¿›è¡ŒLD blockåˆ†æ\n")
    cat("2. é‡ç‚¹å…³æ³¨é«˜SNPå¯†åº¦ä¸”På€¼æ˜¾è‘—çš„åŒºåŸŸ\n")
    cat("3. ç»“åˆåŸºå› æ³¨é‡Šåˆ†æå€™é€‰åŸºå› \n")
} else {
    cat("1. è€ƒè™‘åˆ†ææ•´ä¸ªæŸ“è‰²ä½“æˆ–é€‰æ‹©SNPå¯†åº¦è¾ƒé«˜çš„åŒºåŸŸ\n")
    cat("2. å¯ä»¥æ‰‹åŠ¨é€‰æ‹©æ„Ÿå…´è¶£çš„åŒºåŸŸè¿›è¡ŒLDåˆ†æ\n")
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¯¥è„šæœ¬æ˜¯æ•´ä¸ªæµç¨‹çš„æ ¸å¿ƒï¼ŒåŒ…å«ä»¥ä¸‹åˆ†ææ­¥éª¤ï¼š</p>
<h4 id="ï¼ˆ1ï¼‰åŸºç¡€å¯è§†åŒ–"><a href="#ï¼ˆ1ï¼‰åŸºç¡€å¯è§†åŒ–" class="headerlink" title="ï¼ˆ1ï¼‰åŸºç¡€å¯è§†åŒ–"></a>ï¼ˆ1ï¼‰åŸºç¡€å¯è§†åŒ–</h4><p>ç”Ÿæˆ <strong>SNPå¯†åº¦å›¾</strong> ä¸ <strong>æ›¼å“ˆé¡¿å›¾</strong>ï¼š</p>
<ul>
<li>æ¨ªè½´ä¸ºåŸºå› ç»„ä½ç½®ï¼ˆMbï¼‰ï¼›</li>
<li>çºµè½´ä¸º -log10(P)ï¼›</li>
<li>è‡ªåŠ¨æ·»åŠ  Bonferroni é˜ˆå€¼çº¿ï¼›</li>
<li>å›¾åƒåˆå¹¶ä¿å­˜ä¸º <code>*_basic_analysis.png</code>ã€‚</li>
</ul>
<h4 id="ï¼ˆ2ï¼‰çª—å£æ‰«æä¸çƒ­ç‚¹æ£€æµ‹"><a href="#ï¼ˆ2ï¼‰çª—å£æ‰«æä¸çƒ­ç‚¹æ£€æµ‹" class="headerlink" title="ï¼ˆ2ï¼‰çª—å£æ‰«æä¸çƒ­ç‚¹æ£€æµ‹"></a>ï¼ˆ2ï¼‰çª—å£æ‰«æä¸çƒ­ç‚¹æ£€æµ‹</h4><p>é€šè¿‡ 1Mb çª—å£æ»‘åŠ¨ç»Ÿè®¡æ¯ Mb çš„ SNP æ•°é‡ä¸å¯†åº¦ï¼Œå¹¶è¯†åˆ«ï¼š</p>
<ul>
<li>SNP å¯†åº¦ä½äºå‰ 20% çš„çª—å£ï¼›</li>
<li>è¾“å‡ºä¸º <code>*_corrected_hotspots.csv</code>ï¼›</li>
<li>å¯è§†åŒ–ç»“æœä¸º <code>*_hotspot_corrected.png</code>ã€‚</li>
</ul>
<h4 id="ï¼ˆ3ï¼‰æ¨è-LD-åˆ†æåŒºåŸŸ"><a href="#ï¼ˆ3ï¼‰æ¨è-LD-åˆ†æåŒºåŸŸ" class="headerlink" title="ï¼ˆ3ï¼‰æ¨è LD åˆ†æåŒºåŸŸ"></a>ï¼ˆ3ï¼‰æ¨è LD åˆ†æåŒºåŸŸ</h4><p>ç¨‹åºè‡ªåŠ¨è¾“å‡ºå¯†åº¦æœ€é«˜çš„å‰ä¸‰ä¸ªçª—å£ï¼Œä¿å­˜ä¸ºï¼š</p>
<ul>
<li><code>*_recommended_ld_regions.csv</code></li>
</ul>
<h4 id="ï¼ˆ4ï¼‰ç»“æœæ€»ç»“ä¸å»ºè®®"><a href="#ï¼ˆ4ï¼‰ç»“æœæ€»ç»“ä¸å»ºè®®" class="headerlink" title="ï¼ˆ4ï¼‰ç»“æœæ€»ç»“ä¸å»ºè®®"></a>ï¼ˆ4ï¼‰ç»“æœæ€»ç»“ä¸å»ºè®®</h4><p>è¾“å‡ºåŒ…æ‹¬ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">=== çƒ­ç‚¹åŒºåŸŸæ€»ç»“ ===
=== æ¨èLDåˆ†æåŒºåŸŸ ===
ä¸‹ä¸€æ­¥å»ºè®®:
1. å¯¹æ¨èåŒºåŸŸè¿›è¡ŒLD blockåˆ†æ
2. ç»“åˆåŸºå› æ³¨é‡Šåˆ†æå€™é€‰åŸºå› <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="ğŸ”¹-2-åŸºäºæ˜¾è‘—SNPçš„çƒ­ç‚¹åˆ†æï¼ˆ3-1-corrected-significant-hotspots-Rï¼‰"><a href="#ğŸ”¹-2-åŸºäºæ˜¾è‘—SNPçš„çƒ­ç‚¹åˆ†æï¼ˆ3-1-corrected-significant-hotspots-Rï¼‰" class="headerlink" title="ğŸ”¹ 2. åŸºäºæ˜¾è‘—SNPçš„çƒ­ç‚¹åˆ†æï¼ˆ3.1.corrected_significant_hotspots.Rï¼‰"></a>ğŸ”¹ 2. åŸºäºæ˜¾è‘—SNPçš„çƒ­ç‚¹åˆ†æï¼ˆ<code>3.1.corrected_significant_hotspots.R</code>ï¼‰</h3><p>3.1.corrected_significant_hotspots.R</p>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">#!/usr/bin/env Rscript
cat("=== åŸºäºæ˜¾è‘—SNPçš„çƒ­ç‚¹åŒºåŸŸåˆ†æ ===\n")

library(ggplot2)
library(dplyr)
library(viridis)
library(patchwork)

# è¯»å–æ•°æ®
chrom &lt;- "NC_047567.1"
snp_data &lt;- read.table(paste0(chrom, "_data.txt"), header = TRUE, sep = "\t", stringsAsFactors = FALSE)
snp_data$logP &lt;- -log10(snp_data$P.value)

cat("åŸå§‹æ•°æ®æ¦‚å†µ:\n")
cat("- æ€»SNPæ•°:", format(nrow(snp_data), big.mark = ","), "\n")

# å®šä¹‰æ˜¾è‘—æ€§é˜ˆå€¼
significance_threshold &lt;- -log10(0.05/nrow(snp_data))  # Bonferroniæ ¡æ­£
cat("Bonferroniæ ¡æ­£çš„æ˜¾è‘—æ€§é˜ˆå€¼: -log10(P) &gt;", round(significance_threshold, 2), "\n")

# è¿‡æ»¤æ˜¾è‘—SNP
significant_snps &lt;- snp_data[snp_data$logP &gt; significance_threshold, ]
cat("æ˜¾è‘—SNPæ•°é‡:", format(nrow(significant_snps), big.mark = ","), "\n")
cat("æ˜¾è‘—SNPæ¯”ä¾‹:", round(nrow(significant_snps)/nrow(snp_data)*100, 2), "%\n")

if(nrow(significant_snps) == 0) {
    cat("è­¦å‘Š: æ²¡æœ‰æ˜¾è‘—SNPï¼Œä½¿ç”¨è¾ƒå®½æ¾çš„é˜ˆå€¼\n")
    significance_threshold &lt;- -log10(1e-5)  # ä½¿ç”¨10^-5ä½œä¸ºé˜ˆå€¼
    significant_snps &lt;- snp_data[snp_data$logP &gt; significance_threshold, ]
    cat("ä½¿ç”¨é˜ˆå€¼ -log10(P) &gt;", significance_threshold, "\n")
    cat("æ˜¾è‘—SNPæ•°é‡:", nrow(significant_snps), "\n")
}

if(nrow(significant_snps) &gt; 0) {
    # 1. æ˜¾è‘—SNPçš„åˆ†å¸ƒå¯è§†åŒ–
    p1 &lt;- ggplot(significant_snps, aes(x = POS/1000000, y = logP)) +
        geom_point(aes(color = logP), alpha = 0.7, size = 1) +
        scale_color_viridis_c(name = "-log10(P)") +
        geom_hline(yintercept = significance_threshold, linetype = "dashed", color = "red") +
        labs(title = "æ˜¾è‘—SNPåˆ†å¸ƒ",
             x = "åŸºå› ç»„ä½ç½® (Mb)", y = "-log10(På€¼)") +
        theme_minimal()
    
    p2 &lt;- ggplot(significant_snps, aes(x = POS/1000000)) +
        geom_density(fill = "red", alpha = 0.7) +
        labs(title = "æ˜¾è‘—SNPå¯†åº¦åˆ†å¸ƒ",
             x = "åŸºå› ç»„ä½ç½® (Mb)", y = "å¯†åº¦") +
        theme_minimal()
    
    png(paste0(chrom, "_significant_snps.png"), width=16, height=8, units="in", res=300)
    combined &lt;- p1 | p2 +
        plot_annotation(
            title = paste("æ˜¾è‘—SNPåˆ†æ -", chrom),
            subtitle = paste("æ˜¾è‘—SNP:", nrow(significant_snps), "/", format(nrow(snp_data), big.mark = ",")),
            theme = theme(plot.title = element_text(hjust = 0.5, face="bold"))
        )
    print(combined)
    dev.off()
    
    # 2. åŸºäºæ˜¾è‘—SNPçš„çƒ­ç‚¹åŒºåŸŸåˆ†æ
    cat("è¿›è¡Œæ˜¾è‘—SNPçƒ­ç‚¹åŒºåŸŸåˆ†æ...\n")
    
    # ä½¿ç”¨500kbçª—å£åˆ†ææ˜¾è‘—SNP
    window_size &lt;- 500000  # 500kbçª—å£
    starts &lt;- seq(min(snp_data$POS), max(snp_data$POS), by = window_size)
    
    hotspot_analysis &lt;- data.frame()
    for(i in 1:(length(starts)-1)) {
        start &lt;- starts[i]
        end &lt;- starts[i+1]
        window_data &lt;- significant_snps[significant_snps$POS &gt;= start &amp; significant_snps$POS &lt; end, ]
        
        if(nrow(window_data) &gt; 0) {
            hotspot_analysis &lt;- rbind(hotspot_analysis, data.frame(
                Window = i,
                Start = start,
                End = end,
                Significant_SNP_Count = nrow(window_data),
                SNP_Density = nrow(window_data) / ((end - start)/1000000),  # æ¯Mbçš„æ˜¾è‘—SNPæ•°
                Mean_logP = mean(window_data$logP, na.rm = TRUE),
                Max_logP = max(window_data$logP, na.rm = TRUE)
            ))
        } else {
            # ä¹Ÿè®°å½•æ²¡æœ‰æ˜¾è‘—SNPçš„çª—å£
            hotspot_analysis &lt;- rbind(hotspot_analysis, data.frame(
                Window = i,
                Start = start,
                End = end,
                Significant_SNP_Count = 0,
                SNP_Density = 0,
                Mean_logP = NA,
                Max_logP = NA
            ))
        }
    }
    
    cat("çª—å£åˆ†æå®Œæˆï¼Œçª—å£æ•°é‡:", nrow(hotspot_analysis), "\n")
    
    # è¯†åˆ«æ˜¾è‘—SNPçƒ­ç‚¹åŒºåŸŸï¼ˆæ˜¾è‘—SNPå¯†åº¦å‰20%ï¼‰
    if(sum(hotspot_analysis$Significant_SNP_Count &gt; 0) &gt; 0) {
        density_threshold &lt;- quantile(hotspot_analysis$SNP_Density[hotspot_analysis$SNP_Density &gt; 0], 0.80, na.rm = TRUE)
        hot_regions &lt;- hotspot_analysis %&gt;%
            filter(SNP_Density &gt;= density_threshold) %&gt;%
            arrange(desc(SNP_Density))
        
        cat("æ˜¾è‘—SNPçƒ­ç‚¹é˜ˆå€¼:", round(density_threshold, 1), "æ˜¾è‘—SNPs/Mb\n")
        cat("å‘ç°æ˜¾è‘—SNPçƒ­ç‚¹åŒºåŸŸ:", nrow(hot_regions), "ä¸ª\n")
        
        # çƒ­ç‚¹åŒºåŸŸå¯è§†åŒ–
        png(paste0(chrom, "_significant_hotspots.png"), width=14, height=6, units="in", res=300)
        ggplot(hotspot_analysis, aes(x = Start/1000000, y = SNP_Density)) +
            geom_col(aes(fill = SNP_Density), alpha = 0.8, width = 0.4) +
            geom_hline(yintercept = density_threshold, linetype = "dashed", color = "red", linewidth = 1) +
            geom_text(data = hot_regions, aes(label = round(SNP_Density, 1)), vjust = -0.5, size = 3) +
            scale_fill_viridis_c(name = "æ˜¾è‘—SNPå¯†åº¦\n(SNPs/Mb)") +
            labs(title = paste("æ˜¾è‘—SNPçƒ­ç‚¹åŒºåŸŸåˆ†æ -", chrom),
                 subtitle = paste("çº¢è‰²è™šçº¿: çƒ­ç‚¹é˜ˆå€¼ (", round(density_threshold, 1), "æ˜¾è‘—SNPs/Mb)"),
                 x = "åŸºå› ç»„ä½ç½® (Mb)", y = "æ˜¾è‘—SNPå¯†åº¦ (SNPs/Mb)") +
            theme_minimal() +
            theme(plot.title = element_text(hjust = 0.5, face = "bold"))
        dev.off()
        
        # è¾“å‡ºçƒ­ç‚¹åŒºåŸŸ
        if(nrow(hot_regions) &gt; 0) {
            hotspot_info &lt;- data.frame(
                Region_ID = paste0("SigHotspot_", 1:nrow(hot_regions)),
                Chromosome = chrom,
                Start_Mb = round(hot_regions$Start/1000000, 1),
                End_Mb = round(hot_regions$End/1000000, 1),
                Size_Mb = 0.5,  # 500kbçª—å£
                Significant_SNP_Count = hot_regions$Significant_SNP_Count,
                SNP_Density = round(hot_regions$SNP_Density, 1),
                Mean_logP = round(hot_regions$Mean_logP, 2),
                Max_logP = round(hot_regions$Max_logP, 2)
            )
            
            write.csv(hotspot_info, paste0(chrom, "_significant_hotspots.csv"), row.names = FALSE)
            
            # æ¨èå‰3ä¸ªåŒºåŸŸè¿›è¡ŒLDåˆ†æ
            recommended &lt;- head(hotspot_info, 3)
            write.csv(recommended, paste0(chrom, "_recommended_significant_regions.csv"), row.names = FALSE)
            
            cat("\n=== æ˜¾è‘—SNPçƒ­ç‚¹åŒºåŸŸ ===\n")
            print(hotspot_info)
            
            cat("\n=== æ¨èLDåˆ†æåŒºåŸŸï¼ˆåŸºäºæ˜¾è‘—SNPï¼‰===\n")
            print(recommended)
        }
    } else {
        cat("è­¦å‘Š: æ²¡æœ‰å‘ç°æ˜¾è‘—SNPèšé›†çš„åŒºåŸŸ\n")
    }
    
} else {
    cat("é”™è¯¯: æ²¡æœ‰æ˜¾è‘—SNPï¼Œæ— æ³•è¿›è¡Œçƒ­ç‚¹åŒºåŸŸåˆ†æ\n")
}

cat("\n=== åˆ†æå®Œæˆ ===\n")
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ­¤è„šæœ¬è¿›ä¸€æ­¥èšç„¦äºæ˜¾è‘— SNPï¼š</p>
<h4 id="ï¼ˆ1ï¼‰æ˜¾è‘—æ€§ç­›é€‰"><a href="#ï¼ˆ1ï¼‰æ˜¾è‘—æ€§ç­›é€‰" class="headerlink" title="ï¼ˆ1ï¼‰æ˜¾è‘—æ€§ç­›é€‰"></a>ï¼ˆ1ï¼‰æ˜¾è‘—æ€§ç­›é€‰</h4><ul>
<li>é»˜è®¤ä½¿ç”¨ Bonferroni é˜ˆå€¼ï¼›</li>
<li>è‹¥æ— æ˜¾è‘— SNPï¼Œè‡ªåŠ¨ä½¿ç”¨æ›´å®½æ¾é˜ˆå€¼ï¼ˆå¦‚ 1e-5ï¼‰ï¼›</li>
<li>è¾“å‡ºæ˜¾è‘— SNP çš„æ•°é‡ã€æ¯”ä¾‹åŠåˆ†å¸ƒã€‚</li>
</ul>
<h4 id="ï¼ˆ2ï¼‰åŸºäºæ˜¾è‘—SNPçš„çª—å£ç»Ÿè®¡"><a href="#ï¼ˆ2ï¼‰åŸºäºæ˜¾è‘—SNPçš„çª—å£ç»Ÿè®¡" class="headerlink" title="ï¼ˆ2ï¼‰åŸºäºæ˜¾è‘—SNPçš„çª—å£ç»Ÿè®¡"></a>ï¼ˆ2ï¼‰åŸºäºæ˜¾è‘—SNPçš„çª—å£ç»Ÿè®¡</h4><p>é‡‡ç”¨æ›´ç²¾ç»†çš„ 500kb çª—å£æ»‘åŠ¨ï¼Œè®¡ç®—ï¼š</p>
<ul>
<li>æ˜¾è‘—SNPæ•°ï¼›</li>
<li>æ˜¾è‘—SNPå¯†åº¦ï¼›</li>
<li>å¹³å‡ä¸æœ€å¤§ -log10(P)ã€‚</li>
</ul>
<p>ç­›é€‰å¯†åº¦å‰ 20% çš„çª—å£ä½œä¸º <strong>æ˜¾è‘—çƒ­ç‚¹åŒºåŸŸ</strong>ï¼Œè¾“å‡ºä¸ºï¼š</p>
<ul>
<li><code>*_significant_hotspots.csv</code></li>
<li>æ¨èåŒºåŸŸï¼š<code>*_recommended_significant_regions.csv</code></li>
</ul>
<h4 id="ï¼ˆ3ï¼‰æ˜¾è‘—SNPçƒ­ç‚¹å¯è§†åŒ–"><a href="#ï¼ˆ3ï¼‰æ˜¾è‘—SNPçƒ­ç‚¹å¯è§†åŒ–" class="headerlink" title="ï¼ˆ3ï¼‰æ˜¾è‘—SNPçƒ­ç‚¹å¯è§†åŒ–"></a>ï¼ˆ3ï¼‰æ˜¾è‘—SNPçƒ­ç‚¹å¯è§†åŒ–</h4><p>ç”Ÿæˆï¼š</p>
<ul>
<li>æ˜¾è‘—SNPåˆ†å¸ƒå›¾ï¼›</li>
<li>æ˜¾è‘—SNPå¯†åº¦å›¾ï¼›</li>
<li>çƒ­ç‚¹åˆ†å¸ƒæŸ±çŠ¶å›¾ï¼›<br> è¾“å‡ºæ–‡ä»¶ï¼š<code>*_significant_hotspots.png</code></li>
</ul>
<hr>
<h3 id="ğŸ”¹-3-æœ€ç»ˆå¯è§†åŒ–ä¸æ€»ç»“ï¼ˆ3-2-fixed-visualization-Rï¼‰"><a href="#ğŸ”¹-3-æœ€ç»ˆå¯è§†åŒ–ä¸æ€»ç»“ï¼ˆ3-2-fixed-visualization-Rï¼‰" class="headerlink" title="ğŸ”¹ 3. æœ€ç»ˆå¯è§†åŒ–ä¸æ€»ç»“ï¼ˆ3.2.fixed_visualization.Rï¼‰"></a>ğŸ”¹ 3. æœ€ç»ˆå¯è§†åŒ–ä¸æ€»ç»“ï¼ˆ<code>3.2.fixed_visualization.R</code>ï¼‰</h3><p>3.2.fixed_visualization.R</p>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">#!/usr/bin/env Rscript
cat("=== ä¿®å¤ç‰ˆå®Œæ•´å¯è§†åŒ– ===\n")

library(ggplot2)
library(dplyr)
library(viridis)
library(patchwork)
library(circlize)
library(scales)  # æ·»åŠ scalesåŒ…ç”¨äºrescaleå‡½æ•°

# è¯»å–æ•°æ®
chrom &lt;- "NC_047567.1"
snp_data &lt;- read.table(paste0(chrom, "_data.txt"), header = TRUE, sep = "\t", stringsAsFactors = FALSE)
snp_data$logP &lt;- -log10(snp_data$P.value)

# è¯»å–æ˜¾è‘—çƒ­ç‚¹åŒºåŸŸ
hotspots &lt;- read.csv(paste0(chrom, "_significant_hotspots.csv"))

cat("ç”Ÿæˆå®Œæ•´å¯è§†åŒ–...\n")

# 1. æ›¼å“ˆé¡¿é£æ ¼ç»„åˆå›¾ï¼ˆæ›´ç¨³å®šçš„æ–¹æ³•ï¼‰
sig_threshold &lt;- -log10(0.05/nrow(snp_data))
significant_snps &lt;- snp_data[snp_data$logP &gt; sig_threshold, ]

cat("æ˜¾è‘—SNPæ•°é‡:", nrow(significant_snps), "\n")
cat("çƒ­ç‚¹åŒºåŸŸ:", nrow(hotspots), "ä¸ª\n")

# ä¸»æ›¼å“ˆé¡¿å›¾
p_manhattan &lt;- ggplot(snp_data, aes(x = POS/1000000, y = logP)) +
    # æ‰€æœ‰SNPèƒŒæ™¯
    geom_point(data = snp_data[snp_data$logP &lt;= sig_threshold, ], 
               color = "grey80", alpha = 0.3, size = 0.3) +
    # æ˜¾è‘—SNP
    geom_point(data = significant_snps, 
               aes(color = logP), alpha = 0.8, size = 1) +
    scale_color_viridis_c(name = "-log10(P)") +
    # æ˜¾è‘—æ€§é˜ˆå€¼çº¿
    geom_hline(yintercept = sig_threshold, 
               linetype = "dashed", color = "red", linewidth = 1) +
    # çƒ­ç‚¹åŒºåŸŸæ ‡è®°
    geom_rect(data = hotspots, 
              aes(xmin = Start_Mb, xmax = End_Mb, ymin = 0, ymax = Inf),
              fill = "red", alpha = 0.1, inherit.aes = FALSE) +
    geom_text(data = hotspots, 
              aes(x = (Start_Mb + End_Mb)/2, y = max(snp_data$logP)*0.95, 
                  label = paste0("Hotspot\n", Significant_SNP_Count, " sig SNPs")),
              size = 2.5, color = "darkred", inherit.aes = FALSE) +
    labs(title = "Manhattan Plot with Significant SNP Hotspots",
         x = "Genomic Position (Mb)", y = "-log10(P-value)") +
    theme_minimal()

# æ˜¾è‘—SNPå¯†åº¦å›¾
p_density &lt;- ggplot(significant_snps, aes(x = POS/1000000)) +
    geom_density(fill = "red", alpha = 0.7, color = "darkred", linewidth = 1) +
    geom_rug(sides = "b", color = "red", alpha = 0.5) +
    # çƒ­ç‚¹åŒºåŸŸæ ‡è®°
    geom_vline(data = hotspots, aes(xintercept = Start_Mb), 
               linetype = "dashed", color = "blue", linewidth = 0.8) +
    geom_vline(data = hotspots, aes(xintercept = End_Mb), 
               linetype = "dashed", color = "blue", linewidth = 0.8) +
    geom_label(data = hotspots, 
               aes(x = (Start_Mb + End_Mb)/2, y = 0, 
                   label = paste0(Start_Mb, "-", End_Mb, " Mb")),
              angle = 90, vjust = 1.2, size = 3, color = "blue", 
              fill = "white", alpha = 0.8, inherit.aes = FALSE) +
    labs(title = "Density of Significant SNPs",
         x = "Genomic Position (Mb)", y = "Density") +
    theme_minimal()

# ç»„åˆå›¾
png(paste0(chrom, "_final_analysis.png"), width=16, height=10, units="in", res=300)
combined_plot &lt;- p_manhattan / p_density +
    plot_annotation(
        title = paste("Significant SNP Analysis:", chrom),
        subtitle = paste("Total:", nrow(significant_snps), "significant SNPs |", 
                        nrow(hotspots), "hotspot regions"),
        theme = theme(
            plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
            plot.subtitle = element_text(hjust = 0.5, size = 12)
        )
    )
print(combined_plot)
dev.off()
cat("ç»„åˆåˆ†æå›¾å·²ç”Ÿæˆ\n")

# 2. çƒ­ç‚¹åŒºåŸŸè¯¦ç»†åˆ†æ
if(nrow(hotspots) &gt; 0) {
    cat("ç”Ÿæˆçƒ­ç‚¹åŒºåŸŸè¯¦ç»†å›¾...\n")
    
    hotspot_plots &lt;- list()
    
    for(i in 1:nrow(hotspots)) {
        hotspot &lt;- hotspots[i, ]
        start_bp &lt;- hotspot$Start_Mb * 1000000
        end_bp &lt;- hotspot$End_Mb * 1000000
        
        # æå–çƒ­ç‚¹åŒºåŸŸå†…çš„SNP
        hotspot_snps &lt;- snp_data[snp_data$POS &gt;= start_bp &amp; snp_data$POS &lt;= end_bp, ]
        hotspot_sig_snps &lt;- hotspot_snps[hotspot_snps$logP &gt; sig_threshold, ]
        
        cat(paste0("çƒ­ç‚¹", i, ": ", nrow(hotspot_snps), "ä¸ªSNP, ", 
                   nrow(hotspot_sig_snps), "ä¸ªæ˜¾è‘—SNP\n"))
        
        # çƒ­ç‚¹åŒºåŸŸè¯¦ç»†å›¾
        p &lt;- ggplot(hotspot_snps, aes(x = POS, y = logP)) +
            # èƒŒæ™¯SNP
            geom_point(data = hotspot_snps[hotspot_snps$logP &lt;= sig_threshold, ], 
                       color = "grey70", alpha = 0.5, size = 1) +
            # æ˜¾è‘—SNP
            geom_point(data = hotspot_sig_snps, 
                       aes(color = logP), size = 2, alpha = 0.8) +
            scale_color_viridis_c(name = "-log10(P)") +
            # æ˜¾è‘—æ€§çº¿
            geom_hline(yintercept = sig_threshold, linetype = "dashed", color = "red") +
            # åŒºåŸŸæ ‡è®°
            annotate("rect", xmin = start_bp, xmax = end_bp, 
                     ymin = 0, ymax = Inf, fill = "red", alpha = 0.1) +
            labs(title = paste("Hotspot", i, ":", hotspot$Start_Mb, "-", hotspot$End_Mb, "Mb"),
                 subtitle = paste("Size:", hotspot$Size_Mb, "Mb |", 
                                 hotspot$Significant_SNP_Count, "significant SNPs |",
                                 "Mean -log10(P):", hotspot$Mean_logP),
                 x = "Position (bp)", y = "-log10(P-value)") +
            theme_minimal() +
            theme(plot.title = element_text(face = "bold", hjust = 0.5),
                  plot.subtitle = element_text(hjust = 0.5))
        
        hotspot_plots[[i]] &lt;- p
        
        # ä¿å­˜å•ä¸ªçƒ­ç‚¹å›¾
        ggsave(paste0(chrom, "_hotspot_", i, "_detail.png"), p, 
               width = 10, height = 6, dpi = 300)
    }
    
    # çƒ­ç‚¹åŒºåŸŸç»„åˆå›¾
    if(length(hotspot_plots) &gt; 1) {
        png(paste0(chrom, "_all_hotspots.png"), width=14, height=8, units="in", res=300)
        if(length(hotspot_plots) == 2) {
            final_plot &lt;- hotspot_plots[[1]] | hotspot_plots[[2]]
        } else {
            final_plot &lt;- wrap_plots(hotspot_plots)
        }
        print(final_plot)
        dev.off()
    }
}

# 3. ç”Ÿæˆæ€»ç»“ç»Ÿè®¡
cat("ç”Ÿæˆåˆ†ææ€»ç»“...\n")

summary_stats &lt;- data.frame(
    Metric = c("Total SNPs", "Significant SNPs", "Significance Threshold", 
               "Hotspot Regions", "Total Significant SNPs in Hotspots",
               "Hotspot 1 (31.5-32.0 Mb)", "Hotspot 2 (32.0-32.5 Mb)"),
    Value = c(
        format(nrow(snp_data), big.mark = ","),
        nrow(significant_snps),
        paste0("-log10(P) &gt; ", round(sig_threshold, 2)),
        nrow(hotspots),
        sum(hotspots$Significant_SNP_Count),
        paste0(hotspots$Significant_SNP_Count[1], " SNPs, mean -log10(P)=", hotspots$Mean_logP[1]),
        paste0(hotspots$Significant_SNP_Count[2], " SNPs, mean -log10(P)=", hotspots$Mean_logP[2])
    )
)

write.csv(summary_stats, paste0(chrom, "_analysis_summary.csv"), row.names = FALSE)

cat("\n=== åˆ†æå®Œæˆ ===\n")
cat("ğŸ“Š ç”Ÿæˆçš„å¯è§†åŒ–æ–‡ä»¶:\n")
cat("   - ", chrom, "_final_analysis.png (ç»„åˆåˆ†æå›¾)\n")
cat("   - ", chrom, "_hotspot_1_detail.png (çƒ­ç‚¹1è¯¦ç»†å›¾)\n")
cat("   - ", chrom, "_hotspot_2_detail.png (çƒ­ç‚¹2è¯¦ç»†å›¾)\n")
cat("   - ", chrom, "_all_hotspots.png (æ‰€æœ‰çƒ­ç‚¹ç»„åˆå›¾)\n")
cat("ğŸ“‹ ç”Ÿæˆçš„æ•°æ®æ–‡ä»¶:\n")
cat("   - ", chrom, "_analysis_summary.csv (åˆ†ææ€»ç»“)\n")

cat("\nğŸ¯ æœ€ç»ˆLDåˆ†ææ¨è:\n")
cat("   ä¼˜å…ˆåˆ†æ: 31.5-32.0 Mb åŒºåŸŸ (70ä¸ªæ˜¾è‘—SNP)\n")
cat("   æ¬¡è¦åˆ†æ: 32.0-32.5 Mb åŒºåŸŸ (25ä¸ªæ˜¾è‘—SNP)\n")
cat("   è¿™äº›åŒºåŸŸåŒ…å«çœŸæ­£çš„åŠŸèƒ½å˜å¼‚ï¼ŒLDåˆ†ææœ€æœ‰ç”Ÿç‰©å­¦æ„ä¹‰ï¼\n")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¯¥è„šæœ¬æ•´åˆæ‰€æœ‰ç»“æœï¼Œç”Ÿæˆæœ€ç»ˆå›¾å½¢æŠ¥å‘Šã€‚</p>
<h4 id="ï¼ˆ1ï¼‰ç»¼åˆæ›¼å“ˆé¡¿-å¯†åº¦åŒå›¾"><a href="#ï¼ˆ1ï¼‰ç»¼åˆæ›¼å“ˆé¡¿-å¯†åº¦åŒå›¾" class="headerlink" title="ï¼ˆ1ï¼‰ç»¼åˆæ›¼å“ˆé¡¿ + å¯†åº¦åŒå›¾"></a>ï¼ˆ1ï¼‰ç»¼åˆæ›¼å“ˆé¡¿ + å¯†åº¦åŒå›¾</h4><p>å±•ç¤ºï¼š</p>
<ul>
<li>å…¨éƒ¨SNPèƒŒæ™¯ï¼›</li>
<li>æ˜¾è‘—SNPæ ‡è®°ï¼›</li>
<li>çƒ­ç‚¹åŒºåŸŸçŸ©å½¢æ ‡æ³¨ï¼›</li>
<li>æ˜¾è‘—é˜ˆå€¼çº¿ï¼›<br> è¾“å‡ºæ–‡ä»¶ï¼š<code>*_final_analysis.png</code></li>
</ul>
<h4 id="ï¼ˆ2ï¼‰çƒ­ç‚¹åŒºåŸŸç»†åŒ–å¯è§†åŒ–"><a href="#ï¼ˆ2ï¼‰çƒ­ç‚¹åŒºåŸŸç»†åŒ–å¯è§†åŒ–" class="headerlink" title="ï¼ˆ2ï¼‰çƒ­ç‚¹åŒºåŸŸç»†åŒ–å¯è§†åŒ–"></a>ï¼ˆ2ï¼‰çƒ­ç‚¹åŒºåŸŸç»†åŒ–å¯è§†åŒ–</h4><p>ä¸ºæ¯ä¸ªçƒ­ç‚¹å•ç‹¬ç»˜åˆ¶è¯¦ç»†å›¾ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li>åŒºåŸŸå†…SNPåˆ†å¸ƒï¼›</li>
<li>æ˜¾è‘—SNPèšé›†æƒ…å†µï¼›</li>
<li>åŒºåŸŸç»Ÿè®¡æŒ‡æ ‡ã€‚</li>
</ul>
<p>è¾“å‡ºï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">- NC_047567.1_hotspot_1_detail.png
- NC_047567.1_hotspot_2_detail.png
- NC_047567.1_all_hotspots.png<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="ï¼ˆ3ï¼‰åˆ†ææ€»ç»“æŠ¥å‘Š"><a href="#ï¼ˆ3ï¼‰åˆ†ææ€»ç»“æŠ¥å‘Š" class="headerlink" title="ï¼ˆ3ï¼‰åˆ†ææ€»ç»“æŠ¥å‘Š"></a>ï¼ˆ3ï¼‰åˆ†ææ€»ç»“æŠ¥å‘Š</h4><p>è‡ªåŠ¨ç”Ÿæˆæ±‡æ€»æ–‡ä»¶ï¼š</p>
<ul>
<li><code>*_analysis_summary.csv</code><br> åŒ…å«æ€»SNPæ•°ã€æ˜¾è‘—SNPæ•°ã€çƒ­ç‚¹æ•°é‡ã€æ¨èLDåˆ†æåŒºé—´ç­‰ä¿¡æ¯ã€‚</li>
</ul>
<hr>
<h2 id="ğŸ§­-äº”ã€ç»“æœè§£è¯»ä¸åç»­åˆ†æå»ºè®®"><a href="#ğŸ§­-äº”ã€ç»“æœè§£è¯»ä¸åç»­åˆ†æå»ºè®®" class="headerlink" title="ğŸ§­ äº”ã€ç»“æœè§£è¯»ä¸åç»­åˆ†æå»ºè®®"></a>ğŸ§­ äº”ã€ç»“æœè§£è¯»ä¸åç»­åˆ†æå»ºè®®</h2><p>ç»è¿‡ä¸‰æ­¥ R è„šæœ¬åˆ†æåï¼Œä½ å°†è·å¾—ä»¥ä¸‹æ ¸å¿ƒæˆæœï¼š</p>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>æ–‡ä»¶å</th>
<th>å†…å®¹è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>åŸºç¡€åˆ†æå›¾</td>
<td><code>_basic_analysis.png</code></td>
<td>SNPå¯†åº¦ + æ›¼å“ˆé¡¿å›¾</td>
</tr>
<tr>
<td>çƒ­ç‚¹åˆ†æå›¾</td>
<td><code>_hotspot_corrected.png</code></td>
<td>åŸºäºå¯†åº¦çš„çƒ­ç‚¹è¯†åˆ«</td>
</tr>
<tr>
<td>æ˜¾è‘—çƒ­ç‚¹å›¾</td>
<td><code>_significant_hotspots.png</code></td>
<td>æ˜¾è‘—SNPèšé›†åŒº</td>
</tr>
<tr>
<td>ç»¼åˆæŠ¥å‘Šå›¾</td>
<td><code>_final_analysis.png</code></td>
<td>æ›¼å“ˆé¡¿ + å¯†åº¦åŒå›¾</td>
</tr>
<tr>
<td>LDæ¨èåŒºåŸŸ</td>
<td><code>_recommended_ld_regions.csv</code></td>
<td>å»ºè®®LDåˆ†æåŒºé—´</td>
</tr>
<tr>
<td>æ±‡æ€»ç»Ÿè®¡</td>
<td><code>_analysis_summary.csv</code></td>
<td>å…³é”®å‚æ•°è¡¨</td>
</tr>
</tbody></table>
<h3 id="ğŸ”¬-ä¸‹ä¸€æ­¥å»ºè®®ï¼š"><a href="#ğŸ”¬-ä¸‹ä¸€æ­¥å»ºè®®ï¼š" class="headerlink" title="ğŸ”¬ ä¸‹ä¸€æ­¥å»ºè®®ï¼š"></a>ğŸ”¬ ä¸‹ä¸€æ­¥å»ºè®®ï¼š</h3><ol>
<li>åœ¨æ¨èåŒºåŸŸä¸­è¿›è¡Œ <strong>LD Block åˆ†æ</strong>ï¼›</li>
<li>ä½¿ç”¨ <code>plink --r2</code> æˆ– <code>haploview</code> è®¡ç®— LDï¼›</li>
<li>ç»“åˆ <strong>åŸºå› æ³¨é‡Š / è½¬å½•ç»„è¡¨è¾¾æ•°æ®</strong>ï¼Œç­›é€‰æ½œåœ¨åŠŸèƒ½åŸºå› ï¼›</li>
<li>è‹¥çƒ­ç‚¹åŒºåŸŸè¾ƒé›†ä¸­ï¼Œå¯è¿›ä¸€æ­¥åš <strong>å€™é€‰åŒºåŸŸ GWAS é‡åˆ†æ</strong>ã€‚</li>
</ol>
<hr>
<h2 id="ğŸ”¬-å…­ã€GWASçƒ­ç‚¹åŒºåŸŸåˆ†æ"><a href="#ğŸ”¬-å…­ã€GWASçƒ­ç‚¹åŒºåŸŸåˆ†æ" class="headerlink" title="ğŸ”¬ å…­ã€GWASçƒ­ç‚¹åŒºåŸŸåˆ†æ"></a>ğŸ”¬ å…­ã€GWASçƒ­ç‚¹åŒºåŸŸåˆ†æ</h2><p>4.auto_gwas_hotspot_ld.sh</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># ç»¼åˆLDåˆ†æå’ŒLocusZoomå›¾ç”Ÿæˆè„šæœ¬ - å¯é…ç½®ç‰ˆ</span>
<span class="token comment"># ç”¨æ³•: ./combined_ld_locuszoom_configurable.sh &lt;çƒ­ç‚¹åŒºåŸŸåç§°&gt; &lt;æŸ“è‰²ä½“&gt; &lt;èµ·å§‹ä½ç½®&gt; &lt;ç»ˆæ­¢ä½ç½®&gt;</span>

<span class="token builtin class-name">set</span> <span class="token parameter variable">-e</span>

<span class="token comment"># ========== å¯é…ç½®å‚æ•° ==========</span>
<span class="token assign-left variable">SIGNIFICANCE_THRESHOLD</span><span class="token operator">=</span><span class="token string">"1e-8"</span>  <span class="token comment"># æ˜¾è‘—æ€§é˜ˆå€¼ï¼Œå¯ä¿®æ”¹ä¸º1e-6ã€5e-8ç­‰</span>
<span class="token assign-left variable">MAF_FILTER</span><span class="token operator">=</span><span class="token string">"0.4"</span>              <span class="token comment"># MAFè¿‡æ»¤é˜ˆå€¼</span>
<span class="token comment"># ===============================</span>

<span class="token assign-left variable">REGION_NAME</span><span class="token operator">=</span><span class="token variable">$1</span>
<span class="token assign-left variable">CHROM</span><span class="token operator">=</span><span class="token variable">$2</span>
<span class="token assign-left variable">REGION_START</span><span class="token operator">=</span><span class="token variable">$3</span>
<span class="token assign-left variable">REGION_END</span><span class="token operator">=</span><span class="token variable">$4</span>

<span class="token builtin class-name">echo</span> <span class="token string">"=== ç»¼åˆLDåˆ†æå’ŒLocusZoomå›¾ç”Ÿæˆ: <span class="token variable">$REGION_NAME</span> ==="</span>
<span class="token builtin class-name">echo</span> <span class="token string">"ä½¿ç”¨å‚æ•°: æ˜¾è‘—æ€§é˜ˆå€¼=<span class="token variable">$SIGNIFICANCE_THRESHOLD</span>, MAFè¿‡æ»¤=<span class="token variable">$MAF_FILTER</span>"</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$REGION_NAME</span>"</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$CHROM</span>"</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$REGION_START</span>"</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$REGION_END</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"é”™è¯¯: å‚æ•°ä¸å®Œæ•´"</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"ç”¨æ³•: <span class="token variable">$0</span> &lt;çƒ­ç‚¹åŒºåŸŸåç§°&gt; &lt;æŸ“è‰²ä½“&gt; &lt;èµ·å§‹ä½ç½®&gt; &lt;ç»ˆæ­¢ä½ç½®&gt;"</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>

<span class="token comment"># è®¾ç½®åŸºç¡€ç›®å½•</span>
<span class="token assign-left variable">BASE_DIR</span><span class="token operator">=</span><span class="token string">"/mnt/usb/LD-block"</span>
<span class="token assign-left variable">VCF_FILE</span><span class="token operator">=</span><span class="token string">"/media/hhhh/5435CA8664BB5557/Desktop/é—­å£³è‚Œç—•/å¤šç»„å­¦/é‡æµ‹åº/3.Variants/Filter.snp.vcf.gz"</span>
<span class="token assign-left variable">GWAS_FILE</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${BASE_DIR}</span>/color_GWAS.anno.xls"</span>
<span class="token assign-left variable">GFF_FILE</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${BASE_DIR}</span>/GCF_902806645.1_cgigas_uk_roslin_v1_genomic.gff.gz"</span>

<span class="token builtin class-name">echo</span> <span class="token string">"å·¥ä½œç›®å½•: <span class="token variable">$BASE_DIR</span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"åˆ†æåŒºåŸŸ: <span class="token variable">$CHROM</span>:<span class="token variable">$REGION_START</span>-<span class="token variable">$REGION_END</span>"</span>

<span class="token comment"># åˆ‡æ¢åˆ°å·¥ä½œç›®å½•</span>
<span class="token builtin class-name">cd</span> <span class="token string">"<span class="token variable">$BASE_DIR</span>"</span>

<span class="token comment"># åˆ›å»ºåŒºåŸŸå·¥ä½œç›®å½•</span>
<span class="token assign-left variable">WORK_DIR</span><span class="token operator">=</span><span class="token string">"Complete_Analysis_<span class="token variable">${REGION_NAME}</span>"</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token string">"<span class="token variable">$WORK_DIR</span>"</span>
<span class="token builtin class-name">cd</span> <span class="token string">"<span class="token variable">$WORK_DIR</span>"</span>

<span class="token builtin class-name">echo</span> <span class="token string">"=== é˜¶æ®µ1: åŸºç¡€æ•°æ®å‡†å¤‡ ==="</span>

<span class="token comment"># æ­¥éª¤1: å‡†å¤‡GFFæ–‡ä»¶</span>
<span class="token builtin class-name">echo</span> <span class="token string">"æ­¥éª¤1: å‡†å¤‡GFFæ–‡ä»¶..."</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">$GFF_FILE</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"è§£å‹GFFæ–‡ä»¶..."</span>
    gunzip <span class="token parameter variable">-c</span> <span class="token string">"<span class="token variable">$GFF_FILE</span>"</span> <span class="token operator">&gt;</span> genomic.gff
    <span class="token assign-left variable">GFF_FILE_PATH</span><span class="token operator">=</span><span class="token string">"genomic.gff"</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"ä½¿ç”¨GFFæ–‡ä»¶: <span class="token variable">$GFF_FILE_PATH</span>"</span>
<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"è­¦å‘Š: æœªæ‰¾åˆ°GFFæ–‡ä»¶ï¼Œå°†ç”Ÿæˆæ— åŸºå› æ³¨é‡Šçš„å›¾"</span>
    <span class="token assign-left variable">GFF_FILE_PATH</span><span class="token operator">=</span><span class="token string">""</span>
<span class="token keyword">fi</span>

<span class="token comment"># æ­¥éª¤2: æå–æ˜¾è‘—SNP</span>
<span class="token builtin class-name">echo</span> <span class="token string">"æ­¥éª¤2: æå–æ˜¾è‘—SNP..."</span>
<span class="token function">awk</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">chrom</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$CHROM</span>"</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">start</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$REGION_START</span>"</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">end</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$REGION_END</span>"</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">threshold</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$SIGNIFICANCE_THRESHOLD</span>"</span> <span class="token string">'
BEGIN {FS="\t"; OFS="\t"}
$1 == chrom &amp;&amp; $2 &gt;= start &amp;&amp; $2 &lt;= end &amp;&amp; $5 &lt; threshold {
    print $0
}'</span> <span class="token punctuation">..</span>/color_GWAS.anno.xls <span class="token operator">&gt;</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_significant_snps.txt"</span>

<span class="token assign-left variable">SNP_COUNT</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">wc</span> <span class="token parameter variable">-l</span> <span class="token operator">&lt;</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_significant_snps.txt"</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">"0"</span><span class="token variable">)</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">"æ‰¾åˆ° <span class="token variable">$SNP_COUNT</span> ä¸ªæ˜¾è‘—SNP (P &lt; <span class="token variable">$SIGNIFICANCE_THRESHOLD</span>)"</span>

<span class="token builtin class-name">echo</span> <span class="token string">"=== é˜¶æ®µ2: å®Œæ•´LDåˆ†æ ==="</span>

<span class="token comment"># æ­¥éª¤3: æå–VCFæ•°æ®</span>
<span class="token builtin class-name">echo</span> <span class="token string">"æ­¥éª¤3: æå–VCFæ•°æ®..."</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_significant_snps.txt"</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$SNP_COUNT</span>"</span> <span class="token parameter variable">-gt</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token comment"># åˆ›å»ºBEDæ–‡ä»¶æå–æ˜¾è‘—SNP</span>
    <span class="token function">awk</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">chrom</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$CHROM</span>"</span> <span class="token string">'{print chrom "\t" ($2-1) "\t" $2}'</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_significant_snps.txt"</span> <span class="token operator">&gt;</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_snps.bed"</span>
    bcftools view <span class="token parameter variable">-T</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_snps.bed"</span> <span class="token string">"<span class="token variable">$VCF_FILE</span>"</span> <span class="token parameter variable">-Ov</span> <span class="token parameter variable">-o</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_significant.vcf"</span>
<span class="token keyword">else</span>
    <span class="token comment"># å¦‚æœæ— æ˜¾è‘—SNPï¼Œæå–æ•´ä¸ªåŒºåŸŸ</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"æå–æ•´ä¸ªåŒºåŸŸVCFæ•°æ®..."</span>
    bcftools view <span class="token parameter variable">-r</span> <span class="token string">"<span class="token variable">${CHROM}</span>:<span class="token variable">${REGION_START}</span>-<span class="token variable">${REGION_END}</span>"</span> <span class="token string">"<span class="token variable">$VCF_FILE</span>"</span> <span class="token parameter variable">-Ov</span> <span class="token parameter variable">-o</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_significant.vcf"</span>
<span class="token keyword">fi</span>

<span class="token assign-left variable">EXTRACTED_COUNT</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">"^#"</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_significant.vcf"</span> <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">"0"</span><span class="token variable">)</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">"æå–åˆ° <span class="token variable">$EXTRACTED_COUNT</span> ä¸ªSNP"</span>

<span class="token comment"># ä¿®å¤æ ·æœ¬åå’ŒæŸ“è‰²ä½“</span>
<span class="token builtin class-name">echo</span> <span class="token string">"ä¿®å¤æ ·æœ¬åå’ŒæŸ“è‰²ä½“..."</span>
bcftools query <span class="token parameter variable">-l</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_significant.vcf"</span> <span class="token operator">&gt;</span> original_samples.txt
<span class="token function">sed</span> <span class="token string">'s/_/-/g'</span> original_samples.txt <span class="token operator">&gt;</span> new_samples.txt
bcftools reheader <span class="token parameter variable">-s</span> new_samples.txt <span class="token string">"<span class="token variable">${REGION_NAME}</span>_significant.vcf"</span> <span class="token parameter variable">-o</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_fixed_samples.vcf"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$CHROM</span> 1"</span> <span class="token operator">&gt;</span> chr_map.txt
bcftools annotate --rename-chrs chr_map.txt <span class="token string">"<span class="token variable">${REGION_NAME}</span>_fixed_samples.vcf"</span> <span class="token parameter variable">-Ov</span> <span class="token parameter variable">-o</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_numeric.vcf"</span>

<span class="token comment"># å‹ç¼©å’Œç´¢å¼•</span>
bgzip <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_numeric.vcf"</span>
tabix <span class="token parameter variable">-p</span> vcf <span class="token string">"<span class="token variable">${REGION_NAME}</span>_numeric.vcf.gz"</span>

<span class="token comment"># æ­¥éª¤4: ä½¿ç”¨PLINKè¿›è¡ŒLDåˆ†æ</span>
<span class="token builtin class-name">echo</span> <span class="token string">"æ­¥éª¤4: PLINK LDåˆ†æ..."</span>
plink <span class="token parameter variable">--vcf</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_numeric.vcf.gz"</span> <span class="token punctuation">\</span>
      --allow-extra-chr <span class="token punctuation">\</span>
      --double-id <span class="token punctuation">\</span>
      <span class="token parameter variable">--r2</span> <span class="token punctuation">\</span>
      --ld-window <span class="token number">1000</span> <span class="token punctuation">\</span>
      --ld-window-kb <span class="token number">10000</span> <span class="token punctuation">\</span>
      --ld-window-r2 <span class="token number">0</span> <span class="token punctuation">\</span>
      <span class="token parameter variable">--out</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_plink_ld"</span> 

<span class="token builtin class-name">echo</span> <span class="token string">"=== é˜¶æ®µ3: ç”Ÿæˆé«˜è´¨é‡LocusZoomå›¾ ==="</span>

<span class="token comment"># æ­¥éª¤5: ç”Ÿæˆé«˜è´¨é‡LocusZoomå›¾</span>
<span class="token builtin class-name">echo</span> <span class="token string">"æ­¥éª¤5: ç”Ÿæˆé«˜è´¨é‡LocusZoomå›¾..."</span>
<span class="token function">cat</span> <span class="token operator">&gt;</span> generate_high_quality_locuszoom.R <span class="token operator">&lt;&lt;</span> <span class="token string">EOF3
#!/usr/bin/env Rscript
library(ggplot2)
library(patchwork)
library(viridis)

cat("ç”Ÿæˆé«˜è´¨é‡LocusZoomå›¾...<span class="token entity" title="\n">\n</span>")

args &lt;- commandArgs(trailingOnly = TRUE)
region_name &lt;- args[1]
region_start &lt;- as.numeric(args[2])
region_end &lt;- as.numeric(args[3])
significance_threshold &lt;- as.numeric(args[4])

cat("åŒºåŸŸ:", region_name, "<span class="token entity" title="\n">\n</span>")
cat("ä½ç½®èŒƒå›´:", region_start, "-", region_end, "<span class="token entity" title="\n">\n</span>")
cat("æ˜¾è‘—æ€§é˜ˆå€¼:", significance_threshold, "<span class="token entity" title="\n">\n</span>")

# è¯»å–æ˜¾è‘—SNPæ•°æ®
sig_file &lt;- paste0(region_name, "_significant_snps.txt")
if(file.exists(sig_file) &amp;&amp; file.info(sig_file)\<span class="token variable">$size</span> &gt; 0) {
    cat("è¯»å–æ˜¾è‘—SNPæ–‡ä»¶:", sig_file, "<span class="token entity" title="\n">\n</span>")
    sig_snps &lt;- read.table(sig_file, sep="<span class="token entity" title="\t">\t</span>", header=FALSE,
                          col.names=c("CHROM","POS","REF","ALT","PVALUE","OBS","MAF","ANNO","GENE"))
    # å¤„ç†å¯èƒ½çš„NAå€¼
    sig_snps\<span class="token variable">$PVALUE</span> &lt;- as.numeric(as.character(sig_snps\<span class="token variable">$PVALUE</span>))
    sig_snps\<span class="token variable">$MAF</span> &lt;- as.numeric(as.character(sig_snps\<span class="token variable">$MAF</span>))
    
    # ç§»é™¤NAå€¼
    sig_snps &lt;- sig_snps[!is.na(sig_snps\<span class="token variable">$PVALUE</span>) &amp; !is.na(sig_snps\<span class="token variable">$MAF</span>), ]
    
    cat("æœ‰æ•ˆæ˜¾è‘—SNPæ•°é‡:", nrow(sig_snps), "<span class="token entity" title="\n">\n</span>")
    
    if(nrow(sig_snps) &gt; 0) {
        # åˆ›å»ºä¸“ä¸šLocusZoomå›¾ - ä¸Šéƒ¨ï¼šGWASä¿¡å·
        p1 &lt;- ggplot(sig_snps, aes(x = POS/1e6, y = -log10(PVALUE))) +
            geom_point(aes(color = ANNO, size = MAF), alpha = 0.8) +
            geom_hline(yintercept = -log10(significance_threshold), color = "red", linetype = "dashed", linewidth = 1) +
            scale_color_viridis_d(name = "æ³¨é‡Šç±»å‹") +
            scale_size_continuous(name = "MAF", range = c(3, 8)) +
            labs(title = paste("LocusZoomå›¾ -", region_name),
                 subtitle = paste(nrow(sig_snps), "ä¸ªæ˜¾è‘—SNP (P &lt;", format(significance_threshold, scientific=TRUE), ")"),
                 x = "", y = "-log10(På€¼)") +
            theme_minimal() +
            theme(legend.position = "top",
                  plot.title = element_text(size = 14, face = "bold"),
                  plot.subtitle = element_text(size = 12))
        
        # ä¸‹éƒ¨ï¼šLDçƒ­å›¾
        ld_file &lt;- paste0(region_name, "_plink_ld.ld")
        if(file.exists(ld_file) &amp;&amp; file.info(ld_file)\<span class="token variable">$size</span> &gt; 0) {
            cat("è¯»å–LDæ–‡ä»¶:", ld_file, "<span class="token entity" title="\n">\n</span>")
            ld_data &lt;- read.table(ld_file, header=TRUE)
            cat("LDæ•°æ®è®°å½•æ•°:", nrow(ld_data), "<span class="token entity" title="\n">\n</span>")
            
            if(nrow(ld_data) &gt; 0) {
                p2 &lt;- ggplot(ld_data, aes(x = BP_A/1e6, y = BP_B/1e6, color = R2)) +
                    geom_point(size = 3, alpha = 0.7) +
                    scale_color_viridis_c(name = "LD (RÂ²)", limits = c(0, 1)) +
                    labs(x = "åŸºå› ç»„ä½ç½® (Mb)", y = "åŸºå› ç»„ä½ç½® (Mb)",
                         subtitle = "LDçƒ­å›¾") +
                    theme_minimal()
            } else {
                p2 &lt;- ggplot() +
                    annotate("text", x = 0.5, y = 0.5, label = "LDæ•°æ®ä¸ºç©º", size = 6, color = "gray") +
                    labs(x = "åŸºå› ç»„ä½ç½® (Mb)", y = "åŸºå› ç»„ä½ç½® (Mb)") +
                    theme_void()
            }
        } else {
            p2 &lt;- ggplot() +
                annotate("text", x = 0.5, y = 0.5, label = "LDçƒ­å›¾æ•°æ®ç¼ºå¤±", size = 6, color = "gray") +
                labs(x = "åŸºå› ç»„ä½ç½® (Mb)", y = "åŸºå› ç»„ä½ç½® (Mb)") +
                theme_void()
        }
        
        # ç»„åˆå›¾å½¢
        combined &lt;- p1 / p2 + 
            plot_layout(heights = c(1, 1))
        
        output_file &lt;- paste0("High_Quality_LocusZoom_", region_name, ".png")
        ggsave(output_file, combined, width = 12, height = 10, dpi = 300, bg = "white")
        cat("âœ“ é«˜è´¨é‡LocusZoomå›¾ç”Ÿæˆå®Œæˆ:", output_file, "<span class="token entity" title="\n">\n</span>")
        
    } else {
        cat("æ— æœ‰æ•ˆæ˜¾è‘—SNPæ•°æ®<span class="token entity" title="\n">\n</span>")
    }
} else {
    cat("æ˜¾è‘—SNPæ–‡ä»¶ä¸å­˜åœ¨æˆ–ä¸ºç©º<span class="token entity" title="\n">\n</span>")
}

cat("âœ“ é«˜è´¨é‡LocusZoomå›¾ç”Ÿæˆå®Œæˆ<span class="token entity" title="\n">\n</span>")
EOF3</span>

Rscript generate_high_quality_locuszoom.R <span class="token string">"<span class="token variable">$REGION_NAME</span>"</span> <span class="token string">"<span class="token variable">$REGION_START</span>"</span> <span class="token string">"<span class="token variable">$REGION_END</span>"</span> <span class="token string">"<span class="token variable">$SIGNIFICANCE_THRESHOLD</span>"</span>

<span class="token builtin class-name">echo</span> <span class="token string">"=== é˜¶æ®µ4: ç”Ÿæˆè„šæœ¬4é£æ ¼å®Œæ•´å›¾ ==="</span>

<span class="token comment"># æ­¥éª¤6: å‡†å¤‡GWASæ–‡ä»¶</span>
<span class="token builtin class-name">echo</span> <span class="token string">"æ­¥éª¤6: å‡†å¤‡GWASæ–‡ä»¶..."</span>
<span class="token function">awk</span> <span class="token string">'{print $1, $2, $5}'</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_significant_snps.txt"</span> <span class="token operator">&gt;</span> gwas_significant.pvalue

<span class="token comment"># æ­¥éª¤7: ä½¿ç”¨è„šæœ¬4çš„å®Œæ•´æ–¹æ¡ˆç”Ÿæˆå›¾ç‰‡</span>
<span class="token builtin class-name">echo</span> <span class="token string">"æ­¥éª¤7: ä½¿ç”¨è„šæœ¬4çš„å®Œæ•´æ–¹æ¡ˆç”Ÿæˆå›¾ç‰‡..."</span>

<span class="token comment"># ç›´æ¥è¿è¡Œï¼Œè®©LDBlockShowè‡ªå·±å¤„ç†</span>
LDBlockShow <span class="token parameter variable">-InVCF</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_significant.vcf"</span> <span class="token punctuation">\</span>
            <span class="token parameter variable">-OutPut</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_LD"</span> <span class="token punctuation">\</span>
            <span class="token parameter variable">-InGWAS</span> <span class="token string">"gwas_significant.pvalue"</span> <span class="token punctuation">\</span>
            <span class="token parameter variable">-Region</span> <span class="token string">"<span class="token variable">${CHROM}</span>:<span class="token variable">${REGION_START}</span>:<span class="token variable">${REGION_END}</span>"</span> <span class="token punctuation">\</span>
            <span class="token parameter variable">-SeleVar</span> <span class="token number">3</span> <span class="token punctuation">\</span>
            <span class="token parameter variable">-OutPng</span> <span class="token punctuation">\</span>
            <span class="token parameter variable">-BlockType</span> <span class="token number">2</span> <span class="token punctuation">\</span>
            <span class="token parameter variable">-MAF</span> <span class="token number">0.05</span>

<span class="token comment"># æ£€æŸ¥ç”Ÿæˆç»“æœ</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_LD.png"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"âœ“ è„šæœ¬4é£æ ¼å®Œæ•´å›¾ç”ŸæˆæˆåŠŸ: <span class="token variable">${REGION_NAME}</span>_LD.png"</span>
    <span class="token comment"># å¤åˆ¶ä¸€ä»½ä½œä¸ºæœ€ç»ˆç»“æœ</span>
    <span class="token function">cp</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_LD.png"</span> <span class="token string">"Script4_Complete_<span class="token variable">${REGION_NAME}</span>.png"</span>
<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"âœ— è„šæœ¬4é£æ ¼ç”Ÿæˆå¤±è´¥ï¼Œå°è¯•å¤‡é€‰æ–¹æ¡ˆ..."</span>
    
    <span class="token comment"># å¤‡é€‰æ–¹æ¡ˆï¼šä½¿ç”¨ç®€åŒ–ç‰ˆæœ¬</span>
    LDBlockShow <span class="token parameter variable">-InVCF</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_significant.vcf"</span> <span class="token punctuation">\</span>
                <span class="token parameter variable">-OutPut</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_LD_simple"</span> <span class="token punctuation">\</span>
                <span class="token parameter variable">-Region</span> <span class="token string">"<span class="token variable">${CHROM}</span>:<span class="token variable">${REGION_START}</span>:<span class="token variable">${REGION_END}</span>"</span> <span class="token punctuation">\</span>
                <span class="token parameter variable">-SeleVar</span> <span class="token number">2</span> <span class="token punctuation">\</span>
                <span class="token parameter variable">-OutPng</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">"Warning"</span> <span class="token operator">||</span> <span class="token boolean">true</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_LD_simple.png"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">cp</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_LD_simple.png"</span> <span class="token string">"Script4_Complete_<span class="token variable">${REGION_NAME}</span>.png"</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"âœ“ ä½¿ç”¨ç®€åŒ–ç‰ˆä½œä¸ºå¤‡é€‰"</span>
    <span class="token keyword">fi</span>
<span class="token keyword">fi</span>

<span class="token builtin class-name">echo</span> <span class="token string">"=== é˜¶æ®µ5: ç”ŸæˆRç‰ˆæœ¬å¤‡é€‰å›¾ ==="</span>

<span class="token comment"># æ­¥éª¤8: ç”ŸæˆR_LocusZoom_Style.pngä½œä¸ºå¤‡é€‰</span>
<span class="token builtin class-name">echo</span> <span class="token string">"æ­¥éª¤8: ç”ŸæˆR_LocusZoom_Style.pngä½œä¸ºå¤‡é€‰..."</span>
<span class="token function">cat</span> <span class="token operator">&gt;</span> generate_r_locuszoom.R <span class="token operator">&lt;&lt;</span> <span class="token string">EOF2
#!/usr/bin/env Rscript
library(ggplot2)
library(gridExtra)
library(patchwork)

cat("åˆ›å»ºRç‰ˆLocusZoomé£æ ¼å›¾...<span class="token entity" title="\n">\n</span>")

args &lt;- commandArgs(trailingOnly = TRUE)
region_name &lt;- args[1]
region_start &lt;- as.numeric(args[2])
region_end &lt;- as.numeric(args[3])
significance_threshold &lt;- as.numeric(args[4])

cat("åŒºåŸŸ:", region_name, "<span class="token entity" title="\n">\n</span>")
cat("ä½ç½®:", region_start, "-", region_end, "<span class="token entity" title="\n">\n</span>")
cat("æ˜¾è‘—æ€§é˜ˆå€¼:", significance_threshold, "<span class="token entity" title="\n">\n</span>")

# è¯»å–GWASæ•°æ®
gwas_file &lt;- paste0(region_name, "_significant_snps.txt")
if(file.exists(gwas_file)) {
    gwas &lt;- read.table(gwas_file, sep="<span class="token entity" title="\t">\t</span>", header=FALSE,
                      col.names=c("CHROM","POS","REF","ALT","PVALUE","OBS","MAF","ANNO","GENE"))
    gwas\<span class="token variable">$PVALUE</span> &lt;- as.numeric(gwas\<span class="token variable">$PVALUE</span>)
    
    cat("åŒºåŸŸå†…çš„GWAS SNPæ•°é‡:", nrow(gwas), "<span class="token entity" title="\n">\n</span>")
    
    if(nrow(gwas) &gt; 0) {
        # åˆ›å»ºç»¼åˆå›¾
        p1 &lt;- ggplot(gwas, aes(x = POS/1e6, y = -log10(PVALUE))) +
            geom_point(aes(color = ANNO), size = 3, alpha = 0.7) +
            geom_hline(yintercept = -log10(significance_threshold), color = "red", linetype = "dashed", linewidth = 1) +
            scale_color_brewer(palette = "Set1", name = "æ³¨é‡Šç±»å‹") +
            labs(title = paste("GWASä¿¡å· -", region_name, "(P &lt;", format(significance_threshold, scientific=TRUE), ")"),
                 x = "", y = "-log10(På€¼)") +
            theme_minimal() +
            theme(axis.text.x = element_blank())
        
        # è¯»å–LDæ•°æ®
        ld_file &lt;- paste0(region_name, "_plink_ld.ld")
        if(file.exists(ld_file)) {
            ld_data &lt;- read.table(ld_file, header = TRUE)
            
            p2 &lt;- ggplot(ld_data, aes(x = BP_A/1e6, y = BP_B/1e6, color = R2)) +
                geom_point(size = 2, alpha = 0.7) +
                scale_color_gradient2(name = "RÂ²", low = "blue", mid = "yellow", high = "red", midpoint = 0.5, limits = c(0, 1)) +
                labs(x = "åŸºå› ç»„ä½ç½® (Mb)", y = "åŸºå› ç»„ä½ç½® (Mb)") +
                theme_minimal()
        } else {
            p2 &lt;- ggplot() + 
                geom_text(aes(x = 0.5, y = 0.5, label = "æ— LDæ•°æ®")) +
                labs(x = "åŸºå› ç»„ä½ç½® (Mb)", y = "åŸºå› ç»„ä½ç½® (Mb)") +
                theme_minimal()
        }
        
        # ç»„åˆå›¾å½¢
        combined_plot &lt;- p1 / p2 + 
            plot_layout(heights = c(1, 1))
        
        ggsave("R_LocusZoom_Style.png", combined_plot, width = 10, height = 8, dpi = 300)
        cat("âœ“ Rç‰ˆLocusZoomé£æ ¼å›¾ç”Ÿæˆå®Œæˆ: R_LocusZoom_Style.png<span class="token entity" title="\n">\n</span>")
    } else {
        cat("é”™è¯¯: åœ¨æŒ‡å®šåŒºåŸŸå†…æœªæ‰¾åˆ°GWASæ•°æ®<span class="token entity" title="\n">\n</span>")
    }
} else {
    cat("é”™è¯¯: æœªæ‰¾åˆ°GWASæ–‡ä»¶<span class="token entity" title="\n">\n</span>")
}
EOF2</span>

Rscript generate_r_locuszoom.R <span class="token string">"<span class="token variable">$REGION_NAME</span>"</span> <span class="token string">"<span class="token variable">$REGION_START</span>"</span> <span class="token string">"<span class="token variable">$REGION_END</span>"</span> <span class="token string">"<span class="token variable">$SIGNIFICANCE_THRESHOLD</span>"</span>

<span class="token builtin class-name">echo</span> <span class="token string">"=== é˜¶æ®µ6: æ¸…ç†å’Œæ€»ç»“ ==="</span>

<span class="token comment"># æ¸…ç†ä¸´æ—¶æ–‡ä»¶</span>
<span class="token builtin class-name">echo</span> <span class="token string">"æ¸…ç†ä¸´æ—¶æ–‡ä»¶..."</span>
<span class="token function">rm</span> <span class="token parameter variable">-f</span> original_samples.txt new_samples.txt chr_map.txt <span class="token punctuation">\</span>
      original_samples_all.txt new_samples_all.txt <span class="token punctuation">\</span>
      <span class="token string">"<span class="token variable">${REGION_NAME}</span>_significant.vcf"</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_fixed_samples.vcf"</span> <span class="token punctuation">\</span>
      <span class="token string">"<span class="token variable">${REGION_NAME}</span>_numeric.vcf.gz"</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_numeric.vcf.gz.tbi"</span> <span class="token punctuation">\</span>
      <span class="token string">"<span class="token variable">${REGION_NAME}</span>_snps.bed"</span> gwas_significant.pvalue genomic.gff <span class="token punctuation">\</span>
      generate_high_quality_locuszoom.R generate_r_locuszoom.R <span class="token punctuation">\</span>
      <span class="token string">"<span class="token variable">${REGION_NAME}</span>_all_snps.vcf.gz"</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_all_snps.vcf.gz.tbi"</span> <span class="token punctuation">\</span>
      <span class="token string">"<span class="token variable">${REGION_NAME}</span>_all_snps_fixed.vcf.gz"</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_all_snps_fixed.vcf.gz.tbi"</span> <span class="token punctuation">\</span>
      <span class="token string">"<span class="token variable">${REGION_NAME}</span>_LD.png"</span> <span class="token string">"<span class="token variable">${REGION_NAME}</span>_LD_simple.png"</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">||</span> <span class="token boolean">true</span>

<span class="token builtin class-name">echo</span> <span class="token string">""</span>
<span class="token builtin class-name">echo</span> <span class="token string">"=== ç»¼åˆåˆ†æå®Œæˆ! ==="</span>
<span class="token builtin class-name">echo</span> <span class="token string">"ğŸ“ å·¥ä½œç›®å½•: <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">""</span>
<span class="token builtin class-name">echo</span> <span class="token string">"ğŸ“Š ç”Ÿæˆçš„æ‰€æœ‰å›¾ç‰‡æ–‡ä»¶:"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"=== é«˜è´¨é‡LocusZoomå›¾ (Rç‰ˆæœ¬) ==="</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">file</span> <span class="token keyword">in</span> High_Quality_LocusZoom_*.png<span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">$file</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">size_kb</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">du</span> <span class="token parameter variable">-k</span> <span class="token string">"<span class="token variable">$file</span>"</span> <span class="token operator">|</span> <span class="token function">cut</span> <span class="token parameter variable">-f1</span><span class="token variable">)</span></span>
        <span class="token builtin class-name">echo</span> <span class="token string">"   ğŸ“„ <span class="token variable">$file</span> (<span class="token variable">${size_kb}</span> KB)"</span>
    <span class="token keyword">fi</span>
<span class="token keyword">done</span>

<span class="token builtin class-name">echo</span> <span class="token string">""</span>
<span class="token builtin class-name">echo</span> <span class="token string">"=== è„šæœ¬4é£æ ¼å®Œæ•´å›¾ ==="</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">file</span> <span class="token keyword">in</span> Script4_Complete_*.png<span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">$file</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">size_kb</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">du</span> <span class="token parameter variable">-k</span> <span class="token string">"<span class="token variable">$file</span>"</span> <span class="token operator">|</span> <span class="token function">cut</span> <span class="token parameter variable">-f1</span><span class="token variable">)</span></span>
        <span class="token builtin class-name">echo</span> <span class="token string">"   ğŸ“„ <span class="token variable">$file</span> (<span class="token variable">${size_kb}</span> KB) - æ¨èä½¿ç”¨"</span>
    <span class="token keyword">fi</span>
<span class="token keyword">done</span>

<span class="token builtin class-name">echo</span> <span class="token string">""</span>
<span class="token builtin class-name">echo</span> <span class="token string">"=== å…¶ä»–å¤‡é€‰å›¾ ==="</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">file</span> <span class="token keyword">in</span> R_LocusZoom_Style.png<span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">$file</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">size_kb</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">du</span> <span class="token parameter variable">-k</span> <span class="token string">"<span class="token variable">$file</span>"</span> <span class="token operator">|</span> <span class="token function">cut</span> <span class="token parameter variable">-f1</span><span class="token variable">)</span></span>
        <span class="token builtin class-name">echo</span> <span class="token string">"   ğŸ“„ <span class="token variable">$file</span> (<span class="token variable">${size_kb}</span> KB)"</span>
    <span class="token keyword">fi</span>
<span class="token keyword">done</span>

<span class="token builtin class-name">echo</span> <span class="token string">""</span>
<span class="token builtin class-name">echo</span> <span class="token string">"ğŸ” åˆ†ææ‘˜è¦:"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"   æ˜¾è‘—SNP: <span class="token variable">$SNP_COUNT</span> ä¸ª (P &lt; <span class="token variable">$SIGNIFICANCE_THRESHOLD</span>)"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"   æˆåŠŸæå–: <span class="token variable">$EXTRACTED_COUNT</span> ä¸ªSNP"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"   åŒºåŸŸSNP: <span class="token variable">$FINAL_SNP_COUNT</span> ä¸ª (ç”¨äºLDBlockShow)"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"   ä½¿ç”¨å‚æ•°:"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"     - æ˜¾è‘—æ€§é˜ˆå€¼: <span class="token variable">$SIGNIFICANCE_THRESHOLD</span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"     - MAFè¿‡æ»¤: <span class="token variable">$MAF_FILTER</span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"   æ¨èå›¾ç‰‡:"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"     - Script4_Complete_<span class="token variable">${REGION_NAME}</span>.png (è„šæœ¬4é£æ ¼ï¼Œä¸€æ°”å‘µæˆ)"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"     - High_Quality_LocusZoom_<span class="token variable">${REGION_NAME}</span>.png (é«˜è´¨é‡Rç‰ˆæœ¬)"</span>
<span class="token builtin class-name">echo</span> <span class="token string">""</span>
<span class="token builtin class-name">echo</span> <span class="token string">"âœ… æ‰€æœ‰å›¾ç‰‡ç”Ÿæˆå®Œæˆ!"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-none"><code class="language-none"># ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x 4.auto_gwas_hotspot_ld.sh

# ç”¨æ³•1: ä½¿ç”¨é»˜è®¤VCFæ–‡ä»¶åˆ†æçƒ­ç‚¹åŒºåŸŸ
./4.auto_gwas_hotspot_ld.sh "hotspot_31.5_32.0Mb" "NC_047567.1" 31500000 32000000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="ğŸ“š-ä¸ƒã€æ€»ç»“"><a href="#ğŸ“š-ä¸ƒã€æ€»ç»“" class="headerlink" title="ğŸ“š ä¸ƒã€æ€»ç»“"></a>ğŸ“š ä¸ƒã€æ€»ç»“</h2><p>æœ¬æµç¨‹å°†ä¼ ç»Ÿ GWAS ç»“æœä»â€œæ˜¾è‘—æ€§ç‚¹çš„ç½—åˆ—â€æå‡ä¸ºâ€œèšé›†ä¿¡å·çš„ç»“æ„åŒ–åˆ†æâ€ï¼Œå®ç°äº†ï¼š</p>
<ul>
<li>ğŸ”¹ ä»å•ç‚¹æ˜¾è‘—åˆ°åŒºåŸŸçƒ­ç‚¹çš„å±‚çº§èšç„¦ï¼›</li>
<li>ğŸ”¹ è‡ªåŠ¨åŒ– R + Shell æµç¨‹ï¼Œé¿å…äººå·¥é‡å¤æ“ä½œï¼›</li>
<li>ğŸ”¹ ä¸º LD blockã€å€™é€‰åŸºå› æŒ–æ˜æä¾›æ¸…æ™°çš„å®šä½ä¾æ®ã€‚</li>
</ul>
<p>è¿™å¥—æ¡†æ¶å¯æ— ç¼è¿ç§»è‡³ä»»æ„ç‰©ç§æˆ– GWAS é¡¹ç›®ï¼Œåªéœ€æ›´æ¢è¾“å…¥æ–‡ä»¶ä¸æŸ“è‰²ä½“åç§°å³å¯å¿«é€Ÿè¿è¡Œã€‚</p>
<blockquote>
<p>ğŸ’¡ <strong>å…³é”®è¯ï¼š</strong> GWASã€çƒ­ç‚¹åŒºåŸŸã€LD Blockã€æ˜¾è‘—æ€§SNPã€Rå¯è§†åŒ–</p>
</blockquote>
<hr>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://0HHHHHH0.github.io">HHHH</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://0hhhhhh0.github.io/2025/11/10/gwas-ld-block/">https://0hhhhhh0.github.io/2025/11/10/gwas-ld-block/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/GWAS/">GWAS</a></div><div class="post-share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/0HHHHHH0/Image@master/blog/v2-ecafe797ee44a3cafe3e129237072370_1440w.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/11/24/latex/" title="LaTeXè¯¦ç»†æ•™ç¨‹+æŠ€å·§æ€»ç»“"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">LaTeXè¯¦ç»†æ•™ç¨‹+æŠ€å·§æ€»ç»“</div></div><div class="info-2"><div class="info-item-1"> è½¬è½½è‡ª: https://blog.csdn.net/NSJim/article/details/109066847  å‰è¨€è‹¥æƒ³ç›´æ¥å­¦ä¹ LaTeXæ•°å­¦å…¬å¼ï¼Œè¯·å‚è§æˆ‘çš„å¦ä¸€ç¯‡åšå®¢ï¼šLaTeXæ•°å­¦å…¬å¼-è¯¦ç»†æ•™ç¨‹ ã€‚ æœ¬ç¯‡æ–‡ç« ä»‹ç»LaTeXçš„åŸºæœ¬ç”¨æ³•ï¼Œå¹¶æœ‰è‡ªå·±çš„ç»éªŒå’Œæ€»ç»“ã€‚å¦å¤–ï¼Œå¯ä»¥ä»LaTeXçš„å®˜æ–¹æ–‡æ¡£è¿›è¡Œå­¦ä¹ ï¼Œå®˜æ–¹æ–‡æ¡£å¤§éƒ¨åˆ†æ˜¯è‹±æ–‡æ–‡æ¡£ï¼Œé“¾æ¥ï¼šLaTeXåœ¨çº¿æ–‡æ¡£ ï¼ŒLaTexå®åŒ…æ–‡æ¡£ã€‚ æœ¬ç¯‡æ–‡ç« å†…å®¹åŒ…å«LaTeXå·¥å…·ï¼ŒLaTeXæ¨¡æ¿ï¼ŒLaTeXæŠ€å·§ï¼ŒLaTeXåŸºç¡€ï¼Œæ–‡ç« æ¶æ„ï¼Œå­—ä½“ã€å¤§å°å’Œé¢œè‰²ï¼Œé“¾æ¥ï¼Œåˆ—è¡¨ï¼Œå›¾ç‰‡ï¼Œè¡¨æ ¼ï¼Œæ•°å­¦å…¬å¼ï¼Œç®—æ³•ï¼ˆä¼ªä»£ç ï¼‰ï¼Œä»£ç å—ï¼Œè®ºæ–‡å†™ä½œï¼Œç­‰ç­‰ã€‚ LaTeXå·¥å…·ä»‹ç»LaTeXå·¥å…·åˆ†ä¸ºåœ¨çº¿å·¥å…·å’Œæœ¬åœ°å·¥å…·ï¼Œæœ¬åœ°å·¥å…·åˆåˆ†ä¸ºå‰å°å’Œåå°ã€‚åœ¨çº¿å·¥å…·æ¨èOverleafï¼Œæœ¬åœ°å·¥å…·æ¨èå‰å°ä½¿ç”¨TeXStudioï¼Œåå°æ¨èä½¿ç”¨TeXLiveï¼ˆåå°å·¥å…·æœ‰TeXLiveï¼ŒMikTeXï¼ŒCTeXç­‰ï¼‰ã€‚ å„ä¸ªåå°çš„æ¯”è¾ƒï¼šTeXLiveæœ‰è·¨å¹³å°çš„æ€§è´¨ï¼Œé€‚ç”¨äºLinuxã€Macä»¥åŠWindowsç³»ç»Ÿï¼›TeXLiveæ˜¯å®Œå…¨å®‰è£…ï¼Œå¤§å°å¤§æ¦‚ä¸º5Gå·¦å³ï¼›æ¯å¹´æœ‰ä¸€æ¬¡æ›´æ–°ã€‚TeXStudioåªé€‚ç”¨äºWi...</div></div></div></a><a class="pagination-related" href="/2025/11/09/fen-zi-dui-jie/" title="ä»åŸºå› åˆ°ç»“æ„ï¼šç”¨PyMOLå¯è§†åŒ–ç†è§£åˆ†å­å¯¹æ¥ä¸çªå˜æ•ˆåº”"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">ä»åŸºå› åˆ°ç»“æ„ï¼šç”¨PyMOLå¯è§†åŒ–ç†è§£åˆ†å­å¯¹æ¥ä¸çªå˜æ•ˆåº”</div></div><div class="info-2"><div class="info-item-1">ä»åŸºå› åˆ°ç»“æ„ï¼šç”¨PyMOLå¯è§†åŒ–ç†è§£åˆ†å­å¯¹æ¥ä¸çªå˜æ•ˆåº”äº²çˆ±çš„åŒå­¦ä»¬ï¼Œå½“æˆ‘ä»¬è°ˆè®ºâ€œç»“æ„ç”Ÿç‰©å­¦â€æˆ–â€œè®¡ç®—è¯ç‰©è®¾è®¡â€æ—¶ï¼Œåˆ†å­å¯¹æ¥å’Œè›‹ç™½è´¨çªå˜æ˜¯ä¸¤ä¸ªæ ¸å¿ƒæ¦‚å¿µã€‚å®ƒä»¬ä¸€ä¸ªå…³ä¹é¢„æµ‹ï¼Œä¸€ä¸ªå…³ä¹è§£é‡Šã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†ä¸ä»…ä»åŸç†ä¸Šç†è§£å®ƒä»¬ï¼Œæ›´å°†å€ŸåŠ©å¼ºå¤§çš„åˆ†å­å¯è§†åŒ–è½¯ä»¶PyMOLï¼Œå°†æŠ½è±¡çš„æ¦‚å¿µè½¬åŒ–ä¸ºå¯è§çš„3Dç»“æ„ã€‚ ç¬¬ä¸€éƒ¨åˆ†ï¼šåˆ†å­å¯¹æ¥â€”â€”å½“ä¼ ç»Ÿâ€œé’¥åŒ™é…é”â€é‡ä¸ŠAIâ€œç¥åŠ©æ”»â€åˆ†å­å¯¹æ¥çš„æœ¬è´¨æ˜¯åœ¨åŸå­å±‚é¢é¢„æµ‹å°åˆ†å­ï¼ˆé…ä½“ï¼‰ä¸å…¶é¶æ ‡ç”Ÿç‰©å¤§åˆ†å­ï¼ˆå—ä½“ï¼‰ä¹‹é—´çš„æœ€ä¼˜ç»“åˆæ¨¡å¼ã€‚ä¼ ç»Ÿçš„æµç¨‹æˆ‘ä»¬æ¯”ä½œâ€œé’¥åŒ™é…é”â€ï¼Œä½†ç°åœ¨ï¼Œæˆ‘ä»¬è¿æ¥äº†ä¸€ä½å¼ºå¤§çš„AIåŠ©æ‰‹â€”â€”AlphaFoldâ€”â€”å®ƒèƒ½ä¸ºè®¸å¤šæˆ‘ä»¬ä¸çŸ¥é“ç²¾ç¡®ç»“æ„çš„â€œé”â€ç”Ÿæˆé«˜ç²¾åº¦çš„3Dæ¨¡å‹ã€‚ ç°ä»£åˆ†å­å¯¹æ¥çš„å¢å¼ºç‰ˆæµç¨‹å¦‚ä¸‹ï¼š 1. ç»“æ„å‡†å¤‡ä¸é¢„å¤„ç†ï¼šè·å–â€œé”â€å’Œâ€œé’¥åŒ™â€çš„3Dè“å›¾ è¿™æ˜¯æ‰€æœ‰è®¡ç®—çš„åŸºçŸ³ã€‚è›‹ç™½è´¨å—ä½“çš„ä¸‰ç»´ç»“æ„æ˜¯åˆ†å­å¯¹æ¥çš„èµ·ç‚¹ã€‚å…¶æ¥æºä¸»è¦åˆ†ä¸ºå®éªŒè§£æå’Œè®¡ç®—é¢„æµ‹ä¸¤å¤§ç±»ã€‚  a) ä¼ ç»Ÿè·¯å¾„ï¼ˆå®éªŒç»“æ„ï¼‰ï¼šä»PDBæ•°æ®åº“ä¸‹è½½é€šè¿‡Xå°„çº¿æ™¶ä½“å­¦ã€å†·å†»ç”µé•œæˆ–æ ¸ç£å…±æŒ¯ç­‰æŠ€æœ¯è§£æçš„ç»“æ„ã€‚è¿™æ˜¯é‡‘æ ‡å‡†ï¼Œç²¾åº¦æœ€é«˜ã€‚ç„¶è€Œï¼Œå¹¶éæ‰€æœ‰è›‹ç™½è´¨ï¼Œç‰¹åˆ«æ˜¯æŸäº›è†œè›‹ç™½æˆ–å¤§å‹å¤åˆç‰©ï¼Œéƒ½èƒ½è¢«è½»æ˜“è§£æå‡ºç»“æ„ã€‚ b) è®¡ç®—é¢„...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2022/08/05/023-ji-yin-jia-zu-fen-xi/" title="ä¸€ä¸ªç®€å•çš„åŸºå› å®¶æ—åˆ†æ"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-06</div><div class="info-item-2">ä¸€ä¸ªç®€å•çš„åŸºå› å®¶æ—åˆ†æ</div></div><div class="info-2"><div class="info-item-1">åŸºå› å®¶æ—åˆ†æä»¥æ‹Ÿå—èŠ¥ä¸ºä¾‹ï¼Œé‡ç°ä¸€ä¸ªæè¿°èŠéº» å¤§è±†ã€æ‹Ÿå—èŠ¥ä¸­ä¸€ä¸ªä¸æ²¹è„‚åˆæˆç›¸å…³çš„åŸºå› çš„è¿›åŒ–å…³ç³»ä»¥åŠæ‹·è´æ•°å·®å¼‚çš„å›¾  ä¸€ã€å‡†å¤‡å‚è€ƒåŸºå› åºåˆ—æ‹Ÿå—èŠ¥ä¸­FAD4-likeåŸºå› æœ‰ä¸‰æ¡ï¼šAt1g62190ã€At2g22890ã€At4g27030 æ‹Ÿå—èŠ¥è›‹ç™½åºåˆ—æ–‡ä»¶ï¼šatha.fastaæ‰¾å‡ºä»¥ä¸Šä¸‰ä¸ªåºåˆ—ï¼Œæ‹·è´æ”¾è¿›query.fastaæ–‡ä»¶äºŒã€å‡†å¤‡å¤§è±†å’ŒèŠéº»çš„è›‹ç™½åºåˆ—èŠéº»è›‹ç™½åºåˆ—æ–‡ä»¶ï¼šsind.fastaå¤§è±†è›‹ç™½åºåˆ—æ–‡ä»¶ï¼šgmax.fasta######åˆå¹¶èŠéº»ã€å¤§è±†ã€æ‹Ÿå—èŠ¥çš„è›‹ç™½åºåˆ—æ–‡ä»¶ cat atha.fasta gmax.fasta sind.fasta &gt; all.fasta ä¸‰ã€Blastï¼ˆå±€éƒ¨æ¯”å¯¹è½¯ä»¶ï¼‰1.æ¯”å¯¹æ•°æ®åº“æ„å»ºmakeblastdb -dbtype prot -in all.fasta -out all ==&gt; å¾—åˆ°ä¸€ç³»åˆ—ä»¥allä¸ºåçš„æ•°æ®åº“æ–‡ä»¶3.blastæ¯”å¯¹blastp -query query.fasta -db all -out blast.out -evalue 1e-10 ==&gt; ç»“æœå¤ªè¯¦ç»†ï¼Œ-outfmt ç¬¬ä¸ƒç§ï¼Œè¡¨æ ¼å¸¦æ³¨é‡Šå½¢å¼ blast...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/uploads/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">HHHH</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">52</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">29</div></a></div><a id="card-info-btn" href="https://github.com/0HHHHHH0"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/0hhhhhh0" target="_blank" title="fab fa-github"><i class="GitHub"></i></a><a class="social-icon" href="mailto:695460776@qq.com" target="_blank" title="fa fa-envelope"><i class="E-Mail"></i></a><a class="social-icon" href="https://x.com/your-user-name" target="_blank" title="fab fa-twitter"><i class="Twitter"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">éšä¾¿é€›é€›!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AC-%E4%B8%80%E3%80%81%E9%A1%B9%E7%9B%AE%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">ğŸ§¬ ä¸€ã€é¡¹ç›®æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E4%BA%8C%E3%80%81%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">âš™ï¸ äºŒã€ç¯å¢ƒé…ç½®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%8D-%E4%B8%89%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87%E4%B8%8E%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">3.</span> <span class="toc-text">ğŸ” ä¸‰ã€æ•°æ®å‡†å¤‡ä¸é¢„å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%B8%8F%E2%83%A3-%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E6%9F%93%E8%89%B2%E4%BD%93%E4%BF%A1%E6%81%AF"><span class="toc-number">3.1.</span> <span class="toc-text">1ï¸âƒ£ æŸ¥çœ‹æ‰€æœ‰æŸ“è‰²ä½“ä¿¡æ¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%B8%8F%E2%83%A3-%E6%8F%90%E5%8F%96%E5%8D%95%E6%9D%A1%E6%9F%93%E8%89%B2%E4%BD%93%E6%95%B0%E6%8D%AE"><span class="toc-number">3.2.</span> <span class="toc-text">2ï¸âƒ£ æå–å•æ¡æŸ“è‰²ä½“æ•°æ®</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%88-%E5%9B%9B%E3%80%81R-%E8%84%9A%E6%9C%AC%E5%88%86%E6%9E%90%E6%A8%A1%E5%9D%97"><span class="toc-number">4.</span> <span class="toc-text">ğŸ“ˆ å››ã€R è„šæœ¬åˆ†ææ¨¡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%94%B9-1-%E5%AE%8C%E6%95%B4%E5%9F%BA%E7%A1%80%E5%88%86%E6%9E%90%EF%BC%883-0-complete-analysis-R%EF%BC%89"><span class="toc-number">4.1.</span> <span class="toc-text">ğŸ”¹ 1. å®Œæ•´åŸºç¡€åˆ†æï¼ˆ3.0.complete_analysis.Rï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E5%9F%BA%E7%A1%80%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-number">4.1.1.</span> <span class="toc-text">ï¼ˆ1ï¼‰åŸºç¡€å¯è§†åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E7%AA%97%E5%8F%A3%E6%89%AB%E6%8F%8F%E4%B8%8E%E7%83%AD%E7%82%B9%E6%A3%80%E6%B5%8B"><span class="toc-number">4.1.2.</span> <span class="toc-text">ï¼ˆ2ï¼‰çª—å£æ‰«æä¸çƒ­ç‚¹æ£€æµ‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E6%8E%A8%E8%8D%90-LD-%E5%88%86%E6%9E%90%E5%8C%BA%E5%9F%9F"><span class="toc-number">4.1.3.</span> <span class="toc-text">ï¼ˆ3ï¼‰æ¨è LD åˆ†æåŒºåŸŸ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%884%EF%BC%89%E7%BB%93%E6%9E%9C%E6%80%BB%E7%BB%93%E4%B8%8E%E5%BB%BA%E8%AE%AE"><span class="toc-number">4.1.4.</span> <span class="toc-text">ï¼ˆ4ï¼‰ç»“æœæ€»ç»“ä¸å»ºè®®</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%94%B9-2-%E5%9F%BA%E4%BA%8E%E6%98%BE%E8%91%97SNP%E7%9A%84%E7%83%AD%E7%82%B9%E5%88%86%E6%9E%90%EF%BC%883-1-corrected-significant-hotspots-R%EF%BC%89"><span class="toc-number">4.2.</span> <span class="toc-text">ğŸ”¹ 2. åŸºäºæ˜¾è‘—SNPçš„çƒ­ç‚¹åˆ†æï¼ˆ3.1.corrected_significant_hotspots.Rï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E6%98%BE%E8%91%97%E6%80%A7%E7%AD%9B%E9%80%89"><span class="toc-number">4.2.1.</span> <span class="toc-text">ï¼ˆ1ï¼‰æ˜¾è‘—æ€§ç­›é€‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E5%9F%BA%E4%BA%8E%E6%98%BE%E8%91%97SNP%E7%9A%84%E7%AA%97%E5%8F%A3%E7%BB%9F%E8%AE%A1"><span class="toc-number">4.2.2.</span> <span class="toc-text">ï¼ˆ2ï¼‰åŸºäºæ˜¾è‘—SNPçš„çª—å£ç»Ÿè®¡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E6%98%BE%E8%91%97SNP%E7%83%AD%E7%82%B9%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-number">4.2.3.</span> <span class="toc-text">ï¼ˆ3ï¼‰æ˜¾è‘—SNPçƒ­ç‚¹å¯è§†åŒ–</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%94%B9-3-%E6%9C%80%E7%BB%88%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B8%8E%E6%80%BB%E7%BB%93%EF%BC%883-2-fixed-visualization-R%EF%BC%89"><span class="toc-number">4.3.</span> <span class="toc-text">ğŸ”¹ 3. æœ€ç»ˆå¯è§†åŒ–ä¸æ€»ç»“ï¼ˆ3.2.fixed_visualization.Rï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E7%BB%BC%E5%90%88%E6%9B%BC%E5%93%88%E9%A1%BF-%E5%AF%86%E5%BA%A6%E5%8F%8C%E5%9B%BE"><span class="toc-number">4.3.1.</span> <span class="toc-text">ï¼ˆ1ï¼‰ç»¼åˆæ›¼å“ˆé¡¿ + å¯†åº¦åŒå›¾</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E7%83%AD%E7%82%B9%E5%8C%BA%E5%9F%9F%E7%BB%86%E5%8C%96%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-number">4.3.2.</span> <span class="toc-text">ï¼ˆ2ï¼‰çƒ­ç‚¹åŒºåŸŸç»†åŒ–å¯è§†åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E5%88%86%E6%9E%90%E6%80%BB%E7%BB%93%E6%8A%A5%E5%91%8A"><span class="toc-number">4.3.3.</span> <span class="toc-text">ï¼ˆ3ï¼‰åˆ†ææ€»ç»“æŠ¥å‘Š</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AD-%E4%BA%94%E3%80%81%E7%BB%93%E6%9E%9C%E8%A7%A3%E8%AF%BB%E4%B8%8E%E5%90%8E%E7%BB%AD%E5%88%86%E6%9E%90%E5%BB%BA%E8%AE%AE"><span class="toc-number">5.</span> <span class="toc-text">ğŸ§­ äº”ã€ç»“æœè§£è¯»ä¸åç»­åˆ†æå»ºè®®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%94%AC-%E4%B8%8B%E4%B8%80%E6%AD%A5%E5%BB%BA%E8%AE%AE%EF%BC%9A"><span class="toc-number">5.1.</span> <span class="toc-text">ğŸ”¬ ä¸‹ä¸€æ­¥å»ºè®®ï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%AC-%E5%85%AD%E3%80%81GWAS%E7%83%AD%E7%82%B9%E5%8C%BA%E5%9F%9F%E5%88%86%E6%9E%90"><span class="toc-number">6.</span> <span class="toc-text">ğŸ”¬ å…­ã€GWASçƒ­ç‚¹åŒºåŸŸåˆ†æ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%9A-%E4%B8%83%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-number">7.</span> <span class="toc-text">ğŸ“š ä¸ƒã€æ€»ç»“</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/24/indel/" title="åŸºäº OpenSpliceAI çš„ INDEL å¯å˜å‰ªæ¥å½±å“ç­›é€‰æµç¨‹">åŸºäº OpenSpliceAI çš„ INDEL å¯å˜å‰ªæ¥å½±å“ç­›é€‰æµç¨‹</a><time datetime="2025-12-24T04:56:00.000Z" title="Created 2025-12-24 12:56:00">2025-12-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/02/gemini/" title="æ ¹æ®SNPä½ç‚¹è¿›è¡Œå¿«é€Ÿå¼•ç‰©è®¾è®¡â€”â€”ç½‘é¡µç‰ˆ">æ ¹æ®SNPä½ç‚¹è¿›è¡Œå¿«é€Ÿå¼•ç‰©è®¾è®¡â€”â€”ç½‘é¡µç‰ˆ</a><time datetime="2025-12-02T14:26:00.000Z" title="Created 2025-12-02 22:26:00">2025-12-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/24/latex/" title="LaTeXè¯¦ç»†æ•™ç¨‹+æŠ€å·§æ€»ç»“">LaTeXè¯¦ç»†æ•™ç¨‹+æŠ€å·§æ€»ç»“</a><time datetime="2025-11-24T14:26:00.000Z" title="Created 2025-11-24 22:26:00">2025-11-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/10/gwas-ld-block/" title="GWAS + çƒ­ç‚¹åŒºåŸŸè¯†åˆ« + LD Block åˆ†ææµç¨‹è¯¦è§£">GWAS + çƒ­ç‚¹åŒºåŸŸè¯†åˆ« + LD Block åˆ†ææµç¨‹è¯¦è§£</a><time datetime="2025-11-10T14:26:00.000Z" title="Created 2025-11-10 22:26:00">2025-11-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/09/fen-zi-dui-jie/" title="ä»åŸºå› åˆ°ç»“æ„ï¼šç”¨PyMOLå¯è§†åŒ–ç†è§£åˆ†å­å¯¹æ¥ä¸çªå˜æ•ˆåº”">ä»åŸºå› åˆ°ç»“æ„ï¼šç”¨PyMOLå¯è§†åŒ–ç†è§£åˆ†å­å¯¹æ¥ä¸çªå˜æ•ˆåº”</a><time datetime="2025-11-09T14:26:00.000Z" title="Created 2025-11-09 22:26:00">2025-11-09</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By HHHH</span><span class="framework-info"><span>Framework </span><a href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.1</a></span></div></div><div class="container" id="jsi-flying-fish-container"><script src="js/fish.js"></script></div><style>   @media only screen and (max-width: 767px){
   #sidebar_search_box input[type=text]{width:calc(100% - 24px)}
}</style></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.12.0/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/fish.js" defer data-pjax></script><script type="text/javascript" src="/js/busuanzi.pure.mini.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="local-search-input"><input placeholder="Search for Posts" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.1"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/09/hexo-butterfly-ge-ren-bo-ke-da-jian/" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/0HHHHHH0/Image@master/blog/cmd.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-09</span><a class="blog-slider__title" href="2025/10/09/hexo-butterfly-ge-ren-bo-ke-da-jian/" alt="">Hexo + Butterfly ä¸ªäººåšå®¢æ­å»º</a><div class="blog-slider__text">å†æ€ä¹ˆçœ‹æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆæè¿°å®ƒçš„å•¦ï¼</div><a class="blog-slider__button" href="2025/10/09/hexo-butterfly-ge-ren-bo-ke-da-jian/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/11/10/gwas-ld-block/" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/0HHHHHH0/Image@master/blog/v2-ecafe797ee44a3cafe3e129237072370_1440w.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-11-10</span><a class="blog-slider__title" href="2025/11/10/gwas-ld-block/" alt="">GWAS + çƒ­ç‚¹åŒºåŸŸè¯†åˆ« + LD Block åˆ†ææµç¨‹è¯¦è§£</a><div class="blog-slider__text">å†æ€ä¹ˆçœ‹æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆæè¿°å®ƒçš„å•¦ï¼</div><a class="blog-slider__button" href="2025/11/10/gwas-ld-block/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/07/31/19/" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/0HHHHHH0/Image@master/blog/OIP-C.2E7GSli1t13WJ-Of6Hp9UgHaEi" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-07-31</span><a class="blog-slider__title" href="2025/07/31/19/" alt="">2.é‡æµ‹åºæ•°æ®åˆ†æâ€”â€”åˆæ­¥æ•´ç†</a><div class="blog-slider__text">å†æ€ä¹ˆçœ‹æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆæè¿°å®ƒçš„å•¦ï¼</div><a class="blog-slider__button" href="2025/07/31/19/" alt="">è¯¦æƒ…   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><!-- hexo injector body_end end --></body></html>